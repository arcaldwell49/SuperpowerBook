<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Power Curve | Power Analysis with Superpower</title>
  <meta name="description" content="This is a book describing the capabilities of the Superpower R package." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Power Curve | Power Analysis with Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the capabilities of the Superpower R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Power Curve | Power Analysis with Superpower" />
  
  <meta name="twitter:description" content="This is a book describing the capabilities of the Superpower R package." />
  

<meta name="author" content="Aaron R. Caldwell" />
<meta name="author" content="Daniël Lakens" />
<meta name="author" content="Chelsea M. Parlett-Pelleriti" />
<meta name="author" content="Guy Prochilo" />
<meta name="author" content="Frederik Aust" />


<meta name="date" content="2022-02-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analytic-power-functions.html"/>
<link rel="next" href="violations-of-assumptions.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributions"><i class="fa fa-check"></i>Contributions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i>Funding</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html"><i class="fa fa-check"></i><b>1</b> Introduction to Power Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#overview-of-power-analysis"><i class="fa fa-check"></i><b>1.1</b> Overview of Power Analysis</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#error-and-power"><i class="fa fa-check"></i><b>1.2</b> Error and Power</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#effect-size"><i class="fa fa-check"></i><b>1.3</b> Effect size</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#samp_vs_pop"><i class="fa fa-check"></i><b>1.4</b> Sample effect size vs. population effect size</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#safeguard-effect-size"><i class="fa fa-check"></i><b>1.5</b> Safeguard Effect Size</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>1.6</b> <em>Post hoc</em> power analysis</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-sample-effect-size-is-not-the-population-effect-size"><i class="fa fa-check"></i><b>1.6.1</b> The sample effect size is <em>not</em> the population effect size</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-is-merely-a-transformation-of-your-obtained-p-value"><i class="fa fa-check"></i><b>1.6.2</b> <em>Post hoc</em> power is merely a transformation of your obtained <em>p</em> value</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-minimal-detectable-effect-size"><i class="fa fa-check"></i><b>1.7</b> The Minimal Detectable Effect Size</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-experimental-design.html"><a href="the-experimental-design.html"><i class="fa fa-check"></i><b>2</b> The Experimental Design</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#anova_design-function"><i class="fa fa-check"></i><b>2.1</b> ANOVA_design function</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-design-using-design"><i class="fa fa-check"></i><b>2.1.1</b> Specifying the design using <code>design</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-means-using-mu"><i class="fa fa-check"></i><b>2.1.2</b> Specifying the means using <code>mu</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-label-names"><i class="fa fa-check"></i><b>2.1.3</b> Specifying label names</a></li>
<li class="chapter" data-level="2.1.4" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-correlation"><i class="fa fa-check"></i><b>2.1.4</b> Specifying the correlation</a></li>
<li class="chapter" data-level="2.1.5" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-sample-size"><i class="fa fa-check"></i><b>2.1.5</b> Specifying the sample size</a></li>
<li class="chapter" data-level="2.1.6" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-standard-deviation"><i class="fa fa-check"></i><b>2.1.6</b> Specifying the standard deviation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions</a></li>
<li class="chapter" data-level="3.1.2" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>3.1.2</b> Three conditions</a></li>
<li class="chapter" data-level="3.1.3" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.1.3</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#effect-size-estimates-for-one-way-anova"><i class="fa fa-check"></i><b>3.2</b> Effect Size Estimates for One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>3.2.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="3.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="3.2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>3.2.3</b> Two conditions, large effect size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>4.1</b> Part 1</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-2"><i class="fa fa-check"></i><b>4.2</b> Part 2</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>4.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="4.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-3"><i class="fa fa-check"></i><b>4.3</b> Part 3</a></li>
<li class="chapter" data-level="4.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-4"><i class="fa fa-check"></i><b>4.4</b> Part 4</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-within-design"><i class="fa fa-check"></i><b>4.4.1</b> 2x2 ANOVA, within-within design</a></li>
<li class="chapter" data-level="4.4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>4.4.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-5"><i class="fa fa-check"></i><b>4.5</b> Part 5</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-design"><i class="fa fa-check"></i><b>4.5.1</b> 2x2 ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#multivariate-anova-manova"><i class="fa fa-check"></i><b>4.6</b> Multivariate ANOVA (MANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>5</b> Mixed ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-mixed-designs"><i class="fa fa-check"></i><b>5.1</b> Simple Mixed Designs</a></li>
<li class="chapter" data-level="5.2" data-path="mixed-anova.html"><a href="mixed-anova.html#complex-mixed-designs"><i class="fa fa-check"></i><b>5.2</b> Complex Mixed Designs</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#b3w-design"><i class="fa fa-check"></i><b>5.2.1</b> 2b*3w Design</a></li>
<li class="chapter" data-level="5.2.2" data-path="mixed-anova.html"><a href="mixed-anova.html#b4w-design"><i class="fa fa-check"></i><b>5.2.2</b> 2b*4w Design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="power-for-three-way-interactions.html"><a href="power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>6</b> Power for Three-way Interactions</a></li>
<li class="chapter" data-level="7" data-path="the-no-way-interactions.html"><a href="the-no-way-interactions.html"><i class="fa fa-check"></i><b>7</b> The ‘No-Way’ Interactions</a></li>
<li class="chapter" data-level="8" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html"><i class="fa fa-check"></i><b>8</b> Effect of Varying Designs on Power</a>
<ul>
<li class="chapter" data-level="8.1" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html#within-designs"><i class="fa fa-check"></i><b>8.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>9</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="10" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subjects-anova"><i class="fa fa-check"></i><b>10.1</b> One-Way Between Subjects ANOVA</a></li>
<li class="chapter" data-level="10.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>10.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="10.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>10.3</b> 3x3 Between Subject ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>11</b> Power Curve</a>
<ul>
<li class="chapter" data-level="11.1" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-moderated-interactions."><i class="fa fa-check"></i><b>11.1</b> Explore increase in effect size for moderated interactions.</a></li>
<li class="chapter" data-level="11.2" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>11.2</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="11.3" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>11.3</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="11.4" data-path="power-curve.html"><a href="power-curve.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>11.4</b> Increasing correlation in on factor decreases power in second factor</a></li>
<li class="chapter" data-level="11.5" data-path="power-curve.html"><a href="power-curve.html#code-to-reproduce-power-curve-figures"><i class="fa fa-check"></i><b>11.5</b> Code to Reproduce Power Curve Figures</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html"><i class="fa fa-check"></i><b>12</b> Violations of Assumptions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-heterogeneity-assumption"><i class="fa fa-check"></i><b>12.1</b> Violation of Heterogeneity Assumption</a></li>
<li class="chapter" data-level="12.2" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-the-sphericity-assumption"><i class="fa fa-check"></i><b>12.2</b> Violation of the sphericity assumption</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#manova-or-sphericity-adjustment"><i class="fa fa-check"></i><b>12.2.1</b> MANOVA or Sphericity Adjustment?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html"><i class="fa fa-check"></i><b>13</b> Estimated Marginal Means</a>
<ul>
<li class="chapter" data-level="13.1" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#a-note-of-caution"><i class="fa fa-check"></i><b>13.1</b> A note of caution</a></li>
<li class="chapter" data-level="13.2" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#pairwise-comparisons"><i class="fa fa-check"></i><b>13.2</b> Pairwise Comparisons</a></li>
<li class="chapter" data-level="13.3" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#customized-emmeans-contrasts"><i class="fa fa-check"></i><b>13.3</b> Customized <code>emmeans</code> contrasts</a></li>
<li class="chapter" data-level="13.4" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#equivalence-and-non-superiority-inferiority-tests"><i class="fa fa-check"></i><b>13.4</b> Equivalence and non-superiority/-inferiority tests</a></li>
<li class="chapter" data-level="13.5" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#joint-tests"><i class="fa fa-check"></i><b>13.5</b> Joint tests</a></li>
<li class="chapter" data-level="13.6" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#monte-carlo-simulations"><i class="fa fa-check"></i><b>13.6</b> Monte Carlo Simulations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html"><i class="fa fa-check"></i><b>14</b> Beyond Superpower I: Mixed Models with <code>simr</code></a>
<ul>
<li class="chapter" data-level="14.1" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html#how-does-simr-work"><i class="fa fa-check"></i><b>14.1</b> How does <code>simr</code> work?</a></li>
<li class="chapter" data-level="14.2" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html#to-be-continued"><i class="fa fa-check"></i><b>14.2</b> To Be Continued…</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html"><i class="fa fa-check"></i><b>15</b> Beyond Superpower II: Custom Simulations</a>
<ul>
<li class="chapter" data-level="15.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#a-clincal-trial-with-a-binary-outcome"><i class="fa fa-check"></i><b>15.1</b> A Clincal Trial with a Binary Outcome</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#proposed-study-and-approach"><i class="fa fa-check"></i><b>15.1.1</b> Proposed Study and Approach</a></li>
<li class="chapter" data-level="15.1.2" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#step-1-create-a-data-generating-function"><i class="fa fa-check"></i><b>15.1.2</b> Step 1: Create a Data Generating Function</a></li>
<li class="chapter" data-level="15.1.3" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#step-2-simulation"><i class="fa fa-check"></i><b>15.1.3</b> Step 2: Simulation</a></li>
<li class="chapter" data-level="15.1.4" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#why-more-complicated-code"><i class="fa fa-check"></i><b>15.1.4</b> Why more complicated code?</a></li>
<li class="chapter" data-level="15.1.5" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#conclusions-on-the-binary-rct-analysis"><i class="fa fa-check"></i><b>15.1.5</b> Conclusions on the Binary RCT Analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#binary-rct-with-a-interim-analysis"><i class="fa fa-check"></i><b>15.2</b> Binary RCT with a Interim Analysis</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#proposed-study-and-approach-1"><i class="fa fa-check"></i><b>15.2.1</b> Proposed Study and Approach</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#conclusion-on-a-binary-rct-with-interim-analyses"><i class="fa fa-check"></i><b>15.3</b> Conclusion on a Binary RCT with Interim Analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html"><i class="fa fa-check"></i>Appendix 1: Direct Comparison to pwr2ppl</a>
<ul>
<li class="chapter" data-level="15.4" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-5"><i class="fa fa-check"></i><b>15.4</b> Examples from Chapter 5</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.15.2"><i class="fa fa-check"></i><b>15.4.1</b> Example 5.1/5.2</a></li>
<li class="chapter" data-level="15.4.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.3"><i class="fa fa-check"></i><b>15.4.2</b> Example 5.3</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-6"><i class="fa fa-check"></i><b>15.5</b> Examples from Chapter 6</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.2"><i class="fa fa-check"></i><b>15.5.1</b> Example from Table 6.2</a></li>
<li class="chapter" data-level="15.5.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.6"><i class="fa fa-check"></i><b>15.5.2</b> Example from Table 6.6</a></li>
<li class="chapter" data-level="15.5.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.8"><i class="fa fa-check"></i><b>15.5.3</b> Example from Table 6.8</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-chapter-7"><i class="fa fa-check"></i><b>15.6</b> Example from Chapter 7</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#from-table-7.2"><i class="fa fa-check"></i><b>15.6.1</b> From Table 7.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-direct-comparison-to-morepower.html"><a href="appendix-2-direct-comparison-to-morepower.html"><i class="fa fa-check"></i>Appendix 2: Direct Comparison to MOREpower</a></li>
<li class="chapter" data-level="" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html"><i class="fa fa-check"></i>Appendix 3: Comparison to Brysbaert</a>
<ul>
<li class="chapter" data-level="15.7" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#one-way-anova-1"><i class="fa fa-check"></i><b>15.7</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication"><i class="fa fa-check"></i><b>15.7.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="15.7.2" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-1"><i class="fa fa-check"></i><b>15.7.2</b> Variation 1</a></li>
<li class="chapter" data-level="15.7.3" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>15.7.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="15.7.4" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-2"><i class="fa fa-check"></i><b>15.7.4</b> Variation 2</a></li>
<li class="chapter" data-level="15.7.5" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>15.7.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#repeated-measures"><i class="fa fa-check"></i><b>15.8</b> Repeated Measures</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>15.8.1</b> Reproducing Brysbaert Variation 1: Changing Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Power Analysis with Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-curve" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Power Curve</h1>
<p>Power is calculated for a specific value of an effect size, alpha level, and sample size. Because you often do not know the true effect size, it often makes more sense to think of the power curve as a function of the size of the effect. Although power curves could be constructed from Monte Carlo simulations (<code>ANOVA_power</code>) the <code>plot_power</code> function utilizes the <code>ANOVA_exact</code> function within its code because these “exact” simulations are much faster. The basic approach is to calculate power for a specific pattern of means, a specific effect size, a given alpha level, and a specific pattern of correlations. This is one example:</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="power-curve.html#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2x2 design</span></span>
<span id="cb637-2"><a href="power-curve.html#cb637-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb637-3"><a href="power-curve.html#cb637-3" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> <span class="st">&quot;2w*2w&quot;</span>,</span>
<span id="cb637-4"><a href="power-curve.html#cb637-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb637-5"><a href="power-curve.html#cb637-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), </span>
<span id="cb637-6"><a href="power-curve.html#cb637-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb637-7"><a href="power-curve.html#cb637-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-280-1.png" width="672" /></p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="power-curve.html#cb638-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb638-2"><a href="power-curve.html#cb638-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb638-3"><a href="power-curve.html#cb638-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-281">Table 11.1: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
32.35926
</td>
<td style="text-align:right;">
0.1162791
</td>
<td style="text-align:right;">
0.3627381
</td>
<td style="text-align:right;">
2.5
</td>
</tr>
<tr>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
32.35926
</td>
<td style="text-align:right;">
0.1162791
</td>
<td style="text-align:right;">
0.3627381
</td>
<td style="text-align:right;">
2.5
</td>
</tr>
<tr>
<td style="text-align:left;">
a:b
</td>
<td style="text-align:right;">
32.35926
</td>
<td style="text-align:right;">
0.1162791
</td>
<td style="text-align:right;">
0.3627381
</td>
<td style="text-align:right;">
2.5
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<p>We can make these calculations for a range of sample sizes, to get a power curve. We created a simple function that performs these calculations across a range of sample sizes (from n = 3 to max_, a variable you can specify in the function).</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="power-curve.html#cb639-1" aria-hidden="true" tabindex="-1"></a>p_a <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb639-2"><a href="power-curve.html#cb639-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">50</span>,</span>
<span id="cb639-3"><a href="power-curve.html#cb639-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb639-4"><a href="power-curve.html#cb639-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-282-1.png" width="672" /></p>
<pre><code>## Achieved Power and Sample Size for ANOVA-level effects
##   variable                     label  n achieved_power desired_power
## 1        a Desired Power Not Reached 50          68.82            90
## 2        b Desired Power Not Reached 50          68.82            90
## 3      a:b Desired Power Not Reached 50          68.82            90</code></pre>
<p>If we run many of these <code>plot_power</code> functions across small changes in the ANOVA_design we can compile a number of power curves that can be combined into a single plot. We do this below. The code to reproduce these plots can be found on the <a href="https://github.com/arcaldwell49/SuperpowerBook/tree/master/data">GitHub repository for this book</a>.
</p>
<div id="explore-increase-in-effect-size-for-moderated-interactions." class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Explore increase in effect size for moderated interactions.</h2>
<p>The design has means 0, 0, 0, 0, with one cell increasing by 0.1, up to 0, 0, 0, 0.5. The standard deviation is set to 1. The correlation between all variables is 0.5.</p>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="explore-increase-in-effect-size-for-cross-over-interactions." class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Explore increase in effect size for cross-over interactions.</h2>
<p>The design has means 0, 0, 0, 0, with two cells increasing by 0.1, up to 0.5, 0, 0, 0.5. The standard deviation is set to 1. The correlation between all variables is 0.5.</p>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-284-1.png" width="672" />
</p>
</div>
<div id="explore-increase-in-correlation-in-moderated-interactions." class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Explore increase in correlation in moderated interactions.</h2>
<p>The design has means 0, 0, 0, 0.3. The standard deviation is set to 1. The correlation between all variables increases from 0 to 0.9.</p>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-285-1.png" width="672" />
</p>
</div>
<div id="increasing-correlation-in-on-factor-decreases-power-in-second-factor" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Increasing correlation in on factor decreases power in second factor</h2>
<p>As <span class="citation"><a href="#ref-potvin2000statistical" role="doc-biblioref">Potvin and Schutz</a> (<a href="#ref-potvin2000statistical" role="doc-biblioref">2000</a>)</span> write:</p>
<blockquote>
<p>The more important finding with respect to the effect of <em>r</em> on power relates to the effect of the correlations associated with one factor on the power of the test of the main effect of the other factor. Specifically, if the correlations among the levels of B are larger than those within the AB matrix (i.e., <em>r</em>(B) - <em>r</em>(AB) &gt; 0.0), there is a reduction in the power for the test of the A effect (and the test on B is similarly affected by the A correlations).</p>
</blockquote>
<p>We see this in the plots below. As the correlation of the A factor increases from 0.4 to 0.9, we see the power for the main effect decreases.</p>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-286-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
</div>
<div id="code-to-reproduce-power-curve-figures" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> Code to Reproduce Power Curve Figures</h2>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="power-curve.html#cb641-1" aria-hidden="true" tabindex="-1"></a>nsims <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb641-2"><a href="power-curve.html#cb641-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Superpower)</span>
<span id="cb641-3"><a href="power-curve.html#cb641-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb641-4"><a href="power-curve.html#cb641-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb641-5"><a href="power-curve.html#cb641-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb641-6"><a href="power-curve.html#cb641-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-7"><a href="power-curve.html#cb641-7" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2w*2w&quot;</span></span>
<span id="cb641-8"><a href="power-curve.html#cb641-8" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>)</span>
<span id="cb641-9"><a href="power-curve.html#cb641-9" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-10"><a href="power-curve.html#cb641-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-11"><a href="power-curve.html#cb641-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.0</span>), </span>
<span id="cb641-12"><a href="power-curve.html#cb641-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-13"><a href="power-curve.html#cb641-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-14"><a href="power-curve.html#cb641-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-15"><a href="power-curve.html#cb641-15" aria-hidden="true" tabindex="-1"></a>p_a <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-16"><a href="power-curve.html#cb641-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-17"><a href="power-curve.html#cb641-17" aria-hidden="true" tabindex="-1"></a>p_a<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb641-18"><a href="power-curve.html#cb641-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-19"><a href="power-curve.html#cb641-19" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-20"><a href="power-curve.html#cb641-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-21"><a href="power-curve.html#cb641-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), </span>
<span id="cb641-22"><a href="power-curve.html#cb641-22" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-23"><a href="power-curve.html#cb641-23" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-24"><a href="power-curve.html#cb641-24" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-25"><a href="power-curve.html#cb641-25" aria-hidden="true" tabindex="-1"></a>p_b <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-26"><a href="power-curve.html#cb641-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-27"><a href="power-curve.html#cb641-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-28"><a href="power-curve.html#cb641-28" aria-hidden="true" tabindex="-1"></a>p_b<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb641-29"><a href="power-curve.html#cb641-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-30"><a href="power-curve.html#cb641-30" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-31"><a href="power-curve.html#cb641-31" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-32"><a href="power-curve.html#cb641-32" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), </span>
<span id="cb641-33"><a href="power-curve.html#cb641-33" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-34"><a href="power-curve.html#cb641-34" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-35"><a href="power-curve.html#cb641-35" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-36"><a href="power-curve.html#cb641-36" aria-hidden="true" tabindex="-1"></a>p_c <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-37"><a href="power-curve.html#cb641-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-38"><a href="power-curve.html#cb641-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-39"><a href="power-curve.html#cb641-39" aria-hidden="true" tabindex="-1"></a>p_c<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb641-40"><a href="power-curve.html#cb641-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-41"><a href="power-curve.html#cb641-41" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-42"><a href="power-curve.html#cb641-42" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-43"><a href="power-curve.html#cb641-43" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-44"><a href="power-curve.html#cb641-44" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-45"><a href="power-curve.html#cb641-45" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-46"><a href="power-curve.html#cb641-46" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-47"><a href="power-curve.html#cb641-47" aria-hidden="true" tabindex="-1"></a>p_d <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-48"><a href="power-curve.html#cb641-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-49"><a href="power-curve.html#cb641-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-50"><a href="power-curve.html#cb641-50" aria-hidden="true" tabindex="-1"></a>p_d<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb641-51"><a href="power-curve.html#cb641-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-52"><a href="power-curve.html#cb641-52" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-53"><a href="power-curve.html#cb641-53" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-54"><a href="power-curve.html#cb641-54" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.4</span>), </span>
<span id="cb641-55"><a href="power-curve.html#cb641-55" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-56"><a href="power-curve.html#cb641-56" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-57"><a href="power-curve.html#cb641-57" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-58"><a href="power-curve.html#cb641-58" aria-hidden="true" tabindex="-1"></a>p_e <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-59"><a href="power-curve.html#cb641-59" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-60"><a href="power-curve.html#cb641-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-61"><a href="power-curve.html#cb641-61" aria-hidden="true" tabindex="-1"></a>p_e<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb641-62"><a href="power-curve.html#cb641-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-63"><a href="power-curve.html#cb641-63" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-64"><a href="power-curve.html#cb641-64" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-65"><a href="power-curve.html#cb641-65" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), </span>
<span id="cb641-66"><a href="power-curve.html#cb641-66" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-67"><a href="power-curve.html#cb641-67" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-68"><a href="power-curve.html#cb641-68" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-69"><a href="power-curve.html#cb641-69" aria-hidden="true" tabindex="-1"></a>p_f <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-70"><a href="power-curve.html#cb641-70" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-71"><a href="power-curve.html#cb641-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-72"><a href="power-curve.html#cb641-72" aria-hidden="true" tabindex="-1"></a>p_f<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb641-73"><a href="power-curve.html#cb641-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-74"><a href="power-curve.html#cb641-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-75"><a href="power-curve.html#cb641-75" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p_a<span class="sc">$</span>power_df, p_b<span class="sc">$</span>power_df, p_c<span class="sc">$</span>power_df, </span>
<span id="cb641-76"><a href="power-curve.html#cb641-76" aria-hidden="true" tabindex="-1"></a>                   p_d<span class="sc">$</span>power_df, p_e<span class="sc">$</span>power_df, p_f<span class="sc">$</span>power_df)<span class="sc">%&gt;%</span></span>
<span id="cb641-77"><a href="power-curve.html#cb641-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AxB =</span> <span class="st">`</span><span class="at">A:B</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n,effect,A,B,AxB)</span>
<span id="cb641-78"><a href="power-curve.html#cb641-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-79"><a href="power-curve.html#cb641-79" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">=</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb641-80"><a href="power-curve.html#cb641-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;AxB&quot;</span>, <span class="at">key =</span> factor, <span class="at">value =</span> power)</span>
<span id="cb641-81"><a href="power-curve.html#cb641-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-82"><a href="power-curve.html#cb641-82" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power,</span>
<span id="cb641-83"><a href="power-curve.html#cb641-83" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">as.factor</span>(effect))) <span class="sc">+</span></span>
<span id="cb641-84"><a href="power-curve.html#cb641-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb641-85"><a href="power-curve.html#cb641-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb641-86"><a href="power-curve.html#cb641-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Effect Size&quot;</span>,</span>
<span id="cb641-87"><a href="power-curve.html#cb641-87" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sample Size per Group&quot;</span>,</span>
<span id="cb641-88"><a href="power-curve.html#cb641-88" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Power (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb641-89"><a href="power-curve.html#cb641-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> factor, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb641-90"><a href="power-curve.html#cb641-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-91"><a href="power-curve.html#cb641-91" aria-hidden="true" tabindex="-1"></a><span class="do">####</span></span>
<span id="cb641-92"><a href="power-curve.html#cb641-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-93"><a href="power-curve.html#cb641-93" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-94"><a href="power-curve.html#cb641-94" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-95"><a href="power-curve.html#cb641-95" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.0</span>), </span>
<span id="cb641-96"><a href="power-curve.html#cb641-96" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-97"><a href="power-curve.html#cb641-97" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-98"><a href="power-curve.html#cb641-98" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-99"><a href="power-curve.html#cb641-99" aria-hidden="true" tabindex="-1"></a>p_a <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-100"><a href="power-curve.html#cb641-100" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-101"><a href="power-curve.html#cb641-101" aria-hidden="true" tabindex="-1"></a>p_a<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb641-102"><a href="power-curve.html#cb641-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-103"><a href="power-curve.html#cb641-103" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-104"><a href="power-curve.html#cb641-104" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-105"><a href="power-curve.html#cb641-105" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), </span>
<span id="cb641-106"><a href="power-curve.html#cb641-106" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-107"><a href="power-curve.html#cb641-107" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-108"><a href="power-curve.html#cb641-108" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-109"><a href="power-curve.html#cb641-109" aria-hidden="true" tabindex="-1"></a>p_b <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-110"><a href="power-curve.html#cb641-110" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-111"><a href="power-curve.html#cb641-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-112"><a href="power-curve.html#cb641-112" aria-hidden="true" tabindex="-1"></a>p_b<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb641-113"><a href="power-curve.html#cb641-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-114"><a href="power-curve.html#cb641-114" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-115"><a href="power-curve.html#cb641-115" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-116"><a href="power-curve.html#cb641-116" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), </span>
<span id="cb641-117"><a href="power-curve.html#cb641-117" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-118"><a href="power-curve.html#cb641-118" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-119"><a href="power-curve.html#cb641-119" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-120"><a href="power-curve.html#cb641-120" aria-hidden="true" tabindex="-1"></a>p_c <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-121"><a href="power-curve.html#cb641-121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-122"><a href="power-curve.html#cb641-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-123"><a href="power-curve.html#cb641-123" aria-hidden="true" tabindex="-1"></a>p_c<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb641-124"><a href="power-curve.html#cb641-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-125"><a href="power-curve.html#cb641-125" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-126"><a href="power-curve.html#cb641-126" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-127"><a href="power-curve.html#cb641-127" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-128"><a href="power-curve.html#cb641-128" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-129"><a href="power-curve.html#cb641-129" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-130"><a href="power-curve.html#cb641-130" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-131"><a href="power-curve.html#cb641-131" aria-hidden="true" tabindex="-1"></a>p_d <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-132"><a href="power-curve.html#cb641-132" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-133"><a href="power-curve.html#cb641-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-134"><a href="power-curve.html#cb641-134" aria-hidden="true" tabindex="-1"></a>p_d<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb641-135"><a href="power-curve.html#cb641-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-136"><a href="power-curve.html#cb641-136" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-137"><a href="power-curve.html#cb641-137" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-138"><a href="power-curve.html#cb641-138" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.4</span>), </span>
<span id="cb641-139"><a href="power-curve.html#cb641-139" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-140"><a href="power-curve.html#cb641-140" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-141"><a href="power-curve.html#cb641-141" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-142"><a href="power-curve.html#cb641-142" aria-hidden="true" tabindex="-1"></a>p_e <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-143"><a href="power-curve.html#cb641-143" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-144"><a href="power-curve.html#cb641-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-145"><a href="power-curve.html#cb641-145" aria-hidden="true" tabindex="-1"></a>p_e<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb641-146"><a href="power-curve.html#cb641-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-147"><a href="power-curve.html#cb641-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-148"><a href="power-curve.html#cb641-148" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-149"><a href="power-curve.html#cb641-149" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-150"><a href="power-curve.html#cb641-150" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), </span>
<span id="cb641-151"><a href="power-curve.html#cb641-151" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-152"><a href="power-curve.html#cb641-152" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-153"><a href="power-curve.html#cb641-153" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-154"><a href="power-curve.html#cb641-154" aria-hidden="true" tabindex="-1"></a>p_f <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-155"><a href="power-curve.html#cb641-155" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-156"><a href="power-curve.html#cb641-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-157"><a href="power-curve.html#cb641-157" aria-hidden="true" tabindex="-1"></a>p_f<span class="sc">$</span>power_df<span class="sc">$</span>effect <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb641-158"><a href="power-curve.html#cb641-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-159"><a href="power-curve.html#cb641-159" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p_a<span class="sc">$</span>power_df, p_b<span class="sc">$</span>power_df, p_c<span class="sc">$</span>power_df,</span>
<span id="cb641-160"><a href="power-curve.html#cb641-160" aria-hidden="true" tabindex="-1"></a>                   p_d<span class="sc">$</span>power_df, p_e<span class="sc">$</span>power_df, p_f<span class="sc">$</span>power_df)<span class="sc">%&gt;%</span></span>
<span id="cb641-161"><a href="power-curve.html#cb641-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AxB =</span> <span class="st">`</span><span class="at">A:B</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n,effect,A,B,AxB)</span>
<span id="cb641-162"><a href="power-curve.html#cb641-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-163"><a href="power-curve.html#cb641-163" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">=</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb641-164"><a href="power-curve.html#cb641-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;AxB&quot;</span>, <span class="at">key =</span> factor, <span class="at">value =</span> power)</span>
<span id="cb641-165"><a href="power-curve.html#cb641-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-166"><a href="power-curve.html#cb641-166" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power,</span>
<span id="cb641-167"><a href="power-curve.html#cb641-167" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">as.factor</span>(effect))) <span class="sc">+</span></span>
<span id="cb641-168"><a href="power-curve.html#cb641-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb641-169"><a href="power-curve.html#cb641-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb641-170"><a href="power-curve.html#cb641-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Effect Size&quot;</span>,</span>
<span id="cb641-171"><a href="power-curve.html#cb641-171" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sample Size per Group&quot;</span>,</span>
<span id="cb641-172"><a href="power-curve.html#cb641-172" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Power (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb641-173"><a href="power-curve.html#cb641-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> factor, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb641-174"><a href="power-curve.html#cb641-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-175"><a href="power-curve.html#cb641-175" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb641-176"><a href="power-curve.html#cb641-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-177"><a href="power-curve.html#cb641-177" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2w*2w&quot;</span></span>
<span id="cb641-178"><a href="power-curve.html#cb641-178" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>)</span>
<span id="cb641-179"><a href="power-curve.html#cb641-179" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-180"><a href="power-curve.html#cb641-180" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-181"><a href="power-curve.html#cb641-181" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-182"><a href="power-curve.html#cb641-182" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-183"><a href="power-curve.html#cb641-183" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.0</span>, </span>
<span id="cb641-184"><a href="power-curve.html#cb641-184" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-185"><a href="power-curve.html#cb641-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-186"><a href="power-curve.html#cb641-186" aria-hidden="true" tabindex="-1"></a>p_a <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-187"><a href="power-curve.html#cb641-187" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-188"><a href="power-curve.html#cb641-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-189"><a href="power-curve.html#cb641-189" aria-hidden="true" tabindex="-1"></a>p_a<span class="sc">$</span>power_df<span class="sc">$</span>correlation <span class="ot">&lt;-</span> <span class="fl">0.0</span> </span>
<span id="cb641-190"><a href="power-curve.html#cb641-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-191"><a href="power-curve.html#cb641-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-192"><a href="power-curve.html#cb641-192" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-193"><a href="power-curve.html#cb641-193" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-194"><a href="power-curve.html#cb641-194" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-195"><a href="power-curve.html#cb641-195" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-196"><a href="power-curve.html#cb641-196" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.1</span>, </span>
<span id="cb641-197"><a href="power-curve.html#cb641-197" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-198"><a href="power-curve.html#cb641-198" aria-hidden="true" tabindex="-1"></a>p_b <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-199"><a href="power-curve.html#cb641-199" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-200"><a href="power-curve.html#cb641-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-201"><a href="power-curve.html#cb641-201" aria-hidden="true" tabindex="-1"></a>p_b<span class="sc">$</span>power_df<span class="sc">$</span>correlation <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb641-202"><a href="power-curve.html#cb641-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-203"><a href="power-curve.html#cb641-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-204"><a href="power-curve.html#cb641-204" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-205"><a href="power-curve.html#cb641-205" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-206"><a href="power-curve.html#cb641-206" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-207"><a href="power-curve.html#cb641-207" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-208"><a href="power-curve.html#cb641-208" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.3</span>, </span>
<span id="cb641-209"><a href="power-curve.html#cb641-209" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-210"><a href="power-curve.html#cb641-210" aria-hidden="true" tabindex="-1"></a>p_c <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-211"><a href="power-curve.html#cb641-211" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-212"><a href="power-curve.html#cb641-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-213"><a href="power-curve.html#cb641-213" aria-hidden="true" tabindex="-1"></a>p_c<span class="sc">$</span>power_df<span class="sc">$</span>correlation <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb641-214"><a href="power-curve.html#cb641-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-215"><a href="power-curve.html#cb641-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-216"><a href="power-curve.html#cb641-216" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-217"><a href="power-curve.html#cb641-217" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-218"><a href="power-curve.html#cb641-218" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-219"><a href="power-curve.html#cb641-219" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-220"><a href="power-curve.html#cb641-220" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.5</span>, </span>
<span id="cb641-221"><a href="power-curve.html#cb641-221" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-222"><a href="power-curve.html#cb641-222" aria-hidden="true" tabindex="-1"></a>p_d <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-223"><a href="power-curve.html#cb641-223" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-224"><a href="power-curve.html#cb641-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-225"><a href="power-curve.html#cb641-225" aria-hidden="true" tabindex="-1"></a>p_d<span class="sc">$</span>power_df<span class="sc">$</span>correlation <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb641-226"><a href="power-curve.html#cb641-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-227"><a href="power-curve.html#cb641-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-228"><a href="power-curve.html#cb641-228" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-229"><a href="power-curve.html#cb641-229" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-230"><a href="power-curve.html#cb641-230" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-231"><a href="power-curve.html#cb641-231" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-232"><a href="power-curve.html#cb641-232" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.7</span>, </span>
<span id="cb641-233"><a href="power-curve.html#cb641-233" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-234"><a href="power-curve.html#cb641-234" aria-hidden="true" tabindex="-1"></a>p_e <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-235"><a href="power-curve.html#cb641-235" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-236"><a href="power-curve.html#cb641-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-237"><a href="power-curve.html#cb641-237" aria-hidden="true" tabindex="-1"></a>p_e<span class="sc">$</span>power_df<span class="sc">$</span>correlation <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb641-238"><a href="power-curve.html#cb641-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-239"><a href="power-curve.html#cb641-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-240"><a href="power-curve.html#cb641-240" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-241"><a href="power-curve.html#cb641-241" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-242"><a href="power-curve.html#cb641-242" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-243"><a href="power-curve.html#cb641-243" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-244"><a href="power-curve.html#cb641-244" aria-hidden="true" tabindex="-1"></a>                              <span class="at">r =</span> <span class="fl">0.9</span>, </span>
<span id="cb641-245"><a href="power-curve.html#cb641-245" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-246"><a href="power-curve.html#cb641-246" aria-hidden="true" tabindex="-1"></a>p_f <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-247"><a href="power-curve.html#cb641-247" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-248"><a href="power-curve.html#cb641-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-249"><a href="power-curve.html#cb641-249" aria-hidden="true" tabindex="-1"></a>p_f<span class="sc">$</span>power_df<span class="sc">$</span>correlation <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb641-250"><a href="power-curve.html#cb641-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-251"><a href="power-curve.html#cb641-251" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p_a<span class="sc">$</span>power_df, p_b<span class="sc">$</span>power_df, </span>
<span id="cb641-252"><a href="power-curve.html#cb641-252" aria-hidden="true" tabindex="-1"></a>                   p_c<span class="sc">$</span>power_df, p_d<span class="sc">$</span>power_df, p_e<span class="sc">$</span>power_df, p_f<span class="sc">$</span>power_df)<span class="sc">%&gt;%</span></span>
<span id="cb641-253"><a href="power-curve.html#cb641-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AxB =</span> <span class="st">`</span><span class="at">A:B</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n,correlation,A,B,AxB)</span>
<span id="cb641-254"><a href="power-curve.html#cb641-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-255"><a href="power-curve.html#cb641-255" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">=</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb641-256"><a href="power-curve.html#cb641-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;AxB&quot;</span>, <span class="at">key =</span> factor, <span class="at">value =</span> power)</span>
<span id="cb641-257"><a href="power-curve.html#cb641-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-258"><a href="power-curve.html#cb641-258" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power,</span>
<span id="cb641-259"><a href="power-curve.html#cb641-259" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">as.factor</span>(correlation))) <span class="sc">+</span></span>
<span id="cb641-260"><a href="power-curve.html#cb641-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb641-261"><a href="power-curve.html#cb641-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb641-262"><a href="power-curve.html#cb641-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Correlation&quot;</span>,</span>
<span id="cb641-263"><a href="power-curve.html#cb641-263" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sample Size per Group&quot;</span>,</span>
<span id="cb641-264"><a href="power-curve.html#cb641-264" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Power (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb641-265"><a href="power-curve.html#cb641-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> factor, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb641-266"><a href="power-curve.html#cb641-266" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb641-267"><a href="power-curve.html#cb641-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-268"><a href="power-curve.html#cb641-268" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2w*2w&quot;</span></span>
<span id="cb641-269"><a href="power-curve.html#cb641-269" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>)</span>
<span id="cb641-270"><a href="power-curve.html#cb641-270" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-271"><a href="power-curve.html#cb641-271" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-272"><a href="power-curve.html#cb641-272" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-273"><a href="power-curve.html#cb641-273" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-274"><a href="power-curve.html#cb641-274" aria-hidden="true" tabindex="-1"></a>                              r <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb641-275"><a href="power-curve.html#cb641-275" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-276"><a href="power-curve.html#cb641-276" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-277"><a href="power-curve.html#cb641-277" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>),</span>
<span id="cb641-278"><a href="power-curve.html#cb641-278" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-279"><a href="power-curve.html#cb641-279" aria-hidden="true" tabindex="-1"></a>p_a <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-280"><a href="power-curve.html#cb641-280" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-281"><a href="power-curve.html#cb641-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-282"><a href="power-curve.html#cb641-282" aria-hidden="true" tabindex="-1"></a>p_a<span class="sc">$</span>power_df<span class="sc">$</span>corr_diff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb641-283"><a href="power-curve.html#cb641-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-284"><a href="power-curve.html#cb641-284" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-285"><a href="power-curve.html#cb641-285" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-286"><a href="power-curve.html#cb641-286" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-287"><a href="power-curve.html#cb641-287" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-288"><a href="power-curve.html#cb641-288" aria-hidden="true" tabindex="-1"></a>                              r <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb641-289"><a href="power-curve.html#cb641-289" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-290"><a href="power-curve.html#cb641-290" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-291"><a href="power-curve.html#cb641-291" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.5</span>),</span>
<span id="cb641-292"><a href="power-curve.html#cb641-292" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-293"><a href="power-curve.html#cb641-293" aria-hidden="true" tabindex="-1"></a>p_b <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-294"><a href="power-curve.html#cb641-294" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-295"><a href="power-curve.html#cb641-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-296"><a href="power-curve.html#cb641-296" aria-hidden="true" tabindex="-1"></a>p_b<span class="sc">$</span>power_df<span class="sc">$</span>corr_diff <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb641-297"><a href="power-curve.html#cb641-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-298"><a href="power-curve.html#cb641-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-299"><a href="power-curve.html#cb641-299" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-300"><a href="power-curve.html#cb641-300" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-301"><a href="power-curve.html#cb641-301" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-302"><a href="power-curve.html#cb641-302" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-303"><a href="power-curve.html#cb641-303" aria-hidden="true" tabindex="-1"></a>                              r <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb641-304"><a href="power-curve.html#cb641-304" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-305"><a href="power-curve.html#cb641-305" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-306"><a href="power-curve.html#cb641-306" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.6</span>),</span>
<span id="cb641-307"><a href="power-curve.html#cb641-307" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-308"><a href="power-curve.html#cb641-308" aria-hidden="true" tabindex="-1"></a>p_c <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-309"><a href="power-curve.html#cb641-309" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-310"><a href="power-curve.html#cb641-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-311"><a href="power-curve.html#cb641-311" aria-hidden="true" tabindex="-1"></a>p_c<span class="sc">$</span>power_df<span class="sc">$</span>corr_diff <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb641-312"><a href="power-curve.html#cb641-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-313"><a href="power-curve.html#cb641-313" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-314"><a href="power-curve.html#cb641-314" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-315"><a href="power-curve.html#cb641-315" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-316"><a href="power-curve.html#cb641-316" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-317"><a href="power-curve.html#cb641-317" aria-hidden="true" tabindex="-1"></a>                              r <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb641-318"><a href="power-curve.html#cb641-318" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.7</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-319"><a href="power-curve.html#cb641-319" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-320"><a href="power-curve.html#cb641-320" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.7</span>), </span>
<span id="cb641-321"><a href="power-curve.html#cb641-321" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-322"><a href="power-curve.html#cb641-322" aria-hidden="true" tabindex="-1"></a>p_d <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-323"><a href="power-curve.html#cb641-323" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-324"><a href="power-curve.html#cb641-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-325"><a href="power-curve.html#cb641-325" aria-hidden="true" tabindex="-1"></a>p_d<span class="sc">$</span>power_df<span class="sc">$</span>corr_diff <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb641-326"><a href="power-curve.html#cb641-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-327"><a href="power-curve.html#cb641-327" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-328"><a href="power-curve.html#cb641-328" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-329"><a href="power-curve.html#cb641-329" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-330"><a href="power-curve.html#cb641-330" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-331"><a href="power-curve.html#cb641-331" aria-hidden="true" tabindex="-1"></a>                              r <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb641-332"><a href="power-curve.html#cb641-332" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-333"><a href="power-curve.html#cb641-333" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-334"><a href="power-curve.html#cb641-334" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.8</span>), </span>
<span id="cb641-335"><a href="power-curve.html#cb641-335" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-336"><a href="power-curve.html#cb641-336" aria-hidden="true" tabindex="-1"></a>p_e <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-337"><a href="power-curve.html#cb641-337" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-338"><a href="power-curve.html#cb641-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-339"><a href="power-curve.html#cb641-339" aria-hidden="true" tabindex="-1"></a>p_e<span class="sc">$</span>power_df<span class="sc">$</span>corr_diff <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb641-340"><a href="power-curve.html#cb641-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-341"><a href="power-curve.html#cb641-341" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb641-342"><a href="power-curve.html#cb641-342" aria-hidden="true" tabindex="-1"></a>                              <span class="at">n =</span> <span class="dv">20</span>, </span>
<span id="cb641-343"><a href="power-curve.html#cb641-343" aria-hidden="true" tabindex="-1"></a>                              <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), </span>
<span id="cb641-344"><a href="power-curve.html#cb641-344" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="dv">1</span>, </span>
<span id="cb641-345"><a href="power-curve.html#cb641-345" aria-hidden="true" tabindex="-1"></a>                              r <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb641-346"><a href="power-curve.html#cb641-346" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.9</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-347"><a href="power-curve.html#cb641-347" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.4</span>, <span class="fl">0.4</span>,</span>
<span id="cb641-348"><a href="power-curve.html#cb641-348" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.9</span>), </span>
<span id="cb641-349"><a href="power-curve.html#cb641-349" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labelnames =</span> labelnames)</span>
<span id="cb641-350"><a href="power-curve.html#cb641-350" aria-hidden="true" tabindex="-1"></a>p_f <span class="ot">&lt;-</span> <span class="fu">plot_power</span>(design_result,</span>
<span id="cb641-351"><a href="power-curve.html#cb641-351" aria-hidden="true" tabindex="-1"></a>                  <span class="at">max_n =</span> <span class="dv">100</span>)</span>
<span id="cb641-352"><a href="power-curve.html#cb641-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-353"><a href="power-curve.html#cb641-353" aria-hidden="true" tabindex="-1"></a>p_f<span class="sc">$</span>power_df<span class="sc">$</span>corr_diff <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb641-354"><a href="power-curve.html#cb641-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-355"><a href="power-curve.html#cb641-355" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p_a<span class="sc">$</span>power_df, p_b<span class="sc">$</span>power_df, p_c<span class="sc">$</span>power_df, </span>
<span id="cb641-356"><a href="power-curve.html#cb641-356" aria-hidden="true" tabindex="-1"></a>                   p_d<span class="sc">$</span>power_df, p_e<span class="sc">$</span>power_df, p_f<span class="sc">$</span>power_df)<span class="sc">%&gt;%</span></span>
<span id="cb641-357"><a href="power-curve.html#cb641-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AxB =</span> <span class="st">`</span><span class="at">A:B</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(n,corr_diff,A,B,AxB)</span>
<span id="cb641-358"><a href="power-curve.html#cb641-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-359"><a href="power-curve.html#cb641-359" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">=</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb641-360"><a href="power-curve.html#cb641-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;AxB&quot;</span>, <span class="at">key =</span> factor, <span class="at">value =</span> power)</span>
<span id="cb641-361"><a href="power-curve.html#cb641-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb641-362"><a href="power-curve.html#cb641-362" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_data, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power,</span>
<span id="cb641-363"><a href="power-curve.html#cb641-363" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="fu">as.factor</span>(corr_diff))) <span class="sc">+</span></span>
<span id="cb641-364"><a href="power-curve.html#cb641-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb641-365"><a href="power-curve.html#cb641-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb641-366"><a href="power-curve.html#cb641-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Difference in Correlation&quot;</span>,</span>
<span id="cb641-367"><a href="power-curve.html#cb641-367" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sample Size per Group&quot;</span>,</span>
<span id="cb641-368"><a href="power-curve.html#cb641-368" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Power (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb641-369"><a href="power-curve.html#cb641-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> factor, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-potvin2000statistical" class="csl-entry">
Potvin, Patrick J, and Robert W Schutz. 2000. <span>“Statistical Power for the Two-Factor Repeated Measures ANOVA.”</span> <em>Behavior Research Methods, Instruments, &amp; Computers</em> 32 (2): 347–56. <a href="https://psycnet.apa.org/doi/10.3758/BF03207805">https://psycnet.apa.org/doi/10.3758/BF03207805</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analytic-power-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="violations-of-assumptions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
