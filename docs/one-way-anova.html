<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 One-Way ANOVA | Power Analysis with Superpower</title>
  <meta name="description" content="This is a book describing the capabilities of the Superpower R package." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 One-Way ANOVA | Power Analysis with Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the capabilities of the Superpower R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 One-Way ANOVA | Power Analysis with Superpower" />
  
  <meta name="twitter:description" content="This is a book describing the capabilities of the Superpower R package." />
  

<meta name="author" content="Aaron R. Caldwell, Daniël Lakens, Chelsea M. Parlett-Pelleriti, and Guy Prochilo" />


<meta name="date" content="2021-03-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-experimental-design.html"/>
<link rel="next" href="repeated-measures-anova.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Superpower</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i>Funding</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html"><i class="fa fa-check"></i><b>1</b> Introduction to Power Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#overview-of-power-analysis"><i class="fa fa-check"></i><b>1.1</b> Overview of Power Analysis</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#error-and-power"><i class="fa fa-check"></i><b>1.2</b> Error and Power</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#effect-size"><i class="fa fa-check"></i><b>1.3</b> Effect size</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#samp_vs_pop"><i class="fa fa-check"></i><b>1.4</b> Sample effect size vs. population effect size</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#safeguard-effect-size"><i class="fa fa-check"></i><b>1.5</b> Safeguard Effect Size</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>1.6</b> <em>Post hoc</em> power analysis</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-sample-effect-size-is-not-the-population-effect-size"><i class="fa fa-check"></i><b>1.6.1</b> The sample effect size is <em>not</em> the population effect size</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-is-merely-a-transformation-of-your-obtained-p-value"><i class="fa fa-check"></i><b>1.6.2</b> <em>Post hoc</em> power is merely a transformation of your obtained <em>p</em> value</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-minimal-detectable-effect-size"><i class="fa fa-check"></i><b>1.7</b> The Minimal Detectable Effect Size</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-experimental-design.html"><a href="the-experimental-design.html"><i class="fa fa-check"></i><b>2</b> The Experimental Design</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#anova_design-function"><i class="fa fa-check"></i><b>2.1</b> ANOVA_design function</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-design-using-design"><i class="fa fa-check"></i><b>2.1.1</b> Specifying the design using <code>design</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-means-using-mu"><i class="fa fa-check"></i><b>2.1.2</b> Specifying the means using <code>mu</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-label-names"><i class="fa fa-check"></i><b>2.1.3</b> Specifying label names</a></li>
<li class="chapter" data-level="2.1.4" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-correlation"><i class="fa fa-check"></i><b>2.1.4</b> Specifying the correlation</a></li>
<li class="chapter" data-level="2.1.5" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-sample-size"><i class="fa fa-check"></i><b>2.1.5</b> Specifying the sample size</a></li>
<li class="chapter" data-level="2.1.6" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-standard-deviation"><i class="fa fa-check"></i><b>2.1.6</b> Specifying the standard deviation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions</a></li>
<li class="chapter" data-level="3.1.2" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>3.1.2</b> Three conditions</a></li>
<li class="chapter" data-level="3.1.3" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.1.3</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#effect-size-estimates-for-one-way-anova"><i class="fa fa-check"></i><b>3.2</b> Effect Size Estimates for One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>3.2.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="3.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="3.2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>3.2.3</b> Two conditions, large effect size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>4.1</b> Part 1</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-2"><i class="fa fa-check"></i><b>4.2</b> Part 2</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>4.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="4.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-3"><i class="fa fa-check"></i><b>4.3</b> Part 3</a></li>
<li class="chapter" data-level="4.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-4"><i class="fa fa-check"></i><b>4.4</b> Part 4</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-within-design"><i class="fa fa-check"></i><b>4.4.1</b> 2x2 ANOVA, within-within design</a></li>
<li class="chapter" data-level="4.4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>4.4.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-5"><i class="fa fa-check"></i><b>4.5</b> Part 5</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-design"><i class="fa fa-check"></i><b>4.5.1</b> 2x2 ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#multivariate-anova-manova"><i class="fa fa-check"></i><b>4.6</b> Multivariate ANOVA (MANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>5</b> Mixed ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-mixed-designs"><i class="fa fa-check"></i><b>5.1</b> Simple Mixed Designs</a></li>
<li class="chapter" data-level="5.2" data-path="mixed-anova.html"><a href="mixed-anova.html#complex-mixed-designs"><i class="fa fa-check"></i><b>5.2</b> Complex Mixed Designs</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#b3w-design"><i class="fa fa-check"></i><b>5.2.1</b> 2b*3w Design</a></li>
<li class="chapter" data-level="5.2.2" data-path="mixed-anova.html"><a href="mixed-anova.html#b4w-design"><i class="fa fa-check"></i><b>5.2.2</b> 2b*4w Design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="power-for-three-way-interactions.html"><a href="power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>6</b> Power for Three-way Interactions</a></li>
<li class="chapter" data-level="7" data-path="the-no-way-interactions.html"><a href="the-no-way-interactions.html"><i class="fa fa-check"></i><b>7</b> The ‘No-Way’ Interactions</a></li>
<li class="chapter" data-level="8" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html"><i class="fa fa-check"></i><b>8</b> Effect of Varying Designs on Power</a>
<ul>
<li class="chapter" data-level="8.1" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html#within-designs"><i class="fa fa-check"></i><b>8.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>9</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="10" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subjects-anova"><i class="fa fa-check"></i><b>10.1</b> One-Way Between Subjects ANOVA</a></li>
<li class="chapter" data-level="10.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>10.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="10.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>10.3</b> 3x3 Between Subject ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>11</b> Power Curve</a>
<ul>
<li class="chapter" data-level="11.1" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-moderated-interactions."><i class="fa fa-check"></i><b>11.1</b> Explore increase in effect size for moderated interactions.</a></li>
<li class="chapter" data-level="11.2" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>11.2</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="11.3" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>11.3</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="11.4" data-path="power-curve.html"><a href="power-curve.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>11.4</b> Increasing correlation in on factor decreases power in second factor</a></li>
<li class="chapter" data-level="11.5" data-path="power-curve.html"><a href="power-curve.html#code-to-reproduce-power-curve-figures"><i class="fa fa-check"></i><b>11.5</b> Code to Reproduce Power Curve Figures</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html"><i class="fa fa-check"></i><b>12</b> Violations of Assumptions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-heterogeneity-assumption"><i class="fa fa-check"></i><b>12.1</b> Violation of Heterogeneity Assumption</a></li>
<li class="chapter" data-level="12.2" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-the-sphericity-assumption"><i class="fa fa-check"></i><b>12.2</b> Violation of the sphericity assumption</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#manova-or-sphericity-adjustment"><i class="fa fa-check"></i><b>12.2.1</b> MANOVA or Sphericity Adjustment?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html"><i class="fa fa-check"></i><b>13</b> Estimated Marginal Means</a>
<ul>
<li class="chapter" data-level="13.1" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#a-note-of-caution"><i class="fa fa-check"></i><b>13.1</b> A note of caution</a></li>
<li class="chapter" data-level="13.2" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#pairwise-comparisons"><i class="fa fa-check"></i><b>13.2</b> Pairwise Comparisons</a></li>
<li class="chapter" data-level="13.3" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#customized-emmeans-contrasts"><i class="fa fa-check"></i><b>13.3</b> Customized <code>emmeans</code> contrasts</a></li>
<li class="chapter" data-level="13.4" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#equivalence-and-non-superiority-inferiority-tests"><i class="fa fa-check"></i><b>13.4</b> Equivalence and non-superiority/-inferiority tests</a></li>
<li class="chapter" data-level="13.5" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#joint-tests"><i class="fa fa-check"></i><b>13.5</b> Joint tests</a></li>
<li class="chapter" data-level="13.6" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#monte-carlo-simulations"><i class="fa fa-check"></i><b>13.6</b> Monte Carlo Simulations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html"><i class="fa fa-check"></i><b>14</b> Beyond Superpower I: Mixed Models with <code>simr</code></a></li>
<li class="chapter" data-level="15" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html"><i class="fa fa-check"></i><b>15</b> Beyond Superpower II: Custom Simulations</a></li>
<li class="chapter" data-level="" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html"><i class="fa fa-check"></i>Appendix 1: Direct Comparison to pwr2ppl</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-5"><i class="fa fa-check"></i><b>15.1</b> Examples from Chapter 5</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.15.2"><i class="fa fa-check"></i><b>15.1.1</b> Example 5.1/5.2</a></li>
<li class="chapter" data-level="15.1.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.3"><i class="fa fa-check"></i><b>15.1.2</b> Example 5.3</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-6"><i class="fa fa-check"></i><b>15.2</b> Examples from Chapter 6</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.2"><i class="fa fa-check"></i><b>15.2.1</b> Example from Table 6.2</a></li>
<li class="chapter" data-level="15.2.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.6"><i class="fa fa-check"></i><b>15.2.2</b> Example from Table 6.6</a></li>
<li class="chapter" data-level="15.2.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.8"><i class="fa fa-check"></i><b>15.2.3</b> Example from Table 6.8</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-chapter-7"><i class="fa fa-check"></i><b>15.3</b> Example from Chapter 7</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#from-table-7.2"><i class="fa fa-check"></i><b>15.3.1</b> From Table 7.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html"><i class="fa fa-check"></i>Appendix 3: Comparison to Brysbaert</a>
<ul>
<li class="chapter" data-level="15.4" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#one-way-anova-1"><i class="fa fa-check"></i><b>15.4</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication"><i class="fa fa-check"></i><b>15.4.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="15.4.2" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-1"><i class="fa fa-check"></i><b>15.4.2</b> Variation 1</a></li>
<li class="chapter" data-level="15.4.3" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>15.4.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="15.4.4" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-2"><i class="fa fa-check"></i><b>15.4.4</b> Variation 2</a></li>
<li class="chapter" data-level="15.4.5" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>15.4.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#repeated-measures"><i class="fa fa-check"></i><b>15.5</b> Repeated Measures</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>15.5.1</b> Reproducing Brysbaert Variation 1: Changing Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-direct-comparison-to-morepower.html"><a href="appendix-2-direct-comparison-to-morepower.html"><i class="fa fa-check"></i>Appendix 2: Direct Comparison to MOREpower</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Power Analysis with Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-way-anova" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> One-Way ANOVA</h1>
<div id="introduction" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>Using the formula also used by <span class="citation"><a href="references.html#ref-albers2018power" role="doc-biblioref">Albers and Lakens</a> (<a href="references.html#ref-albers2018power" role="doc-biblioref">2018</a>)</span>, we can determine the means that should yield a specified effect sizes (expressed in Cohen’s <em>f</em>). Eta-squared (identical to partial eta-squared for one-way ANOVA’s) has benchmarks of .0099, .0588, and .1379 for small, medium, and large effect sizes <span class="citation">(<a href="references.html#ref-cohen1988spa" role="doc-biblioref">Cohen 1988</a>)</span>. Although these benchmarks are quite arbitrary, and researchers should only use such benchmarks for power analyses as a last resort, we will demonstrate an a priori power analysis for these values.</p>
<div id="two-conditions" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Two conditions</h3>
<p>Imagine we aim to design a study to test the hypothesis that giving people a pet to take care of will increase their life satisfaction. We have a control condition, and a condition where people get a pet, and randomly assign participants to either condition. We can simulate a one-way ANOVA with a specified alpha, sample size, and effect size, on see the statistical power we would have for the ANOVA and the follow-up comparisons. We expect pets to increase life-satisfaction compared to the control condition. Based on work by <span class="citation"><a href="references.html#ref-pavot1993affective" role="doc-biblioref">Pavot and Diener</a> (<a href="references.html#ref-pavot1993affective" role="doc-biblioref">1993</a>)</span> we believe that we can expect responses on the life-satifaction scale to have a mean of approximately 24 in our population, with a standard deviation of 6.4. We expect having a pet increases life satisfaction with approximately 2.2 scale points for participants who get a pet. There are 200 participants in total, with 100 participants in each condition. But before we proceed with the data collection, we examine the statistical power our design would have to detect the differences we predict.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="one-way-anova.html#cb45-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b&quot;</span></span>
<span id="cb45-2"><a href="one-way-anova.html#cb45-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb45-3"><a href="one-way-anova.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We are thinking of running 100 people in each condition</span></span>
<span id="cb45-4"><a href="one-way-anova.html#cb45-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="fl">26.2</span>)</span>
<span id="cb45-5"><a href="one-way-anova.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb45-6"><a href="one-way-anova.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, control, pet.</span></span>
<span id="cb45-7"><a href="one-way-anova.html#cb45-7" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">6.4</span></span>
<span id="cb45-8"><a href="one-way-anova.html#cb45-8" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;pet&quot;</span>) <span class="co">#</span></span>
<span id="cb45-9"><a href="one-way-anova.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb45-10"><a href="one-way-anova.html#cb45-10" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb45-11"><a href="one-way-anova.html#cb45-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n,</span>
<span id="cb45-12"><a href="one-way-anova.html#cb45-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu,</span>
<span id="cb45-13"><a href="one-way-anova.html#cb45-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd,</span>
<span id="cb45-14"><a href="one-way-anova.html#cb45-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> labelnames)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/start_one_way-1.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="one-way-anova.html#cb46-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb46-2"><a href="one-way-anova.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You should think carefully about how to justify your alpha level.</span></span>
<span id="cb46-3"><a href="one-way-anova.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We will use 0.05 in most examples, but do not support using a 0.05 alpha level for all analyses.</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="one-way-anova.html#cb47-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb47-2"><a href="one-way-anova.html#cb47-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb47-3"><a href="one-way-anova.html#cb47-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb47-4"><a href="one-way-anova.html#cb47-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-30">Table 3.1: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_condition
</td>
<td style="text-align:right;">
67.79
</td>
<td style="text-align:right;">
0.0335176
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="one-way-anova.html#cb48-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb48-2"><a href="one-way-anova.html#cb48-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb48-3"><a href="one-way-anova.html#cb48-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-32">Table 3.2: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition
</td>
<td style="text-align:right;">
67.68572
</td>
<td style="text-align:right;">
0.0289748
</td>
<td style="text-align:right;">
0.1727409
</td>
<td style="text-align:right;">
5.908203
</td>
</tr>
</tbody>
</table>
<p>The result shows that we have exactly the same power for the ANOVA (note: in the simulation, values will differ slightly, but with a large number of simulations, power estimates will be identical), as we have for the <em>t</em>-test. When there are only two groups, these tests are mathematically identical. In a study with 100 participants, we would have quite low power (around 67.7%). An ANOVA with 2 groups is identical to a <em>t</em>-test. For our example, Cohen’s d (the standardized mean difference) is 2.2/6.4, or d = 0.34375 for the difference between the control condition and pets, which we can use to easily compute the expected power for these simple comparisons using the <code>pwr</code> <span class="citation">(<a href="references.html#ref-R-pwr" role="doc-biblioref">2020</a>)</span> package.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="one-way-anova.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">2.2</span><span class="sc">/</span><span class="fl">6.4</span>,</span>
<span id="cb49-2"><a href="one-way-anova.html#cb49-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb49-3"><a href="one-way-anova.html#cb49-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb49-4"><a href="one-way-anova.html#cb49-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb49-5"><a href="one-way-anova.html#cb49-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.6768572</code></pre>
<p>We can also directly compute Cohen’s <em>f</em> from Cohen’s d for two groups, as <span class="citation"><a href="references.html#ref-cohen1988spa" role="doc-biblioref">Cohen</a> (<a href="references.html#ref-cohen1988spa" role="doc-biblioref">1988</a>)</span> describes, because <em>f</em> = 1/2d. So <em>f</em> = 0.5*0.34375 = 0.171875. And indeed, power analysis using the pwr package yields the same result using the <code>pwr.anova.test</code> as the <code>power.t.test</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="one-way-anova.html#cb51-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb51-2"><a href="one-way-anova.html#cb51-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb51-3"><a href="one-way-anova.html#cb51-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fl">0.171875</span></span>
<span id="cb51-4"><a href="one-way-anova.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">n =</span> n,</span>
<span id="cb51-5"><a href="one-way-anova.html#cb51-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">k =</span> K,</span>
<span id="cb51-6"><a href="one-way-anova.html#cb51-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">f =</span> f,</span>
<span id="cb51-7"><a href="one-way-anova.html#cb51-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">sig.level =</span> alpha_level)<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.6768572</code></pre>
<p>This analysis tells us that running the study with 100 participants in each condition is very likely to <em>not</em> yield a significant test result, even if our expected pattern of differences is true. This is not optimal.</p>
<p>Let’s mathematically explore which pattern of means we would need to expect to have 90% power for the ANOVA with 100 participants in each group. We can use the pwr package in R to compute a sensitivity analysis that tells us the effect size, in Cohen’s <em>f</em>, that we are able to detect with 2 groups and 100 participants in each group, in order to achieve 90% power with an alpha level of 5%.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="one-way-anova.html#cb53-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb53-2"><a href="one-way-anova.html#cb53-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb53-3"><a href="one-way-anova.html#cb53-3" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">6.4</span></span>
<span id="cb53-4"><a href="one-way-anova.html#cb53-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-5"><a href="one-way-anova.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate f when running simulation</span></span>
<span id="cb53-6"><a href="one-way-anova.html#cb53-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(<span class="at">n =</span> n,</span>
<span id="cb53-7"><a href="one-way-anova.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">k =</span> K,</span>
<span id="cb53-8"><a href="one-way-anova.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">power =</span> <span class="fl">0.9</span>,</span>
<span id="cb53-9"><a href="one-way-anova.html#cb53-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sig.level =</span> alpha_level)<span class="sc">$</span>f</span>
<span id="cb53-10"><a href="one-way-anova.html#cb53-10" aria-hidden="true" tabindex="-1"></a>f</span></code></pre></div>
<pre><code>## [1] 0.2303587</code></pre>
<p>This sensitivity analysis shows we have 90% power in our planned design to detect effects of Cohen’s <em>f</em> of 0.2303587. Benchmarks by <span class="citation"><a href="references.html#ref-cohen1988spa" role="doc-biblioref">Cohen</a> (<a href="references.html#ref-cohen1988spa" role="doc-biblioref">1988</a>)</span> for small, medium, and large Cohen’s <em>f</em> values are 0.1, 0.25, and 0.4, which correspond to eta-squared values of small (.0099), medium (.0588), and large (.1379), in line with d = .2, .5, or .8. So, at least based on these benchmarks, we have 90% power to detect effects that are slightly below a medium effect benchmark.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="one-way-anova.html#cb55-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> f<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb55-2"><a href="one-way-anova.html#cb55-2" aria-hidden="true" tabindex="-1"></a>ES <span class="ot">&lt;-</span> f2 <span class="sc">/</span> (f2 <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb55-3"><a href="one-way-anova.html#cb55-3" aria-hidden="true" tabindex="-1"></a>ES</span></code></pre></div>
<pre><code>## [1] 0.0503911</code></pre>
<p>Expressed in eta-squared, we can detect values of eta-squared = 0.05 or larger.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="one-way-anova.html#cb57-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mu_from_ES</span>(<span class="at">K =</span> K, <span class="at">ES =</span> ES)</span>
<span id="cb57-2"><a href="one-way-anova.html#cb57-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> mu <span class="sc">*</span> sd</span>
<span id="cb57-3"><a href="one-way-anova.html#cb57-3" aria-hidden="true" tabindex="-1"></a>mu</span></code></pre></div>
<pre><code>## [1] -1.474295  1.474295</code></pre>
<p>We can compute a pattern of means, given a standard deviation of 6.4, that would give us an effect size of <em>f</em> = 0.23, or eta-squared of 0.05. We should be able to accomplish this is the means are -1.474295 and 1.474295. We can use these values to confirm the ANOVA has 90% power.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="one-way-anova.html#cb59-1" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(</span>
<span id="cb59-2"><a href="one-way-anova.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> string,</span>
<span id="cb59-3"><a href="one-way-anova.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> n,</span>
<span id="cb59-4"><a href="one-way-anova.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> mu,</span>
<span id="cb59-5"><a href="one-way-anova.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> sd,</span>
<span id="cb59-6"><a href="one-way-anova.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">labelnames =</span> labelnames</span>
<span id="cb59-7"><a href="one-way-anova.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="one-way-anova.html#cb60-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb60-2"><a href="one-way-anova.html#cb60-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb60-3"><a href="one-way-anova.html#cb60-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb60-4"><a href="one-way-anova.html#cb60-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-40">Table 3.3: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_condition
</td>
<td style="text-align:right;">
89.64
</td>
<td style="text-align:right;">
0.0549452
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="one-way-anova.html#cb61-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb61-2"><a href="one-way-anova.html#cb61-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb61-3"><a href="one-way-anova.html#cb61-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-42">Table 3.4: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition
</td>
<td style="text-align:right;">
90.00714
</td>
<td style="text-align:right;">
0.0508742
</td>
<td style="text-align:right;">
0.2315192
</td>
<td style="text-align:right;">
10.61302
</td>
</tr>
</tbody>
</table>
<p>The simulation confirms that for the <em>F</em>-test for the ANOVA we have 90% power. This is also what g*power tells us what would happen based on a post-hoc power analysis with an <em>f</em> of 0.2303587, 2 groups, 200 participants in total (100 in each between subject condition), and an alpha of 5%.</p>
<p><img src="screenshots/gpower_8.png" /></p>
<p>If we return to our expected means, how many participants do we need for sufficient power? Given the expected difference and standard deviation, d = 0.34375, and <em>f</em> = 0.171875. We can perform an a priori power analysis for this simple case, which tells us we need 179 participants in each group (we can’t split people in parts, and thus always round a power analysis upward), or 358 in total.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="one-way-anova.html#cb62-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb62-2"><a href="one-way-anova.html#cb62-2" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb62-3"><a href="one-way-anova.html#cb62-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fl">0.171875</span></span>
<span id="cb62-4"><a href="one-way-anova.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">power =</span> power,</span>
<span id="cb62-5"><a href="one-way-anova.html#cb62-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">k =</span> K,</span>
<span id="cb62-6"><a href="one-way-anova.html#cb62-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">f =</span> f,</span>
<span id="cb62-7"><a href="one-way-anova.html#cb62-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">sig.level =</span> alpha_level)</span></code></pre></div>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 2
##               n = 178.8104
##               f = 0.171875
##       sig.level = 0.05
##           power = 0.9
## 
## NOTE: n is number in each group</code></pre>
<p>If we re-run the simulation with this sample size, we indeed have 90% power.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="one-way-anova.html#cb64-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b&quot;</span></span>
<span id="cb64-2"><a href="one-way-anova.html#cb64-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">179</span></span>
<span id="cb64-3"><a href="one-way-anova.html#cb64-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="fl">26.2</span>)</span>
<span id="cb64-4"><a href="one-way-anova.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb64-5"><a href="one-way-anova.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, control, pet.</span></span>
<span id="cb64-6"><a href="one-way-anova.html#cb64-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">6.4</span></span>
<span id="cb64-7"><a href="one-way-anova.html#cb64-7" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;pet&quot;</span>) <span class="co">#</span></span>
<span id="cb64-8"><a href="one-way-anova.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb64-9"><a href="one-way-anova.html#cb64-9" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(</span>
<span id="cb64-10"><a href="one-way-anova.html#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="at">design =</span> string,</span>
<span id="cb64-11"><a href="one-way-anova.html#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="at">n =</span> n,</span>
<span id="cb64-12"><a href="one-way-anova.html#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="at">mu =</span> mu,</span>
<span id="cb64-13"><a href="one-way-anova.html#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="at">sd =</span> sd,</span>
<span id="cb64-14"><a href="one-way-anova.html#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="at">labelnames =</span> labelnames</span>
<span id="cb64-15"><a href="one-way-anova.html#cb64-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="one-way-anova.html#cb65-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="one-way-anova.html#cb66-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb66-2"><a href="one-way-anova.html#cb66-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb66-3"><a href="one-way-anova.html#cb66-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb66-4"><a href="one-way-anova.html#cb66-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-46">Table 3.5: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_condition
</td>
<td style="text-align:right;">
89.99
</td>
<td style="text-align:right;">
0.0315309
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="one-way-anova.html#cb67-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb67-2"><a href="one-way-anova.html#cb67-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb67-3"><a href="one-way-anova.html#cb67-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-48">Table 3.6: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition
</td>
<td style="text-align:right;">
90.03028
</td>
<td style="text-align:right;">
0.0288499
</td>
<td style="text-align:right;">
0.1723571
</td>
<td style="text-align:right;">
10.57568
</td>
</tr>
</tbody>
</table>
<p>We stored the result from the power analysis in an object. This allows us to request plots (which are not printed automatically) showing the <em>p</em>-value distribution. If we request <code>simulation_result$plot1</code> we get the <em>p</em>-value distribution for the ANOVA:</p>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>If we request <code>simulation_result$plot2</code> we get the <em>p</em>-value distribution for the paired comparisons (in this case only one):</p>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-50-1.png" width="672" />

## Part 2</p>
</div>
<div id="three-conditions" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Three conditions</h3>
<p>Imagine we aim to design a study to test the hypothesis that giving people a pet to take care of will increase their life satisfaction. We have a control condition, a ‘cat’ pet condition, and a ‘dog’ pet condition. We can simulate a One-Way ANOVA with a specified alpha, sample size, and effect size, to see the statistical power we would have for the ANOVA and the follow-up comparisons. We expect all pets to increase life-satisfaction compared to the control condition. Obviously, we also expect the people who are in the ‘dog’ pet condition to have even greater life-satisfaction than people in the ‘cat’ pet condition. Based on work by Pavot and Diener (1993) we believe that we can expect responses on the life-satifaction scale to have a mean of approximately 24 in our population, with a standard deviation of 6.4. We expect having a pet increases life satisfaction with approximately 2.2 scale points for participants who get a cat, and 2.6 scale points for participants who get a dog. We initially consider collecting data from 150 participants in total, with 50 participants in each condition. But before we proceed with the data collection, we examine the statistical power our design would have to detect the differences we predict.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="one-way-anova.html#cb68-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;3b&quot;</span></span>
<span id="cb68-2"><a href="one-way-anova.html#cb68-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb68-3"><a href="one-way-anova.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We are thinking of running 50 peope in each condition</span></span>
<span id="cb68-4"><a href="one-way-anova.html#cb68-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="fl">26.2</span>, <span class="fl">26.6</span>)</span>
<span id="cb68-5"><a href="one-way-anova.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb68-6"><a href="one-way-anova.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, control, cat, dog.</span></span>
<span id="cb68-7"><a href="one-way-anova.html#cb68-7" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">6.4</span></span>
<span id="cb68-8"><a href="one-way-anova.html#cb68-8" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;control&quot;</span>, <span class="st">&quot;cat&quot;</span>, <span class="st">&quot;dog&quot;</span>) <span class="co">#</span></span>
<span id="cb68-9"><a href="one-way-anova.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb68-10"><a href="one-way-anova.html#cb68-10" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(</span>
<span id="cb68-11"><a href="one-way-anova.html#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="at">design =</span> string,</span>
<span id="cb68-12"><a href="one-way-anova.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="at">n =</span> n,</span>
<span id="cb68-13"><a href="one-way-anova.html#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="at">mu =</span> mu,</span>
<span id="cb68-14"><a href="one-way-anova.html#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="at">sd =</span> sd,</span>
<span id="cb68-15"><a href="one-way-anova.html#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="at">labelnames =</span> labelnames</span>
<span id="cb68-16"><a href="one-way-anova.html#cb68-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="one-way-anova.html#cb69-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="one-way-anova.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You should think carefully about how to justify your alpha level.</span></span>
<span id="cb70-2"><a href="one-way-anova.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We will give some examples later, but for now, use 0.05.</span></span>
<span id="cb70-3"><a href="one-way-anova.html#cb70-3" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb70-4"><a href="one-way-anova.html#cb70-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb70-5"><a href="one-way-anova.html#cb70-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb70-6"><a href="one-way-anova.html#cb70-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-53">Table 3.7: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_condition
</td>
<td style="text-align:right;">
48.22
</td>
<td style="text-align:right;">
0.0439651
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="one-way-anova.html#cb71-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb71-2"><a href="one-way-anova.html#cb71-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb71-3"><a href="one-way-anova.html#cb71-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-55">Table 3.8: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition
</td>
<td style="text-align:right;">
47.69468
</td>
<td style="text-align:right;">
0.0315259
</td>
<td style="text-align:right;">
0.180422
</td>
<td style="text-align:right;">
4.785156
</td>
</tr>
</tbody>
</table>
<p>The result shows that you would have quite low power with 50 participants, both for the overall ANOVA (just around 50% power), as for the follow up comparisons (approximately 40% power for the control vs cat condition, around 50% for the control vs dogs condition, and really low power (around 6%, just above the Type 1 error rate of 5%) for the expected difference between cats and dogs.</p>
</div>
<div id="power-for-simple-effects" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Power for simple effects</h3>
<p>We are typically not just interested in the ANOVA, but also in follow up comparisons. In this case, we would perform a <em>t</em>-test comparing the control condition against the cat and dog condition, and we would compare the cat and dog conditions against each other, in independent <em>t</em>-tests.</p>
<p>For our example, Cohen’s d (the standardized mean difference) is 2.2/6.4, or d = 0.34375 for the difference between the control condition and cats, 2.6/6.4 of d = 0.40625 for the difference between the control condition and dogs, and 0.4/6.4 or d = 0.0625 for the difference between cats and dogs as pets.</p>
<p>We can easily compute the expected power for these simple comparisons using the <code>pwr</code> package.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="one-way-anova.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb72-2"><a href="one-way-anova.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fl">2.2</span> <span class="sc">/</span> <span class="fl">6.4</span>,</span>
<span id="cb72-3"><a href="one-way-anova.html#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb72-4"><a href="one-way-anova.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb72-5"><a href="one-way-anova.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb72-6"><a href="one-way-anova.html#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb72-7"><a href="one-way-anova.html#cb72-7" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.3983064</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="one-way-anova.html#cb74-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwr.t.test</span>(</span>
<span id="cb74-2"><a href="one-way-anova.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fl">2.6</span> <span class="sc">/</span> <span class="fl">6.4</span>,</span>
<span id="cb74-3"><a href="one-way-anova.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb74-4"><a href="one-way-anova.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb74-5"><a href="one-way-anova.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb74-6"><a href="one-way-anova.html#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb74-7"><a href="one-way-anova.html#cb74-7" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.5205162</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="one-way-anova.html#cb76-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwr.t.test</span>(</span>
<span id="cb76-2"><a href="one-way-anova.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fl">0.4</span> <span class="sc">/</span> <span class="fl">6.4</span>,</span>
<span id="cb76-3"><a href="one-way-anova.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb76-4"><a href="one-way-anova.html#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb76-5"><a href="one-way-anova.html#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb76-6"><a href="one-way-anova.html#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb76-7"><a href="one-way-anova.html#cb76-7" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.06104044</code></pre>
<p>This analysis tells us that running the study with 50 participants in each condition is more likely to <em>not</em> yield a significant test result, even if our expected pattern of differences is true, than that we will observe a <em>p</em>-value smaller than our alpha level. This is not optimal.</p>
<p>Let’s mathematically explore which pattern of means we would need to expect to have 90% power for the ANOVA with 50 participants in each group. We can use the <code>pwr</code> package in R to compute a sensitivity analysis that tells us the effect size, in Cohen’s <em>f</em>, that we are able to detect with 3 groups and 50 partiicpants in each group, in order to achive 90% power with an alpha level of 5%.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="one-way-anova.html#cb78-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb78-2"><a href="one-way-anova.html#cb78-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb78-3"><a href="one-way-anova.html#cb78-3" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">6.4</span></span>
<span id="cb78-4"><a href="one-way-anova.html#cb78-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-5"><a href="one-way-anova.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate f when running simulation</span></span>
<span id="cb78-6"><a href="one-way-anova.html#cb78-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(<span class="at">n =</span> n,</span>
<span id="cb78-7"><a href="one-way-anova.html#cb78-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">k =</span> K,</span>
<span id="cb78-8"><a href="one-way-anova.html#cb78-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">power =</span> <span class="fl">0.9</span>,</span>
<span id="cb78-9"><a href="one-way-anova.html#cb78-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sig.level =</span> alpha_level)<span class="sc">$</span>f</span>
<span id="cb78-10"><a href="one-way-anova.html#cb78-10" aria-hidden="true" tabindex="-1"></a>f</span></code></pre></div>
<pre><code>## [1] 0.2934417</code></pre>
<p>This sensitivity analysis shows we have 90% power in our planned design to detect effects of Cohen’s <em>f</em> of 0.2934417. Benchmarks by <span class="citation"><a href="references.html#ref-cohen1988spa" role="doc-biblioref">Cohen</a> (<a href="references.html#ref-cohen1988spa" role="doc-biblioref">1988</a>)</span> for small, medium, and large Cohen’s <em>f</em> values are 0.1, 0.25, and 0.4, which correspond to eta-squared values of small (.0099), medium (.0588), and large (.1379), in line with d = .2, .5, or .8. So, at least based on these benchmarks, we have 90% power to detect effects that are somewhat sizeable.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="one-way-anova.html#cb80-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> f<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb80-2"><a href="one-way-anova.html#cb80-2" aria-hidden="true" tabindex="-1"></a>ES <span class="ot">&lt;-</span> f2 <span class="sc">/</span> (f2 <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb80-3"><a href="one-way-anova.html#cb80-3" aria-hidden="true" tabindex="-1"></a>ES</span></code></pre></div>
<pre><code>## [1] 0.07928127</code></pre>
<p>Expressed in eta-squared, we can detect values of eta-squared = 0.0793 or larger.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="one-way-anova.html#cb82-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mu_from_ES</span>(<span class="at">K =</span> K, <span class="at">ES =</span> ES)</span>
<span id="cb82-2"><a href="one-way-anova.html#cb82-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> mu <span class="sc">*</span> sd</span>
<span id="cb82-3"><a href="one-way-anova.html#cb82-3" aria-hidden="true" tabindex="-1"></a>mu</span></code></pre></div>
<pre><code>## [1] -2.300104  0.000000  2.300104</code></pre>
<p>We can compute a pattern of means, given a standard deviation of 6.4, that would give us an effect size of f = 0.2934, or eta-squared of 0.0793. We should be able to accomplish this if the means are -2.300104, 0.000000, and 2.300104. We can use these values to confirm the ANOVA has 90% power.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="one-way-anova.html#cb84-1" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(</span>
<span id="cb84-2"><a href="one-way-anova.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> string,</span>
<span id="cb84-3"><a href="one-way-anova.html#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> n,</span>
<span id="cb84-4"><a href="one-way-anova.html#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> mu,</span>
<span id="cb84-5"><a href="one-way-anova.html#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> sd,</span>
<span id="cb84-6"><a href="one-way-anova.html#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">labelnames =</span> labelnames</span>
<span id="cb84-7"><a href="one-way-anova.html#cb84-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="one-way-anova.html#cb85-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb85-2"><a href="one-way-anova.html#cb85-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb85-3"><a href="one-way-anova.html#cb85-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb85-4"><a href="one-way-anova.html#cb85-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-62">Table 3.9: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_condition
</td>
<td style="text-align:right;">
90.01
</td>
<td style="text-align:right;">
0.0903282
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="one-way-anova.html#cb86-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb86-2"><a href="one-way-anova.html#cb86-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb86-3"><a href="one-way-anova.html#cb86-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-64">Table 3.10: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition
</td>
<td style="text-align:right;">
90.00112
</td>
<td style="text-align:right;">
0.0807686
</td>
<td style="text-align:right;">
0.2964209
</td>
<td style="text-align:right;">
12.9162
</td>
</tr>
</tbody>
</table>
<p>The simulation confirms that for the <em>F</em>-test for the ANOVA we have 90% power. This is also what g*power tells us what would happen based on a post-hoc power analysis with an f of 0.2934417, 3 groups, 150 participants in total (50 in each between subject condition), and an alpha of 5%.</p>
<p><img src="screenshots/gpower_7.png" /></p>
<p>We can also compute the power for the ANOVA and simple effects in <code>R</code> with the <code>pwr</code> package. The calculated effect sizes and power match those from the simulation.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="one-way-anova.html#cb87-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb87-2"><a href="one-way-anova.html#cb87-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb87-3"><a href="one-way-anova.html#cb87-3" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">6.4</span></span>
<span id="cb87-4"><a href="one-way-anova.html#cb87-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fl">0.2934417</span></span>
<span id="cb87-5"><a href="one-way-anova.html#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(</span>
<span id="cb87-6"><a href="one-way-anova.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="at">n =</span> n,</span>
<span id="cb87-7"><a href="one-way-anova.html#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="at">k =</span> K,</span>
<span id="cb87-8"><a href="one-way-anova.html#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="at">f =</span> f,</span>
<span id="cb87-9"><a href="one-way-anova.html#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="at">sig.level =</span> alpha_level</span>
<span id="cb87-10"><a href="one-way-anova.html#cb87-10" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.9000112</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="one-way-anova.html#cb89-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">2.300104</span> <span class="sc">/</span> <span class="fl">6.4</span></span>
<span id="cb89-2"><a href="one-way-anova.html#cb89-2" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## [1] 0.3593912</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="one-way-anova.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb91-2"><a href="one-way-anova.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="at">d =</span> <span class="fl">2.300104</span> <span class="sc">/</span> <span class="fl">6.4</span>,</span>
<span id="cb91-3"><a href="one-way-anova.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb91-4"><a href="one-way-anova.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb91-5"><a href="one-way-anova.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb91-6"><a href="one-way-anova.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb91-7"><a href="one-way-anova.html#cb91-7" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.4284243</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="one-way-anova.html#cb93-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fl">2.300104</span> <span class="sc">/</span> <span class="fl">6.4</span></span>
<span id="cb93-2"><a href="one-way-anova.html#cb93-2" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## [1] 0.7187825</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="one-way-anova.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(</span>
<span id="cb95-2"><a href="one-way-anova.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="at">d =</span> d,</span>
<span id="cb95-3"><a href="one-way-anova.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="at">n =</span> <span class="dv">50</span>,</span>
<span id="cb95-4"><a href="one-way-anova.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb95-5"><a href="one-way-anova.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb95-6"><a href="one-way-anova.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb95-7"><a href="one-way-anova.html#cb95-7" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>power</span></code></pre></div>
<pre><code>## [1] 0.9450353</code></pre>
<p>We can also compare the results against the analytic solution by Aberson (2019).</p>
<p>First, load the function for a 3-way ANOVA from the <code>pwr2ppl</code> package.</p>
<p>Then we use the function to calculate power.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="one-way-anova.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Initial example, low power</span></span>
<span id="cb97-2"><a href="one-way-anova.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova1f_3</span>(</span>
<span id="cb97-3"><a href="one-way-anova.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="at">m1 =</span> <span class="dv">24</span>,</span>
<span id="cb97-4"><a href="one-way-anova.html#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="at">m2 =</span> <span class="fl">26.2</span>,</span>
<span id="cb97-5"><a href="one-way-anova.html#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="at">m3 =</span> <span class="fl">26.6</span>,</span>
<span id="cb97-6"><a href="one-way-anova.html#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="at">s1 =</span> <span class="fl">6.4</span>,</span>
<span id="cb97-7"><a href="one-way-anova.html#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="at">s2 =</span> <span class="fl">6.4</span>,</span>
<span id="cb97-8"><a href="one-way-anova.html#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="at">s3 =</span> <span class="fl">6.4</span>,</span>
<span id="cb97-9"><a href="one-way-anova.html#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="at">n1 =</span> <span class="dv">50</span>,</span>
<span id="cb97-10"><a href="one-way-anova.html#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="at">n2 =</span> <span class="dv">50</span>,</span>
<span id="cb97-11"><a href="one-way-anova.html#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="at">n3 =</span> <span class="dv">50</span>,</span>
<span id="cb97-12"><a href="one-way-anova.html#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="at">alpha =</span> .<span class="dv">05</span></span>
<span id="cb97-13"><a href="one-way-anova.html#cb97-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Sample size overall = 150</code></pre>
<pre><code>## Power  = 0.4769 for eta-squared = 0.0315</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="one-way-anova.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#From: Aberson, Christopher L.</span></span>
<span id="cb100-2"><a href="one-way-anova.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   Applied Power Analysis for the Behavioral Sciences, 2nd Edition.</span></span>
<span id="cb100-3"><a href="one-way-anova.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># $Power [1] 0.4769468</span></span>
<span id="cb100-4"><a href="one-way-anova.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Later example, based on larger mean difference</span></span>
<span id="cb100-5"><a href="one-way-anova.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova1f_3</span>(</span>
<span id="cb100-6"><a href="one-way-anova.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="at">m1 =</span> <span class="sc">-</span><span class="fl">2.300104</span>,</span>
<span id="cb100-7"><a href="one-way-anova.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="at">m2 =</span> <span class="dv">0</span>,</span>
<span id="cb100-8"><a href="one-way-anova.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="at">m3 =</span> <span class="fl">2.300104</span>,</span>
<span id="cb100-9"><a href="one-way-anova.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="at">s1 =</span> <span class="fl">6.4</span>,</span>
<span id="cb100-10"><a href="one-way-anova.html#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="at">s2 =</span> <span class="fl">6.4</span>,</span>
<span id="cb100-11"><a href="one-way-anova.html#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="at">s3 =</span> <span class="fl">6.4</span>,</span>
<span id="cb100-12"><a href="one-way-anova.html#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="at">n1 =</span> <span class="dv">50</span>,</span>
<span id="cb100-13"><a href="one-way-anova.html#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="at">n2 =</span> <span class="dv">50</span>,</span>
<span id="cb100-14"><a href="one-way-anova.html#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="at">n3 =</span> <span class="dv">50</span>,</span>
<span id="cb100-15"><a href="one-way-anova.html#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="at">alpha =</span> .<span class="dv">05</span></span>
<span id="cb100-16"><a href="one-way-anova.html#cb100-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Sample size overall = 150</code></pre>
<pre><code>## Power  = 0.9 for eta-squared = 0.0808</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="one-way-anova.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># $Power [1] 0.9000112</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="effect-size-estimates-for-one-way-anova" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Effect Size Estimates for One-Way ANOVA</h2>
<p>Using the formulas below, we can calculate the means for a one-way ANOVA. Using the formula from <span class="citation"><a href="references.html#ref-albers2018power" role="doc-biblioref">Albers and Lakens</a> (<a href="references.html#ref-albers2018power" role="doc-biblioref">2018</a>)</span>, we can determine the means that should yield a specified effect sizes (expressed in Cohen’s <em>f</em>).</p>
<p>Eta-squared (idential to partial eta-squared for one-way ANOVA’s) has benchmarks of .0099, .0588, and .1379 for small, medium, and large effect sizes <span class="citation">(<a href="references.html#ref-cohen1988spa" role="doc-biblioref">Cohen 1988</a>)</span>.</p>
<div id="three-conditions-small-effect-size" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Three conditions, small effect size</h3>
<p>We can simulate a one-factor anova, setting means to achieve a certain effect size. Eta-squared is biased. Thus, the eta-squared we calculate based on the observed data overestimates the population effect size. This bias is largest for smaller sample sizes. Thus, to test whether the simulation yields the expected effect size, we use extremele large sample sizes in each between subject condition (n = 5000). This simulation should yield a small effect size (0.099)</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="one-way-anova.html#cb104-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb104-2"><a href="one-way-anova.html#cb104-2" aria-hidden="true" tabindex="-1"></a>ES <span class="ot">&lt;-</span> .<span class="dv">0099</span></span>
<span id="cb104-3"><a href="one-way-anova.html#cb104-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mu_from_ES</span>(<span class="at">K =</span> K, <span class="at">ES =</span> ES)</span>
<span id="cb104-4"><a href="one-way-anova.html#cb104-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb104-5"><a href="one-way-anova.html#cb104-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-6"><a href="one-way-anova.html#cb104-6" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb104-7"><a href="one-way-anova.html#cb104-7" aria-hidden="true" tabindex="-1"></a>string <span class="ot">=</span> <span class="fu">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="one-way-anova.html#cb105-1" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(</span>
<span id="cb105-2"><a href="one-way-anova.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> string,</span>
<span id="cb105-3"><a href="one-way-anova.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> n,</span>
<span id="cb105-4"><a href="one-way-anova.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> mu,</span>
<span id="cb105-5"><a href="one-way-anova.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> sd,</span>
<span id="cb105-6"><a href="one-way-anova.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">r =</span> r,</span>
<span id="cb105-7"><a href="one-way-anova.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">labelnames =</span> <span class="fu">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>)</span>
<span id="cb105-8"><a href="one-way-anova.html#cb105-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="one-way-anova.html#cb106-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb106-2"><a href="one-way-anova.html#cb106-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb106-3"><a href="one-way-anova.html#cb106-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb106-4"><a href="one-way-anova.html#cb106-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-69">Table 3.11: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_factor1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0100136
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="one-way-anova.html#cb107-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb107-2"><a href="one-way-anova.html#cb107-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb107-3"><a href="one-way-anova.html#cb107-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-71">Table 3.12: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
factor1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.009902
</td>
<td style="text-align:right;">
0.100005
</td>
<td style="text-align:right;">
149.9848
</td>
</tr>
</tbody>
</table>
<p>The resulting effect size estimate from the simulation is very close to 0.0099</p>
</div>
<div id="four-conditions-medium-effect-size" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Four conditions, medium effect size</h3>
<p>This simulation should yield a medium effect size (0.0588) across four independent conditions.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="one-way-anova.html#cb108-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb108-2"><a href="one-way-anova.html#cb108-2" aria-hidden="true" tabindex="-1"></a>ES <span class="ot">&lt;-</span> .<span class="dv">0588</span></span>
<span id="cb108-3"><a href="one-way-anova.html#cb108-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mu_from_ES</span>(<span class="at">K =</span> K, <span class="at">ES =</span> ES)</span>
<span id="cb108-4"><a href="one-way-anova.html#cb108-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb108-5"><a href="one-way-anova.html#cb108-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb108-6"><a href="one-way-anova.html#cb108-6" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb108-7"><a href="one-way-anova.html#cb108-7" aria-hidden="true" tabindex="-1"></a>string <span class="ot">=</span> <span class="fu">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="one-way-anova.html#cb109-1" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(</span>
<span id="cb109-2"><a href="one-way-anova.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> string,</span>
<span id="cb109-3"><a href="one-way-anova.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> n,</span>
<span id="cb109-4"><a href="one-way-anova.html#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> mu,</span>
<span id="cb109-5"><a href="one-way-anova.html#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> sd,</span>
<span id="cb109-6"><a href="one-way-anova.html#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">r =</span> r,</span>
<span id="cb109-7"><a href="one-way-anova.html#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">labelnames =</span> <span class="fu">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>, <span class="st">&quot;level4&quot;</span>)</span>
<span id="cb109-8"><a href="one-way-anova.html#cb109-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="one-way-anova.html#cb110-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb110-2"><a href="one-way-anova.html#cb110-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb110-3"><a href="one-way-anova.html#cb110-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb110-4"><a href="one-way-anova.html#cb110-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-75">Table 3.13: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_factor1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0589616
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="one-way-anova.html#cb111-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb111-2"><a href="one-way-anova.html#cb111-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb111-3"><a href="one-way-anova.html#cb111-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-77">Table 3.14: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
factor1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0588111
</td>
<td style="text-align:right;">
0.2499719
</td>
<td style="text-align:right;">
1249.469
</td>
</tr>
</tbody>
</table>
<p>Results are very close to 0.0588.</p>
</div>
<div id="two-conditions-large-effect-size" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Two conditions, large effect size</h3>
<p>We can simulate a one-way ANOVA that should yield a large effect size (0.1379) across two conditions.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="one-way-anova.html#cb112-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb112-2"><a href="one-way-anova.html#cb112-2" aria-hidden="true" tabindex="-1"></a>ES <span class="ot">&lt;-</span> .<span class="dv">1379</span></span>
<span id="cb112-3"><a href="one-way-anova.html#cb112-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mu_from_ES</span>(<span class="at">K =</span> K, <span class="at">ES =</span> ES)</span>
<span id="cb112-4"><a href="one-way-anova.html#cb112-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb112-5"><a href="one-way-anova.html#cb112-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb112-6"><a href="one-way-anova.html#cb112-6" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb112-7"><a href="one-way-anova.html#cb112-7" aria-hidden="true" tabindex="-1"></a>string <span class="ot">=</span> <span class="fu">paste</span>(K,<span class="st">&quot;b&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="one-way-anova.html#cb113-1" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb113-2"><a href="one-way-anova.html#cb113-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n,</span>
<span id="cb113-3"><a href="one-way-anova.html#cb113-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu,</span>
<span id="cb113-4"><a href="one-way-anova.html#cb113-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd,</span>
<span id="cb113-5"><a href="one-way-anova.html#cb113-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">r =</span> r,</span>
<span id="cb113-6"><a href="one-way-anova.html#cb113-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> <span class="fu">c</span>(<span class="st">&quot;factor1&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>))</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="one-way-anova.html#cb114-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb114-2"><a href="one-way-anova.html#cb114-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb114-3"><a href="one-way-anova.html#cb114-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">nsims =</span> nsims,</span>
<span id="cb114-4"><a href="one-way-anova.html#cb114-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-81">Table 3.15: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_factor1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.1379965
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="one-way-anova.html#cb115-1" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result,</span>
<span id="cb115-2"><a href="one-way-anova.html#cb115-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb115-3"><a href="one-way-anova.html#cb115-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-83">Table 3.16: </span>Exact ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
factor1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.1379238
</td>
<td style="text-align:right;">
0.3999878
</td>
<td style="text-align:right;">
1599.582
</td>
</tr>
</tbody>
</table>
<p>The results are very close to is simulation should yield a small effect size (0.1379).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-experimental-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repeated-measures-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
