<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 The ‘No-Way’ Interactions | Power Analysis with Superpower</title>
  <meta name="description" content="This is a book describing the capabilities of the Superpower R package." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 The ‘No-Way’ Interactions | Power Analysis with Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the capabilities of the Superpower R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 The ‘No-Way’ Interactions | Power Analysis with Superpower" />
  
  <meta name="twitter:description" content="This is a book describing the capabilities of the Superpower R package." />
  

<meta name="author" content="Aaron R. Caldwell" />
<meta name="author" content="Daniël Lakens" />
<meta name="author" content="Chelsea M. Parlett-Pelleriti" />
<meta name="author" content="Guy Prochilo" />
<meta name="author" content="Frederik Aust" />


<meta name="date" content="2022-03-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="power-for-three-way-interactions.html"/>
<link rel="next" href="effect-of-varying-designs-on-power.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributions"><i class="fa fa-check"></i>Contributions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i>Funding</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html"><i class="fa fa-check"></i><b>1</b> Introduction to Power Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#overview-of-power-analysis"><i class="fa fa-check"></i><b>1.1</b> Overview of Power Analysis</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#error-and-power"><i class="fa fa-check"></i><b>1.2</b> Error and Power</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#effect-size"><i class="fa fa-check"></i><b>1.3</b> Effect size</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#samp_vs_pop"><i class="fa fa-check"></i><b>1.4</b> Sample effect size vs. population effect size</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#safeguard-effect-size"><i class="fa fa-check"></i><b>1.5</b> Safeguard Effect Size</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>1.6</b> <em>Post hoc</em> power analysis</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-sample-effect-size-is-not-the-population-effect-size"><i class="fa fa-check"></i><b>1.6.1</b> The sample effect size is <em>not</em> the population effect size</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-is-merely-a-transformation-of-your-obtained-p-value"><i class="fa fa-check"></i><b>1.6.2</b> <em>Post hoc</em> power is merely a transformation of your obtained <em>p</em> value</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-minimal-detectable-effect-size"><i class="fa fa-check"></i><b>1.7</b> The Minimal Detectable Effect Size</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-experimental-design.html"><a href="the-experimental-design.html"><i class="fa fa-check"></i><b>2</b> The Experimental Design</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#anova_design-function"><i class="fa fa-check"></i><b>2.1</b> ANOVA_design function</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-design-using-design"><i class="fa fa-check"></i><b>2.1.1</b> Specifying the design using <code>design</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-means-using-mu"><i class="fa fa-check"></i><b>2.1.2</b> Specifying the means using <code>mu</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-label-names"><i class="fa fa-check"></i><b>2.1.3</b> Specifying label names</a></li>
<li class="chapter" data-level="2.1.4" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-correlation"><i class="fa fa-check"></i><b>2.1.4</b> Specifying the correlation</a></li>
<li class="chapter" data-level="2.1.5" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-sample-size"><i class="fa fa-check"></i><b>2.1.5</b> Specifying the sample size</a></li>
<li class="chapter" data-level="2.1.6" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-standard-deviation"><i class="fa fa-check"></i><b>2.1.6</b> Specifying the standard deviation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions</a></li>
<li class="chapter" data-level="3.1.2" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>3.1.2</b> Three conditions</a></li>
<li class="chapter" data-level="3.1.3" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.1.3</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#effect-size-estimates-for-one-way-anova"><i class="fa fa-check"></i><b>3.2</b> Effect Size Estimates for One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>3.2.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="3.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="3.2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>3.2.3</b> Two conditions, large effect size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>4.1</b> Part 1</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-2"><i class="fa fa-check"></i><b>4.2</b> Part 2</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>4.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="4.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-3"><i class="fa fa-check"></i><b>4.3</b> Part 3</a></li>
<li class="chapter" data-level="4.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-4"><i class="fa fa-check"></i><b>4.4</b> Part 4</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-within-design"><i class="fa fa-check"></i><b>4.4.1</b> 2x2 ANOVA, within-within design</a></li>
<li class="chapter" data-level="4.4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>4.4.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-5"><i class="fa fa-check"></i><b>4.5</b> Part 5</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-design"><i class="fa fa-check"></i><b>4.5.1</b> 2x2 ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#multivariate-anova-manova"><i class="fa fa-check"></i><b>4.6</b> Multivariate ANOVA (MANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>5</b> Mixed ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-mixed-designs"><i class="fa fa-check"></i><b>5.1</b> Simple Mixed Designs</a></li>
<li class="chapter" data-level="5.2" data-path="mixed-anova.html"><a href="mixed-anova.html#complex-mixed-designs"><i class="fa fa-check"></i><b>5.2</b> Complex Mixed Designs</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#b3w-design"><i class="fa fa-check"></i><b>5.2.1</b> 2b*3w Design</a></li>
<li class="chapter" data-level="5.2.2" data-path="mixed-anova.html"><a href="mixed-anova.html#b4w-design"><i class="fa fa-check"></i><b>5.2.2</b> 2b*4w Design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="power-for-three-way-interactions.html"><a href="power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>6</b> Power for Three-way Interactions</a></li>
<li class="chapter" data-level="7" data-path="the-no-way-interactions.html"><a href="the-no-way-interactions.html"><i class="fa fa-check"></i><b>7</b> The ‘No-Way’ Interactions</a></li>
<li class="chapter" data-level="8" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html"><i class="fa fa-check"></i><b>8</b> Effect of Varying Designs on Power</a>
<ul>
<li class="chapter" data-level="8.1" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html#within-designs"><i class="fa fa-check"></i><b>8.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>9</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="10" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subjects-anova"><i class="fa fa-check"></i><b>10.1</b> One-Way Between Subjects ANOVA</a></li>
<li class="chapter" data-level="10.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>10.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="10.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>10.3</b> 3x3 Between Subject ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>11</b> Power Curve</a>
<ul>
<li class="chapter" data-level="11.1" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-moderated-interactions."><i class="fa fa-check"></i><b>11.1</b> Explore increase in effect size for moderated interactions.</a></li>
<li class="chapter" data-level="11.2" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>11.2</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="11.3" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>11.3</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="11.4" data-path="power-curve.html"><a href="power-curve.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>11.4</b> Increasing correlation in on factor decreases power in second factor</a></li>
<li class="chapter" data-level="11.5" data-path="power-curve.html"><a href="power-curve.html#code-to-reproduce-power-curve-figures"><i class="fa fa-check"></i><b>11.5</b> Code to Reproduce Power Curve Figures</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html"><i class="fa fa-check"></i><b>12</b> Violations of Assumptions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-heterogeneity-assumption"><i class="fa fa-check"></i><b>12.1</b> Violation of Heterogeneity Assumption</a></li>
<li class="chapter" data-level="12.2" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-the-sphericity-assumption"><i class="fa fa-check"></i><b>12.2</b> Violation of the sphericity assumption</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#manova-or-sphericity-adjustment"><i class="fa fa-check"></i><b>12.2.1</b> MANOVA or Sphericity Adjustment?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html"><i class="fa fa-check"></i><b>13</b> Estimated Marginal Means</a>
<ul>
<li class="chapter" data-level="13.1" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#a-note-of-caution"><i class="fa fa-check"></i><b>13.1</b> A note of caution</a></li>
<li class="chapter" data-level="13.2" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#pairwise-comparisons"><i class="fa fa-check"></i><b>13.2</b> Pairwise Comparisons</a></li>
<li class="chapter" data-level="13.3" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#customized-emmeans-contrasts"><i class="fa fa-check"></i><b>13.3</b> Customized <code>emmeans</code> contrasts</a></li>
<li class="chapter" data-level="13.4" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#equivalence-and-non-superiority-inferiority-tests"><i class="fa fa-check"></i><b>13.4</b> Equivalence and non-superiority/-inferiority tests</a></li>
<li class="chapter" data-level="13.5" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#joint-tests"><i class="fa fa-check"></i><b>13.5</b> Joint tests</a></li>
<li class="chapter" data-level="13.6" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#monte-carlo-simulations"><i class="fa fa-check"></i><b>13.6</b> Monte Carlo Simulations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html"><i class="fa fa-check"></i><b>14</b> Beyond Superpower I: Mixed Models with <code>simr</code></a>
<ul>
<li class="chapter" data-level="14.1" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html#how-does-simr-work"><i class="fa fa-check"></i><b>14.1</b> How does <code>simr</code> work?</a></li>
<li class="chapter" data-level="14.2" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html#to-be-continued"><i class="fa fa-check"></i><b>14.2</b> To Be Continued…</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html"><i class="fa fa-check"></i><b>15</b> Beyond Superpower II: Custom Simulations</a>
<ul>
<li class="chapter" data-level="15.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#a-clincal-trial-with-a-binary-outcome"><i class="fa fa-check"></i><b>15.1</b> A Clincal Trial with a Binary Outcome</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#proposed-study-and-approach"><i class="fa fa-check"></i><b>15.1.1</b> Proposed Study and Approach</a></li>
<li class="chapter" data-level="15.1.2" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#step-1-create-a-data-generating-function"><i class="fa fa-check"></i><b>15.1.2</b> Step 1: Create a Data Generating Function</a></li>
<li class="chapter" data-level="15.1.3" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#step-2-simulation"><i class="fa fa-check"></i><b>15.1.3</b> Step 2: Simulation</a></li>
<li class="chapter" data-level="15.1.4" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#why-more-complicated-code"><i class="fa fa-check"></i><b>15.1.4</b> Why more complicated code?</a></li>
<li class="chapter" data-level="15.1.5" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#conclusions-on-the-binary-rct-analysis"><i class="fa fa-check"></i><b>15.1.5</b> Conclusions on the Binary RCT Analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#binary-rct-with-a-interim-analysis"><i class="fa fa-check"></i><b>15.2</b> Binary RCT with a Interim Analysis</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#proposed-study-and-approach-1"><i class="fa fa-check"></i><b>15.2.1</b> Proposed Study and Approach</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#conclusion-on-a-binary-rct-with-interim-analyses"><i class="fa fa-check"></i><b>15.3</b> Conclusion on a Binary RCT with Interim Analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html"><i class="fa fa-check"></i>Appendix 1: Direct Comparison to pwr2ppl</a>
<ul>
<li class="chapter" data-level="15.4" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-5"><i class="fa fa-check"></i><b>15.4</b> Examples from Chapter 5</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.15.2"><i class="fa fa-check"></i><b>15.4.1</b> Example 5.1/5.2</a></li>
<li class="chapter" data-level="15.4.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.3"><i class="fa fa-check"></i><b>15.4.2</b> Example 5.3</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-6"><i class="fa fa-check"></i><b>15.5</b> Examples from Chapter 6</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.2"><i class="fa fa-check"></i><b>15.5.1</b> Example from Table 6.2</a></li>
<li class="chapter" data-level="15.5.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.6"><i class="fa fa-check"></i><b>15.5.2</b> Example from Table 6.6</a></li>
<li class="chapter" data-level="15.5.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.8"><i class="fa fa-check"></i><b>15.5.3</b> Example from Table 6.8</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-chapter-7"><i class="fa fa-check"></i><b>15.6</b> Example from Chapter 7</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#from-table-7.2"><i class="fa fa-check"></i><b>15.6.1</b> From Table 7.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-direct-comparison-to-morepower.html"><a href="appendix-2-direct-comparison-to-morepower.html"><i class="fa fa-check"></i>Appendix 2: Direct Comparison to MOREpower</a></li>
<li class="chapter" data-level="" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html"><i class="fa fa-check"></i>Appendix 3: Comparison to Brysbaert</a>
<ul>
<li class="chapter" data-level="15.7" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#one-way-anova-1"><i class="fa fa-check"></i><b>15.7</b> One-Way ANOVA</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication"><i class="fa fa-check"></i><b>15.7.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="15.7.2" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-1"><i class="fa fa-check"></i><b>15.7.2</b> Variation 1</a></li>
<li class="chapter" data-level="15.7.3" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>15.7.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="15.7.4" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-2"><i class="fa fa-check"></i><b>15.7.4</b> Variation 2</a></li>
<li class="chapter" data-level="15.7.5" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>15.7.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#repeated-measures"><i class="fa fa-check"></i><b>15.8</b> Repeated Measures</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>15.8.1</b> Reproducing Brysbaert Variation 1: Changing Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Power Analysis with Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-no-way-interactions" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> The ‘No-Way’ Interactions</h1>
<p>In the 17th Data Colada blog post titled <a href="http://datacolada.org/17">No-way Interactions</a> <span class="citation"><a href="#ref-simonsohn_2014" role="doc-biblioref">Simonsohn</a> (<a href="#ref-simonsohn_2014" role="doc-biblioref">2014</a>)</span> discusses how a moderated interaction (the effect is there in one condition, but disappears in another condition) requires at least twice as many subjects per cell as a study that simply aims to show the simple effect. For example, see the plot below. Assume the score on the vertical axis is desire for fruit, as a function of the fruit that is available (an apple or a banana) and how hungry people are (not, or very). We see there is a difference between the participants desire for a banana compared to an apple, but only for participants who are very hungry. The point that is made is that you need twice as many participants in each cell to have power for the interaction, as you need for the simple effect.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="the-no-way-interactions.html#cb393-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b&quot;</span></span>
<span id="cb393-2"><a href="the-no-way-interactions.html#cb393-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb393-3"><a href="the-no-way-interactions.html#cb393-3" aria-hidden="true" tabindex="-1"></a><span class="co"># All means are equal - so there is no real difference.</span></span>
<span id="cb393-4"><a href="the-no-way-interactions.html#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb393-5"><a href="the-no-way-interactions.html#cb393-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) </span>
<span id="cb393-6"><a href="the-no-way-interactions.html#cb393-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb393-7"><a href="the-no-way-interactions.html#cb393-7" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, </span>
<span id="cb393-8"><a href="the-no-way-interactions.html#cb393-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></span>
<span id="cb393-9"><a href="the-no-way-interactions.html#cb393-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb393-10"><a href="the-no-way-interactions.html#cb393-10" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb393-11"><a href="the-no-way-interactions.html#cb393-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb393-12"><a href="the-no-way-interactions.html#cb393-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb393-13"><a href="the-no-way-interactions.html#cb393-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb393-14"><a href="the-no-way-interactions.html#cb393-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> labelnames,</span>
<span id="cb393-15"><a href="the-no-way-interactions.html#cb393-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
<p>We can reproduce the simulations in the Data Colada blog post, using the original code.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="the-no-way-interactions.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co">#R-Code</span></span>
<span id="cb394-2"><a href="the-no-way-interactions.html#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb394-3"><a href="the-no-way-interactions.html#cb394-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Written by Uri Simonsohn, March 2014</span></span>
<span id="cb394-4"><a href="the-no-way-interactions.html#cb394-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb394-5"><a href="the-no-way-interactions.html#cb394-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb394-6"><a href="the-no-way-interactions.html#cb394-6" aria-hidden="true" tabindex="-1"></a><span class="co">#In DataColada[17] </span></span>
<span id="cb394-7"><a href="the-no-way-interactions.html#cb394-7" aria-hidden="true" tabindex="-1"></a><span class="co"># I propose that 2x2 interaction studies need 2x the sample size</span></span>
<span id="cb394-8"><a href="the-no-way-interactions.html#cb394-8" aria-hidden="true" tabindex="-1"></a><span class="co">#http://datacolada.org/2014/03/10/17-no-way-interactions</span></span>
<span id="cb394-9"><a href="the-no-way-interactions.html#cb394-9" aria-hidden="true" tabindex="-1"></a><span class="co">#In a companion ,pdf I show the simple math behind it</span></span>
<span id="cb394-10"><a href="the-no-way-interactions.html#cb394-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb394-11"><a href="the-no-way-interactions.html#cb394-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb394-12"><a href="the-no-way-interactions.html#cb394-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulations are often more persuasive than math, so here it goes.</span></span>
<span id="cb394-13"><a href="the-no-way-interactions.html#cb394-13" aria-hidden="true" tabindex="-1"></a><span class="co">#I run simulations that compute power for 2 and 4 cell design, </span></span>
<span id="cb394-14"><a href="the-no-way-interactions.html#cb394-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the latter testing the interaction</span></span>
<span id="cb394-15"><a href="the-no-way-interactions.html#cb394-15" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb394-16"><a href="the-no-way-interactions.html#cb394-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Create function that computes power of Studies 1 and 2, </span></span>
<span id="cb394-17"><a href="the-no-way-interactions.html#cb394-17" aria-hidden="true" tabindex="-1"></a><span class="co"># where Study 1  has 2 cells and tests a simple effect</span></span>
<span id="cb394-18"><a href="the-no-way-interactions.html#cb394-18" aria-hidden="true" tabindex="-1"></a><span class="co">#and Study 2 has 4 cells and tests the interaction</span></span>
<span id="cb394-19"><a href="the-no-way-interactions.html#cb394-19" aria-hidden="true" tabindex="-1"></a>colada17 <span class="ot">=</span> <span class="cf">function</span>(d1,d2,n1,n2,simtot)</span>
<span id="cb394-20"><a href="the-no-way-interactions.html#cb394-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb394-21"><a href="the-no-way-interactions.html#cb394-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n1: sample size, per cell, study 1</span></span>
<span id="cb394-22"><a href="the-no-way-interactions.html#cb394-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n2: sample size, per cell, study 2</span></span>
<span id="cb394-23"><a href="the-no-way-interactions.html#cb394-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#d1: simple effect M1-M2</span></span>
<span id="cb394-24"><a href="the-no-way-interactions.html#cb394-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#d2: moderated effect M3-M4, </span></span>
<span id="cb394-25"><a href="the-no-way-interactions.html#cb394-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># full elimination of effect implies d2=0</span></span>
<span id="cb394-26"><a href="the-no-way-interactions.html#cb394-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#simtot: how many simulations to run</span></span>
<span id="cb394-27"><a href="the-no-way-interactions.html#cb394-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Here we will store results</span></span>
<span id="cb394-28"><a href="the-no-way-interactions.html#cb394-28" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">=</span> <span class="fu">c</span>()    <span class="co">#p-values for Study 1</span></span>
<span id="cb394-29"><a href="the-no-way-interactions.html#cb394-29" aria-hidden="true" tabindex="-1"></a>      p2 <span class="ot">=</span> <span class="fu">c</span>()    <span class="co">#p-values for Study 2</span></span>
<span id="cb394-30"><a href="the-no-way-interactions.html#cb394-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simtot) {</span>
<span id="cb394-31"><a href="the-no-way-interactions.html#cb394-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">#draw data 4 samples</span></span>
<span id="cb394-32"><a href="the-no-way-interactions.html#cb394-32" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">max</span>(n1, n2), <span class="at">mean =</span> d1)</span>
<span id="cb394-33"><a href="the-no-way-interactions.html#cb394-33" aria-hidden="true" tabindex="-1"></a>    y2 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">max</span>(n1, n2))</span>
<span id="cb394-34"><a href="the-no-way-interactions.html#cb394-34" aria-hidden="true" tabindex="-1"></a>    y3 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">max</span>(n1, n2), <span class="at">mean =</span> d2)</span>
<span id="cb394-35"><a href="the-no-way-interactions.html#cb394-35" aria-hidden="true" tabindex="-1"></a>    y4 <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">max</span>(n1, n2))</span>
<span id="cb394-36"><a href="the-no-way-interactions.html#cb394-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb394-37"><a href="the-no-way-interactions.html#cb394-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#GET DATA READY FOR ANOVA  </span></span>
<span id="cb394-38"><a href="the-no-way-interactions.html#cb394-38" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">c</span>(y1, y2, y3, y4)          <span class="co">#the d.v.</span></span>
<span id="cb394-39"><a href="the-no-way-interactions.html#cb394-39" aria-hidden="true" tabindex="-1"></a>    nrep <span class="ot">=</span> <span class="fu">rep</span>(n2, <span class="dv">4</span>)</span>
<span id="cb394-40"><a href="the-no-way-interactions.html#cb394-40" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">times =</span> nrep)</span>
<span id="cb394-41"><a href="the-no-way-interactions.html#cb394-41" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">times =</span> nrep)</span>
<span id="cb394-42"><a href="the-no-way-interactions.html#cb394-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb394-43"><a href="the-no-way-interactions.html#cb394-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#STUDY 1</span></span>
<span id="cb394-44"><a href="the-no-way-interactions.html#cb394-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Do a t-test on the first n1 observations</span></span>
<span id="cb394-45"><a href="the-no-way-interactions.html#cb394-45" aria-hidden="true" tabindex="-1"></a>      p1.k <span class="ot">=</span> <span class="fu">t.test</span>(y1[<span class="dv">1</span><span class="sc">:</span>n1], y2[<span class="dv">1</span><span class="sc">:</span>n1], <span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value  </span>
<span id="cb394-46"><a href="the-no-way-interactions.html#cb394-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb394-47"><a href="the-no-way-interactions.html#cb394-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">#STUDY 2</span></span>
<span id="cb394-48"><a href="the-no-way-interactions.html#cb394-48" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Do anova, keep p-value of the interaction</span></span>
<span id="cb394-49"><a href="the-no-way-interactions.html#cb394-49" aria-hidden="true" tabindex="-1"></a>      p2.k <span class="ot">=</span> <span class="fu">anova</span>(<span class="fu">lm</span>(y <span class="sc">~</span> A <span class="sc">*</span> B))[<span class="st">&quot;A:B&quot;</span>, <span class="st">&quot;Pr(&gt;F)&quot;</span>]             </span>
<span id="cb394-50"><a href="the-no-way-interactions.html#cb394-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb394-51"><a href="the-no-way-interactions.html#cb394-51" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Store the results</span></span>
<span id="cb394-52"><a href="the-no-way-interactions.html#cb394-52" aria-hidden="true" tabindex="-1"></a>      p1 <span class="ot">=</span> <span class="fu">c</span>(p1, p1.k)</span>
<span id="cb394-53"><a href="the-no-way-interactions.html#cb394-53" aria-hidden="true" tabindex="-1"></a>      p2 <span class="ot">=</span> <span class="fu">c</span>(p2, p2.k)</span>
<span id="cb394-54"><a href="the-no-way-interactions.html#cb394-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb394-55"><a href="the-no-way-interactions.html#cb394-55" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb394-56"><a href="the-no-way-interactions.html#cb394-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb394-57"><a href="the-no-way-interactions.html#cb394-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#What share off comparisons are significant</span></span>
<span id="cb394-58"><a href="the-no-way-interactions.html#cb394-58" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Simple test using estimate of variance from 2 cells only</span></span>
<span id="cb394-59"><a href="the-no-way-interactions.html#cb394-59" aria-hidden="true" tabindex="-1"></a>      power1 <span class="ot">=</span> <span class="fu">sum</span>(p1 <span class="sc">&lt;=</span> .<span class="dv">05</span>) <span class="sc">/</span> simtot  </span>
<span id="cb394-60"><a href="the-no-way-interactions.html#cb394-60" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Interaction</span></span>
<span id="cb394-61"><a href="the-no-way-interactions.html#cb394-61" aria-hidden="true" tabindex="-1"></a>      power2 <span class="ot">=</span> <span class="fu">sum</span>(p2 <span class="sc">&lt;=</span> .<span class="dv">05</span>) <span class="sc">/</span> simtot  </span>
<span id="cb394-62"><a href="the-no-way-interactions.html#cb394-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb394-63"><a href="the-no-way-interactions.html#cb394-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Study 1 is powered to:&quot;</span>,<span class="fu">round</span>(power1,<span class="dv">2</span>))</span>
<span id="cb394-64"><a href="the-no-way-interactions.html#cb394-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Study 2 is powered to:&quot;</span>,<span class="fu">round</span>(power2,<span class="dv">2</span>))</span>
<span id="cb394-65"><a href="the-no-way-interactions.html#cb394-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb394-66"><a href="the-no-way-interactions.html#cb394-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb394-67"><a href="the-no-way-interactions.html#cb394-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb394-68"><a href="the-no-way-interactions.html#cb394-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb394-69"><a href="the-no-way-interactions.html#cb394-69" aria-hidden="true" tabindex="-1"></a><span class="co">#Same power for 2n regardless of n and d</span></span></code></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="the-no-way-interactions.html#cb395-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">2000</span>, <span class="at">n1 =</span> <span class="dv">20</span>, <span class="at">n2 =</span> <span class="dv">40</span>, <span class="at">d1 =</span> <span class="dv">1</span>, <span class="at">d2 =</span> <span class="dv">0</span>)  </span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.88</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.89</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="the-no-way-interactions.html#cb398-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">2000</span>, <span class="at">n1 =</span> <span class="dv">50</span>, <span class="at">n2 =</span> <span class="dv">100</span>, <span class="at">d1 =</span> .<span class="dv">3</span>, <span class="at">d2 =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.3</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.31</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="the-no-way-interactions.html#cb401-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">2000</span>, <span class="at">n1 =</span> <span class="dv">150</span>, <span class="at">n2 =</span> <span class="dv">300</span>, <span class="at">d1 =</span> .<span class="dv">25</span>, <span class="at">d2 =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.57</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.57</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="the-no-way-interactions.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Need 4n if effect is 70% attenuated</span></span>
<span id="cb404-2"><a href="the-no-way-interactions.html#cb404-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">2000</span>, <span class="at">n1 =</span> <span class="dv">25</span>, <span class="at">n2 =</span> <span class="dv">100</span>, <span class="at">d1 =</span> .<span class="dv">5</span>, <span class="at">d2 =</span> .<span class="dv">3</span> <span class="sc">*</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.41</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.4</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="the-no-way-interactions.html#cb407-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">2000</span>, <span class="at">n1 =</span> <span class="dv">50</span>, <span class="at">n2 =</span> <span class="dv">200</span>, <span class="at">d1 =</span> .<span class="dv">5</span>, <span class="at">d2 =</span> .<span class="dv">3</span> <span class="sc">*</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.69</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.7</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="the-no-way-interactions.html#cb410-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">2000</span>, <span class="at">n1 =</span> <span class="dv">22</span>, <span class="at">n2 =</span> <span class="dv">88</span>, <span class="at">d1 =</span> .<span class="dv">41</span>, <span class="at">d2 =</span> .<span class="dv">3</span> <span class="sc">*</span> .<span class="dv">41</span>)</span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.26</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.27</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="the-no-way-interactions.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co">#underpowered if run with the same n</span></span>
<span id="cb413-2"><a href="the-no-way-interactions.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colada17</span>(<span class="at">simtot =</span> nsims, <span class="at">n1 =</span> <span class="dv">20</span>, <span class="at">n2 =</span> <span class="dv">20</span>, <span class="at">d1 =</span> <span class="dv">1</span>, <span class="at">d2 =</span> <span class="dv">0</span>)  </span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.87</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.6</code></pre>
<p>And we can reproduce the results using the <code>ANOVA_exact</code> function.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="the-no-way-interactions.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Study 1</span></span>
<span id="cb416-2"><a href="the-no-way-interactions.html#cb416-2" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b&quot;</span></span>
<span id="cb416-3"><a href="the-no-way-interactions.html#cb416-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb416-4"><a href="the-no-way-interactions.html#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="co"># All means are equal - so there is no real difference.</span></span>
<span id="cb416-5"><a href="the-no-way-interactions.html#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb416-6"><a href="the-no-way-interactions.html#cb416-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>) </span>
<span id="cb416-7"><a href="the-no-way-interactions.html#cb416-7" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb416-8"><a href="the-no-way-interactions.html#cb416-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-9"><a href="the-no-way-interactions.html#cb416-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb416-10"><a href="the-no-way-interactions.html#cb416-10" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb416-11"><a href="the-no-way-interactions.html#cb416-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb416-12"><a href="the-no-way-interactions.html#cb416-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb416-13"><a href="the-no-way-interactions.html#cb416-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb416-14"><a href="the-no-way-interactions.html#cb416-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="the-no-way-interactions.html#cb417-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></span>
<span id="cb417-2"><a href="the-no-way-interactions.html#cb417-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-3"><a href="the-no-way-interactions.html#cb417-3" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result, </span>
<span id="cb417-4"><a href="the-no-way-interactions.html#cb417-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb417-5"><a href="the-no-way-interactions.html#cb417-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb417-6"><a href="the-no-way-interactions.html#cb417-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-7"><a href="the-no-way-interactions.html#cb417-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exact_result<span class="sc">$</span>main_results[<span class="dv">2</span>,], </span>
<span id="cb417-8"><a href="the-no-way-interactions.html#cb417-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;ANOVA Results&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb417-9"><a href="the-no-way-interactions.html#cb417-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-221">Table 7.1: </span>ANOVA Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
86.79843
</td>
<td style="text-align:right;">
0.2173913
</td>
<td style="text-align:right;">
0.5270463
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="the-no-way-interactions.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Study 2</span></span>
<span id="cb418-2"><a href="the-no-way-interactions.html#cb418-2" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b&quot;</span></span>
<span id="cb418-3"><a href="the-no-way-interactions.html#cb418-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb418-4"><a href="the-no-way-interactions.html#cb418-4" aria-hidden="true" tabindex="-1"></a><span class="co"># All means are equal - so there is no real difference.</span></span>
<span id="cb418-5"><a href="the-no-way-interactions.html#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb418-6"><a href="the-no-way-interactions.html#cb418-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>) </span>
<span id="cb418-7"><a href="the-no-way-interactions.html#cb418-7" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb418-8"><a href="the-no-way-interactions.html#cb418-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-9"><a href="the-no-way-interactions.html#cb418-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb418-10"><a href="the-no-way-interactions.html#cb418-10" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb418-11"><a href="the-no-way-interactions.html#cb418-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb418-12"><a href="the-no-way-interactions.html#cb418-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb418-13"><a href="the-no-way-interactions.html#cb418-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb418-14"><a href="the-no-way-interactions.html#cb418-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-221-2.png" width="672" /></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="the-no-way-interactions.html#cb419-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></span>
<span id="cb419-2"><a href="the-no-way-interactions.html#cb419-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3"><a href="the-no-way-interactions.html#cb419-3" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result, </span>
<span id="cb419-4"><a href="the-no-way-interactions.html#cb419-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb419-5"><a href="the-no-way-interactions.html#cb419-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb419-6"><a href="the-no-way-interactions.html#cb419-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-7"><a href="the-no-way-interactions.html#cb419-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exact_result<span class="sc">$</span>main_results[<span class="dv">3</span>,], </span>
<span id="cb419-8"><a href="the-no-way-interactions.html#cb419-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;ANOVA Results&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb419-9"><a href="the-no-way-interactions.html#cb419-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-221">Table 7.1: </span>ANOVA Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
a:b
</td>
<td style="text-align:right;">
59.78655
</td>
<td style="text-align:right;">
0.0617284
</td>
<td style="text-align:right;">
0.2564946
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>We see we get the same power for the anova_fruit:hunger interaction and for the simple effect p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry as the simulations by Uri Simonsohn in his blog post.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="the-no-way-interactions.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Same power for 2n regardless of n and d</span></span>
<span id="cb420-2"><a href="the-no-way-interactions.html#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">10000</span>, <span class="at">n1 =</span> <span class="dv">20</span>, <span class="at">n2 =</span> <span class="dv">40</span>, <span class="at">d1 =</span> <span class="dv">1</span>, <span class="at">d2 =</span> <span class="dv">0</span>)  </span>
<span id="cb420-3"><a href="the-no-way-interactions.html#cb420-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-4"><a href="the-no-way-interactions.html#cb420-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">10000</span>, <span class="at">n1 =</span> <span class="dv">20</span>, <span class="at">n2 =</span> <span class="dv">40</span>, <span class="at">d1 =</span> <span class="dv">1</span>, <span class="at">d2 =</span> <span class="dv">0</span>) </span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.86</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.88</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="the-no-way-interactions.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">10000</span>, <span class="at">n1 =</span> <span class="dv">50</span>, <span class="at">n2 =</span> <span class="dv">100</span>, <span class="at">d1 =</span> .<span class="dv">3</span>, <span class="at">d2 =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.31</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.32</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="the-no-way-interactions.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colada17</span>(<span class="at">simtot =</span> <span class="dv">10000</span>, <span class="at">n1 =</span> <span class="dv">150</span>, <span class="at">n2 =</span> <span class="dv">300</span>, <span class="at">d1 =</span> .<span class="dv">25</span>, <span class="at">d2 =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## 
## Study 1 is powered to: 0.58</code></pre>
<pre><code>## 
## Study 2 is powered to: 0.58</code></pre>
<p>We can also reproduce the last example by adjusting the means and standard deviation. With 150 people, and a Cohen’s d of 0.25 (the difference is 5, the sd 20, so 5/20 = 0.25) we should reproduce the power for the simple effect.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="the-no-way-interactions.html#cb429-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b&quot;</span></span>
<span id="cb429-2"><a href="the-no-way-interactions.html#cb429-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb429-3"><a href="the-no-way-interactions.html#cb429-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All means are equal - so there is no real difference.</span></span>
<span id="cb429-4"><a href="the-no-way-interactions.html#cb429-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb429-5"><a href="the-no-way-interactions.html#cb429-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb429-6"><a href="the-no-way-interactions.html#cb429-6" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, </span>
<span id="cb429-7"><a href="the-no-way-interactions.html#cb429-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></span>
<span id="cb429-8"><a href="the-no-way-interactions.html#cb429-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb429-9"><a href="the-no-way-interactions.html#cb429-9" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb429-10"><a href="the-no-way-interactions.html#cb429-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb429-11"><a href="the-no-way-interactions.html#cb429-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb429-12"><a href="the-no-way-interactions.html#cb429-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb429-13"><a href="the-no-way-interactions.html#cb429-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> labelnames)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="the-no-way-interactions.html#cb430-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></span>
<span id="cb430-2"><a href="the-no-way-interactions.html#cb430-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-3"><a href="the-no-way-interactions.html#cb430-3" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result, </span>
<span id="cb430-4"><a href="the-no-way-interactions.html#cb430-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb430-5"><a href="the-no-way-interactions.html#cb430-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb430-6"><a href="the-no-way-interactions.html#cb430-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-7"><a href="the-no-way-interactions.html#cb430-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exact_result<span class="sc">$</span>main_results[<span class="dv">2</span>,], </span>
<span id="cb430-8"><a href="the-no-way-interactions.html#cb430-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;ANOVA Results&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb430-9"><a href="the-no-way-interactions.html#cb430-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-228">Table 7.2: </span>ANOVA Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hunger
</td>
<td style="text-align:right;">
33.32955
</td>
<td style="text-align:right;">
0.0039171
</td>
<td style="text-align:right;">
0.0627094
</td>
<td style="text-align:right;">
2.34375
</td>
</tr>
</tbody>
</table>
<p>And changing the sample size to 300 should reproduce the power for the interaction in the ANOVA.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="the-no-way-interactions.html#cb431-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b&quot;</span></span>
<span id="cb431-2"><a href="the-no-way-interactions.html#cb431-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb431-3"><a href="the-no-way-interactions.html#cb431-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All means are equal - so there is no real difference.</span></span>
<span id="cb431-4"><a href="the-no-way-interactions.html#cb431-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb431-5"><a href="the-no-way-interactions.html#cb431-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb431-6"><a href="the-no-way-interactions.html#cb431-6" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, </span>
<span id="cb431-7"><a href="the-no-way-interactions.html#cb431-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></span>
<span id="cb431-8"><a href="the-no-way-interactions.html#cb431-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb431-9"><a href="the-no-way-interactions.html#cb431-9" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb431-10"><a href="the-no-way-interactions.html#cb431-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb431-11"><a href="the-no-way-interactions.html#cb431-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb431-12"><a href="the-no-way-interactions.html#cb431-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb431-13"><a href="the-no-way-interactions.html#cb431-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> labelnames)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-229-1.png" width="672" /></p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="the-no-way-interactions.html#cb432-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></span>
<span id="cb432-2"><a href="the-no-way-interactions.html#cb432-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-3"><a href="the-no-way-interactions.html#cb432-3" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result, <span class="at">alpha_level =</span> alpha_level)</span></code></pre></div>
<pre><code>## Power and Effect sizes for ANOVA tests
##                power partial_eta_squared cohen_f non_centrality
## fruit        58.0592              0.0039  0.0626         4.6875
## hunger       58.0592              0.0039  0.0626         4.6875
## fruit:hunger 58.0592              0.0039  0.0626         4.6875
## 
## Power and Effect sizes for pairwise comparisons (t-tests)
##                                                                  power
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry     5.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger      5.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry   86.37
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger    5.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry 86.37
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry  86.37
##                                                                  effect_size
## p_fruit_apple_hunger_no hunger_fruit_apple_hunger_very hungry           0.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_no hunger            0.00
## p_fruit_apple_hunger_no hunger_fruit_banana_hunger_very hungry          0.25
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_no hunger          0.00
## p_fruit_apple_hunger_very hungry_fruit_banana_hunger_very hungry        0.25
## p_fruit_banana_hunger_no hunger_fruit_banana_hunger_very hungry         0.25</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="the-no-way-interactions.html#cb434-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exact_result<span class="sc">$</span>main_results[<span class="dv">3</span>,], </span>
<span id="cb434-2"><a href="the-no-way-interactions.html#cb434-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;ANOVA Results&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb434-3"><a href="the-no-way-interactions.html#cb434-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-229">Table 7.3: </span>ANOVA Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fruit:hunger
</td>
<td style="text-align:right;">
58.05922
</td>
<td style="text-align:right;">
0.003904
</td>
<td style="text-align:right;">
0.0626044
</td>
<td style="text-align:right;">
4.6875
</td>
</tr>
</tbody>
</table>
<p>Now if we look at the power analysis table for the last simulation, we see that the power for the ANOVA is the same for the main effect of fruit, the main effect of hunger, and the main effect of the interaction. All the effect sizes are equal as well. We can understand why if we look at the means in a 2x2 table:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="the-no-way-interactions.html#cb435-1" aria-hidden="true" tabindex="-1"></a>mean_mat <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(mu, </span>
<span id="cb435-2"><a href="the-no-way-interactions.html#cb435-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb435-3"><a href="the-no-way-interactions.html#cb435-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">2</span>)) <span class="co">#Create a mean matrix</span></span>
<span id="cb435-4"><a href="the-no-way-interactions.html#cb435-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mean_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>)</span>
<span id="cb435-5"><a href="the-no-way-interactions.html#cb435-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mean_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>)</span>
<span id="cb435-6"><a href="the-no-way-interactions.html#cb435-6" aria-hidden="true" tabindex="-1"></a>mean_mat</span></code></pre></div>
<pre><code>##        no hunger very hungry
## apple         20          20
## banana        20          25</code></pre>
<p>The first main effect tests the marginal means if we sum over rows, 20 (apple) vs 22.5 (banana).</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="the-no-way-interactions.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowMeans</span>(mean_mat)</span></code></pre></div>
<pre><code>##  apple banana 
##   20.0   22.5</code></pre>
<p>The second main effect tests the marginal means over the rows, which is also 20 vs 22.5.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="the-no-way-interactions.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(mean_mat)</span></code></pre></div>
<pre><code>##   no hunger very hungry 
##        20.0        22.5</code></pre>
<p>The interaction tests whether the average effect of hunger on liking fruit differs in the presence of bananas. In the presence of bananas the effect of hunger on the desireability of fruit is 5 scalepoints. The average effect (that we get from the marginal means) of hunger on fruit desireability is 2.5 (22.5-20). In other words, the interaction tests whether the difference effect between hunger and no hunger is different in the presence of an apple versus in the presence of a banana.</p>
<p>Mathematically the interaction effect is computed as the difference between a cell mean and the grand mean, the marginal mean in row i and the grand mean, and the marginal mean in column j and grand mean. For example, for the very hungry-banana condition this is:</p>
<p><span class="math display">\[\underbrace{25}_\text{cell value} - (\underbrace{21.5}_\text{grand mean} + \underbrace{(22.5-21.25)}_\text{row2 mean - grand mean} + \underbrace{(22.5-21.25)}_\text{col2 mean - grand mean}) = 1.25\]</span></p>
<p>We can repeat this for every cell, and get for no hunger-apple: <span class="math inline">\(20 - (21.25 + (20-21.25) + (20-21.25)) = 1.25\)</span>, for very hungry apple: <span class="math inline">\(20 - (21.25 + (22.5-21.25) + (20-21.25)) = 1.25\)</span>, and no hunger-banana: <span class="math inline">\(20 - (21.25 + (20-21.25) + (22.5-21.25)) = 1.25\)</span>.
<br/>
These values are used to calculate the sum of squares.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="the-no-way-interactions.html#cb441-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> mean_mat[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">-</span> (<span class="fu">mean</span>(mean_mat) <span class="sc">+</span> </span>
<span id="cb441-2"><a href="the-no-way-interactions.html#cb441-2" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[<span class="dv">1</span>,]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)) <span class="sc">+</span> </span>
<span id="cb441-3"><a href="the-no-way-interactions.html#cb441-3" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[,<span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)))</span>
<span id="cb441-4"><a href="the-no-way-interactions.html#cb441-4" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> mean_mat[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">-</span> (<span class="fu">mean</span>(mean_mat) <span class="sc">+</span> </span>
<span id="cb441-5"><a href="the-no-way-interactions.html#cb441-5" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[<span class="dv">1</span>,]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)) <span class="sc">+</span> </span>
<span id="cb441-6"><a href="the-no-way-interactions.html#cb441-6" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[,<span class="dv">2</span>]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)))</span>
<span id="cb441-7"><a href="the-no-way-interactions.html#cb441-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> mean_mat[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">-</span> (<span class="fu">mean</span>(mean_mat) <span class="sc">+</span> </span>
<span id="cb441-8"><a href="the-no-way-interactions.html#cb441-8" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[<span class="dv">2</span>,]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)) <span class="sc">+</span> </span>
<span id="cb441-9"><a href="the-no-way-interactions.html#cb441-9" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[,<span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)))</span>
<span id="cb441-10"><a href="the-no-way-interactions.html#cb441-10" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> mean_mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">-</span> (<span class="fu">mean</span>(mean_mat) <span class="sc">+</span> </span>
<span id="cb441-11"><a href="the-no-way-interactions.html#cb441-11" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[<span class="dv">2</span>,]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)) <span class="sc">+</span> </span>
<span id="cb441-12"><a href="the-no-way-interactions.html#cb441-12" aria-hidden="true" tabindex="-1"></a>                         (<span class="fu">mean</span>(mean_mat[,<span class="dv">2</span>]) <span class="sc">-</span> <span class="fu">mean</span>(mean_mat)))</span>
<span id="cb441-13"><a href="the-no-way-interactions.html#cb441-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-14"><a href="the-no-way-interactions.html#cb441-14" aria-hidden="true" tabindex="-1"></a>SS_ab <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">c</span>(a1, a2, b1, b2)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>The sum of squares is dependent on the sample size, as can be seen in the code above. The larger the sample size, the larger the sum of squares, and therefore (all else equal) the larger the <em>F</em>-statistic, and the smaller the <em>p</em>-value. We see from the simulations that all three tests have the same effect size, and therefore the same power.</p>
<p>Interactions can have more power than main effects if the effect size of the interaction is larger than the effect size of the main effects. An example of this is a cross-over interaction. For example, let’s take a 2x2 matrix of means with a crossover interaction:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="the-no-way-interactions.html#cb442-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>)</span>
<span id="cb442-2"><a href="the-no-way-interactions.html#cb442-2" aria-hidden="true" tabindex="-1"></a>mean_mat <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(mu, </span>
<span id="cb442-3"><a href="the-no-way-interactions.html#cb442-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb442-4"><a href="the-no-way-interactions.html#cb442-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="dv">2</span>)) <span class="co">#Create a mean matrix</span></span>
<span id="cb442-5"><a href="the-no-way-interactions.html#cb442-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mean_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>)</span>
<span id="cb442-6"><a href="the-no-way-interactions.html#cb442-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mean_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>)</span>
<span id="cb442-7"><a href="the-no-way-interactions.html#cb442-7" aria-hidden="true" tabindex="-1"></a>mean_mat</span></code></pre></div>
<pre><code>##        no hunger very hungry
## apple         25          20
## banana        20          25</code></pre>
<p>Neither of the main effects is now significant, as the marginal means are 22.5 vs 22.5 for both main effects. The interaction is much stronger, however. We are testing whether the average effect of hunger on the desireability of fruit is different in the presence of bananas. Since the average effect is 0, and the effect of hunger on the desireability of bananas is 5, so the effect size is now twice as large.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="the-no-way-interactions.html#cb444-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b&quot;</span></span>
<span id="cb444-2"><a href="the-no-way-interactions.html#cb444-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb444-3"><a href="the-no-way-interactions.html#cb444-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">25</span>) <span class="co">#All marginal means are equal - so there is no real difference.</span></span>
<span id="cb444-4"><a href="the-no-way-interactions.html#cb444-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb444-5"><a href="the-no-way-interactions.html#cb444-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb444-6"><a href="the-no-way-interactions.html#cb444-6" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fruit&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, </span>
<span id="cb444-7"><a href="the-no-way-interactions.html#cb444-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hunger&quot;</span>, <span class="st">&quot;no hunger&quot;</span>, <span class="st">&quot;very hungry&quot;</span>) <span class="co">#</span></span>
<span id="cb444-8"><a href="the-no-way-interactions.html#cb444-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb444-9"><a href="the-no-way-interactions.html#cb444-9" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb444-10"><a href="the-no-way-interactions.html#cb444-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb444-11"><a href="the-no-way-interactions.html#cb444-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb444-12"><a href="the-no-way-interactions.html#cb444-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb444-13"><a href="the-no-way-interactions.html#cb444-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> labelnames)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="the-no-way-interactions.html#cb445-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co">#We set the alpha level at 0.05. </span></span>
<span id="cb445-2"><a href="the-no-way-interactions.html#cb445-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-3"><a href="the-no-way-interactions.html#cb445-3" aria-hidden="true" tabindex="-1"></a>exact_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_exact</span>(design_result, </span>
<span id="cb445-4"><a href="the-no-way-interactions.html#cb445-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb445-5"><a href="the-no-way-interactions.html#cb445-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb445-6"><a href="the-no-way-interactions.html#cb445-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-7"><a href="the-no-way-interactions.html#cb445-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(exact_result<span class="sc">$</span>main_results, </span>
<span id="cb445-8"><a href="the-no-way-interactions.html#cb445-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;ANOVA Results&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb445-9"><a href="the-no-way-interactions.html#cb445-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;hold_position&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-235">Table 7.4: </span>ANOVA Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fruit
</td>
<td style="text-align:right;">
5.00000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
hunger
</td>
<td style="text-align:right;">
5.00000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
fruit:hunger
</td>
<td style="text-align:right;">
99.10259
</td>
<td style="text-align:right;">
0.0154353
</td>
<td style="text-align:right;">
0.1252089
</td>
<td style="text-align:right;">
18.75
</td>
</tr>
</tbody>
</table>
<p>We can also reproduce the power analysis using the analytic functions in <code>Superpower</code>:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="the-no-way-interactions.html#cb446-1" aria-hidden="true" tabindex="-1"></a>power_analytic <span class="ot">&lt;-</span> <span class="fu">power_twoway_between</span>(design_result)</span>
<span id="cb446-2"><a href="the-no-way-interactions.html#cb446-2" aria-hidden="true" tabindex="-1"></a>power_analytic<span class="sc">$</span>power_A</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="the-no-way-interactions.html#cb448-1" aria-hidden="true" tabindex="-1"></a>power_analytic<span class="sc">$</span>power_B</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="the-no-way-interactions.html#cb450-1" aria-hidden="true" tabindex="-1"></a>power_analytic<span class="sc">$</span>power_AB</span></code></pre></div>
<pre><code>## [1] 99.10259</code></pre>

</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-simonsohn_2014" class="csl-entry">
Simonsohn, Uri. 2014. <span>“No-Way Interactions.”</span> <em>Data Colada</em>. <a href="http://datacolada.org/17">http://datacolada.org/17</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="power-for-three-way-interactions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="effect-of-varying-designs-on-power.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
