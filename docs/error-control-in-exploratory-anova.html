<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Error Control in Exploratory ANOVA | Power Analysis with Superpower</title>
  <meta name="description" content="This is a book describing the capabilities of the Superpower R package." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Error Control in Exploratory ANOVA | Power Analysis with Superpower" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book describing the capabilities of the Superpower R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Error Control in Exploratory ANOVA | Power Analysis with Superpower" />
  
  <meta name="twitter:description" content="This is a book describing the capabilities of the Superpower R package." />
  

<meta name="author" content="Aaron R. Caldwell" />
<meta name="author" content="Daniël Lakens" />
<meta name="author" content="Chelsea M. Parlett-Pelleriti" />
<meta name="author" content="Guy Prochilo" />
<meta name="author" content="Frederik Aust" />


<meta name="date" content="2022-03-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="effect-of-varying-designs-on-power.html"/>
<link rel="next" href="analytic-power-functions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#preface">Preface<span></span></a>
<ul>
<li><a href="index.html#contributors">Contributors<span></span></a></li>
<li><a href="index.html#contributions">Contributions<span></span></a></li>
<li><a href="index.html#funding">Funding<span></span></a></li>
<li><a href="index.html#settings">Settings<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html"><i class="fa fa-check"></i><b>1</b> Introduction to Power Analysis<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#overview-of-power-analysis"><i class="fa fa-check"></i><b>1.1</b> Overview of Power Analysis<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#error-and-power"><i class="fa fa-check"></i><b>1.2</b> Error and Power<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#effect-size"><i class="fa fa-check"></i><b>1.3</b> Effect size<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#samp_vs_pop"><i class="fa fa-check"></i><b>1.4</b> Sample effect size vs. population effect size<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#safeguard-effect-size"><i class="fa fa-check"></i><b>1.5</b> Safeguard Effect Size<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-analysis"><i class="fa fa-check"></i><b>1.6</b> <em>Post hoc</em> power analysis<span></span></a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-sample-effect-size-is-not-the-population-effect-size"><i class="fa fa-check"></i><b>1.6.1</b> The sample effect size is <em>not</em> the population effect size<span></span></a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#post-hoc-power-is-merely-a-transformation-of-your-obtained-p-value"><i class="fa fa-check"></i><b>1.6.2</b> <em>Post hoc</em> power is merely a transformation of your obtained <em>p</em> value<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-power-analysis.html"><a href="introduction-to-power-analysis.html#the-minimal-detectable-effect-size"><i class="fa fa-check"></i><b>1.7</b> The Minimal Detectable Effect Size<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-experimental-design.html"><a href="the-experimental-design.html"><i class="fa fa-check"></i><b>2</b> The Experimental Design<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#anova_design-function"><i class="fa fa-check"></i><b>2.1</b> ANOVA_design function<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-design-using-design"><i class="fa fa-check"></i><b>2.1.1</b> Specifying the design using <code>design</code><span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-means-using-mu"><i class="fa fa-check"></i><b>2.1.2</b> Specifying the means using <code>mu</code><span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-label-names"><i class="fa fa-check"></i><b>2.1.3</b> Specifying label names<span></span></a></li>
<li class="chapter" data-level="2.1.4" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-correlation"><i class="fa fa-check"></i><b>2.1.4</b> Specifying the correlation<span></span></a></li>
<li class="chapter" data-level="2.1.5" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-sample-size"><i class="fa fa-check"></i><b>2.1.5</b> Specifying the sample size<span></span></a></li>
<li class="chapter" data-level="2.1.6" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-standard-deviation"><i class="fa fa-check"></i><b>2.1.6</b> Specifying the standard deviation<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>3</b> One-Way ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>3.1.2</b> Three conditions<span></span></a></li>
<li class="chapter" data-level="3.1.3" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>3.1.3</b> Power for simple effects<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="one-way-anova.html"><a href="one-way-anova.html#effect-size-estimates-for-one-way-anova"><i class="fa fa-check"></i><b>3.2</b> Effect Size Estimates for One-Way ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>3.2.1</b> Three conditions, small effect size<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Four conditions, medium effect size<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>3.2.3</b> Two conditions, large effect size<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>4</b> Repeated Measures ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>4.1</b> Part 1<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.1.1</b> Two conditions, medium effect size<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-2"><i class="fa fa-check"></i><b>4.2</b> Part 2<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>4.2.1</b> The relation between Cohen’s f and Cohen’s d<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>4.2.2</b> Three within conditions, medium effect size<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-3"><i class="fa fa-check"></i><b>4.3</b> Part 3<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-4"><i class="fa fa-check"></i><b>4.4</b> Part 4<span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-within-design"><i class="fa fa-check"></i><b>4.4.1</b> 2x2 ANOVA, within-within design<span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>4.4.2</b> Examine variation of means and correlation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-5"><i class="fa fa-check"></i><b>4.5</b> Part 5<span></span></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-design"><i class="fa fa-check"></i><b>4.5.1</b> 2x2 ANOVA, within design<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#multivariate-anova-manova"><i class="fa fa-check"></i><b>4.6</b> Multivariate ANOVA (MANOVA)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>5</b> Mixed ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-mixed-designs"><i class="fa fa-check"></i><b>5.1</b> Simple Mixed Designs<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="mixed-anova.html"><a href="mixed-anova.html#complex-mixed-designs"><i class="fa fa-check"></i><b>5.2</b> Complex Mixed Designs<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#b3w-design"><i class="fa fa-check"></i><b>5.2.1</b> 2b*3w Design<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="mixed-anova.html"><a href="mixed-anova.html#b4w-design"><i class="fa fa-check"></i><b>5.2.2</b> 2b*4w Design<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="power-for-three-way-interactions.html"><a href="power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>6</b> Power for Three-way Interactions<span></span></a></li>
<li class="chapter" data-level="7" data-path="the-no-way-interactions.html"><a href="the-no-way-interactions.html"><i class="fa fa-check"></i><b>7</b> The ‘No-Way’ Interactions<span></span></a></li>
<li class="chapter" data-level="8" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html"><i class="fa fa-check"></i><b>8</b> Effect of Varying Designs on Power<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html#within-designs"><i class="fa fa-check"></i><b>8.1</b> Within Designs<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>9</b> Error Control in Exploratory ANOVA<span></span></a></li>
<li class="chapter" data-level="10" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>10</b> Analytic Power Functions<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subjects-anova"><i class="fa fa-check"></i><b>10.1</b> One-Way Between Subjects ANOVA<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>10.2</b> Two-way Between Subject Interaction<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>10.3</b> 3x3 Between Subject ANOVA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>11</b> Power Curve<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-moderated-interactions."><i class="fa fa-check"></i><b>11.1</b> Explore increase in effect size for moderated interactions.<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>11.2</b> Explore increase in effect size for cross-over interactions.<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>11.3</b> Explore increase in correlation in moderated interactions.<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="power-curve.html"><a href="power-curve.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>11.4</b> Increasing correlation in on factor decreases power in second factor<span></span></a></li>
<li class="chapter" data-level="11.5" data-path="power-curve.html"><a href="power-curve.html#code-to-reproduce-power-curve-figures"><i class="fa fa-check"></i><b>11.5</b> Code to Reproduce Power Curve Figures<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html"><i class="fa fa-check"></i><b>12</b> Violations of Assumptions<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-heterogeneity-assumption"><i class="fa fa-check"></i><b>12.1</b> Violation of Heterogeneity Assumption<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-the-sphericity-assumption"><i class="fa fa-check"></i><b>12.2</b> Violation of the sphericity assumption<span></span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#manova-or-sphericity-adjustment"><i class="fa fa-check"></i><b>12.2.1</b> MANOVA or Sphericity Adjustment?<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html"><i class="fa fa-check"></i><b>13</b> Estimated Marginal Means<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#a-note-of-caution"><i class="fa fa-check"></i><b>13.1</b> A note of caution<span></span></a></li>
<li class="chapter" data-level="13.2" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#pairwise-comparisons"><i class="fa fa-check"></i><b>13.2</b> Pairwise Comparisons<span></span></a></li>
<li class="chapter" data-level="13.3" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#customized-emmeans-contrasts"><i class="fa fa-check"></i><b>13.3</b> Customized <code>emmeans</code> contrasts<span></span></a></li>
<li class="chapter" data-level="13.4" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#equivalence-and-non-superiority-inferiority-tests"><i class="fa fa-check"></i><b>13.4</b> Equivalence and non-superiority/-inferiority tests<span></span></a></li>
<li class="chapter" data-level="13.5" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#joint-tests"><i class="fa fa-check"></i><b>13.5</b> Joint tests<span></span></a></li>
<li class="chapter" data-level="13.6" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#monte-carlo-simulations"><i class="fa fa-check"></i><b>13.6</b> Monte Carlo Simulations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html"><i class="fa fa-check"></i><b>14</b> Beyond Superpower I: Mixed Models with <code>simr</code><span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html#how-does-simr-work"><i class="fa fa-check"></i><b>14.1</b> How does <code>simr</code> work?<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="beyond-superpower-i-mixed-models-with-simr.html"><a href="beyond-superpower-i-mixed-models-with-simr.html#to-be-continued"><i class="fa fa-check"></i><b>14.2</b> To Be Continued…<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html"><i class="fa fa-check"></i><b>15</b> Beyond Superpower II: Custom Simulations<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#a-clincal-trial-with-a-binary-outcome"><i class="fa fa-check"></i><b>15.1</b> A Clincal Trial with a Binary Outcome<span></span></a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#proposed-study-and-approach"><i class="fa fa-check"></i><b>15.1.1</b> Proposed Study and Approach<span></span></a></li>
<li class="chapter" data-level="15.1.2" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#step-1-create-a-data-generating-function"><i class="fa fa-check"></i><b>15.1.2</b> Step 1: Create a Data Generating Function<span></span></a></li>
<li class="chapter" data-level="15.1.3" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#step-2-simulation"><i class="fa fa-check"></i><b>15.1.3</b> Step 2: Simulation<span></span></a></li>
<li class="chapter" data-level="15.1.4" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#why-more-complicated-code"><i class="fa fa-check"></i><b>15.1.4</b> Why more complicated code?<span></span></a></li>
<li class="chapter" data-level="15.1.5" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#conclusions-on-the-binary-rct-analysis"><i class="fa fa-check"></i><b>15.1.5</b> Conclusions on the Binary RCT Analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#binary-rct-with-a-interim-analysis"><i class="fa fa-check"></i><b>15.2</b> Binary RCT with a Interim Analysis<span></span></a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#proposed-study-and-approach-1"><i class="fa fa-check"></i><b>15.2.1</b> Proposed Study and Approach<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="beyond-superpower-ii-custom-simulations.html"><a href="beyond-superpower-ii-custom-simulations.html#conclusion-on-a-binary-rct-with-interim-analyses"><i class="fa fa-check"></i><b>15.3</b> Conclusion on a Binary RCT with Interim Analyses<span></span></a></li>
</ul></li>
<li><a href="appendix-1-direct-comparison-to-pwr2ppl.html#appendix-1-direct-comparison-to-pwr2ppl">Appendix 1: Direct Comparison to pwr2ppl<span></span></a>
<ul>
<li class="chapter" data-level="15.4" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html"><i class="fa fa-check"></i><b>15.4</b> Examples from Chapter 5<span></span></a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.15.2"><i class="fa fa-check"></i><b>15.4.1</b> Example 5.1/5.2<span></span></a></li>
<li class="chapter" data-level="15.4.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.3"><i class="fa fa-check"></i><b>15.4.2</b> Example 5.3<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-6"><i class="fa fa-check"></i><b>15.5</b> Examples from Chapter 6<span></span></a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.2"><i class="fa fa-check"></i><b>15.5.1</b> Example from Table 6.2<span></span></a></li>
<li class="chapter" data-level="15.5.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.6"><i class="fa fa-check"></i><b>15.5.2</b> Example from Table 6.6<span></span></a></li>
<li class="chapter" data-level="15.5.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.8"><i class="fa fa-check"></i><b>15.5.3</b> Example from Table 6.8<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-chapter-7"><i class="fa fa-check"></i><b>15.6</b> Example from Chapter 7<span></span></a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#from-table-7.2"><i class="fa fa-check"></i><b>15.6.1</b> From Table 7.2<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="appendix-2-direct-comparison-to-morepower.html#appendix-2-direct-comparison-to-morepower">Appendix 2: Direct Comparison to MOREpower<span></span></a></li>
<li><a href="appendix-3-comparison-to-brysbaert.html#appendix-3-comparison-to-brysbaert">Appendix 3: Comparison to Brysbaert<span></span></a>
<ul>
<li class="chapter" data-level="15.7" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html"><i class="fa fa-check"></i><b>15.7</b> One-Way ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication"><i class="fa fa-check"></i><b>15.7.1</b> Three conditions replication<span></span></a></li>
<li class="chapter" data-level="15.7.2" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-1"><i class="fa fa-check"></i><b>15.7.2</b> Variation 1<span></span></a></li>
<li class="chapter" data-level="15.7.3" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>15.7.3</b> Three conditions replication<span></span></a></li>
<li class="chapter" data-level="15.7.4" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-2"><i class="fa fa-check"></i><b>15.7.4</b> Variation 2<span></span></a></li>
<li class="chapter" data-level="15.7.5" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>15.7.5</b> Three conditions replication<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#repeated-measures"><i class="fa fa-check"></i><b>15.8</b> Repeated Measures<span></span></a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>15.8.1</b> Reproducing Brysbaert Variation 1: Changing Correlation<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Power Analysis with Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="error-control-in-exploratory-anova" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Error Control in Exploratory ANOVA<a href="error-control-in-exploratory-anova.html#error-control-in-exploratory-anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In a 2 x 2 x 2 design, an ANOVA will give the test results for three main effects, three two-way interactions, and one three-way interaction. That’s 7 statistical tests. The probability of making at least one type I error in a single 2 x 2 x 2 ANOVA is <span class="math inline">\(1-(0.95)^7 = 30\)</span>%.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="error-control-in-exploratory-anova.html#cb598-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b*2b&quot;</span></span>
<span id="cb598-2"><a href="error-control-in-exploratory-anova.html#cb598-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb598-3"><a href="error-control-in-exploratory-anova.html#cb598-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>) </span>
<span id="cb598-4"><a href="error-control-in-exploratory-anova.html#cb598-4" aria-hidden="true" tabindex="-1"></a><span class="co"># All means are equal - so there is no real difference.</span></span>
<span id="cb598-5"><a href="error-control-in-exploratory-anova.html#cb598-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb598-6"><a href="error-control-in-exploratory-anova.html#cb598-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb598-7"><a href="error-control-in-exploratory-anova.html#cb598-7" aria-hidden="true" tabindex="-1"></a>p_adjust <span class="ot">=</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb598-8"><a href="error-control-in-exploratory-anova.html#cb598-8" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;none&quot; means we do not correct for multiple comparisons</span></span>
<span id="cb598-9"><a href="error-control-in-exploratory-anova.html#cb598-9" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;condition1&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, </span>
<span id="cb598-10"><a href="error-control-in-exploratory-anova.html#cb598-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;condition2&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, </span>
<span id="cb598-11"><a href="error-control-in-exploratory-anova.html#cb598-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;condition3&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>) <span class="co">#</span></span>
<span id="cb598-12"><a href="error-control-in-exploratory-anova.html#cb598-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The label names should be in the order of the means specified above.</span></span>
<span id="cb598-13"><a href="error-control-in-exploratory-anova.html#cb598-13" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb598-14"><a href="error-control-in-exploratory-anova.html#cb598-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb598-15"><a href="error-control-in-exploratory-anova.html#cb598-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb598-16"><a href="error-control-in-exploratory-anova.html#cb598-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb598-17"><a href="error-control-in-exploratory-anova.html#cb598-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> labelnames)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/error_control-1.png" width="672" /></p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="error-control-in-exploratory-anova.html#cb599-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb599-2"><a href="error-control-in-exploratory-anova.html#cb599-2" aria-hidden="true" tabindex="-1"></a><span class="co">#We set the alpha level at 0.05. </span></span></code></pre></div>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="error-control-in-exploratory-anova.html#cb600-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result,</span>
<span id="cb600-2"><a href="error-control-in-exploratory-anova.html#cb600-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb600-3"><a href="error-control-in-exploratory-anova.html#cb600-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-260">Table 9.1: </span>Simulated ANOVA Result
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_condition1
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
0.0024976
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition2
</td>
<td style="text-align:right;">
3.7
</td>
<td style="text-align:right;">
0.0023969
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition3
</td>
<td style="text-align:right;">
5.5
</td>
<td style="text-align:right;">
0.0026112
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition1:condition2
</td>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
0.0025654
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition1:condition3
</td>
<td style="text-align:right;">
5.3
</td>
<td style="text-align:right;">
0.0026206
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition2:condition3
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
0.0024337
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition1:condition2:condition3
</td>
<td style="text-align:right;">
5.5
</td>
<td style="text-align:right;">
0.0026119
</td>
</tr>
</tbody>
</table>
<p>When there is no true effect, we formally do not have ‘power’ (which is defined as the probability of finding p &lt; <span class="math inline">\(\alpha\)</span> if there is a true effect to be found) so the power column should be read as the ‘type I error rate.’ Because we have saved the power simulation in the ‘simulation_result’ object, we can perform calculations on the ‘sim_data’ dataframe that is stored. This dataframe contains the results for the nsims simulations (e.g., 10000 rows if you ran 10000 simulations) and stores the p-values and effect size estimates for each ANOVA. The first 7 columns are the p-values for the ANOVA, first the main effects of condition 1, 2, and 3, then three two-way interactions, and finally the threeway interaction.</p>
<p>We can calculate the number of significant results for each test (which should be 5%) by counting the number of significant p-values in each of the 7 rows:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="error-control-in-exploratory-anova.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">as.matrix</span>(simulation_result_8<span class="fl">.1</span><span class="sc">$</span>sim_data[(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]), <span class="dv">2</span>, </span>
<span id="cb601-2"><a href="error-control-in-exploratory-anova.html#cb601-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">ifelse</span>(x <span class="sc">&lt;</span> alpha_level, <span class="dv">1</span>, <span class="dv">0</span>)),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>##                       anova_condition1                       anova_condition2 
##                                  0.046                                  0.037 
##                       anova_condition3            anova_condition1:condition2 
##                                  0.055                                  0.044 
##            anova_condition1:condition3            anova_condition2:condition3 
##                                  0.053                                  0.046 
## anova_condition1:condition2:condition3 
##                                  0.055</code></pre>
<p>This is the type I error rate for each test. The familywise error rate referrs to the probability of one or more of the tests in the ANOVA being significant, even though none of the 7 effects exist (3 main effects, 3 two-way interactions, and 1 three-way interaction).</p>
<p>To calculate this error rate we do not just add the 7 error rates (so 7 * 5% - 35%). Instead, we calculate the probability that there will be at least one significant result in an ANOVA we perform. Some ANOVA results will have multiple significant results, just due to the type I error rate (e.g., a significant result for the three-way interaction, and for the main effect of condition 1) but such an ANOVA is counted only once. If we calculate this percentage from our simulations, we see the number is indeed very close to <span class="math inline">\(1-(0.95)^7 = 30%\)</span>.</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="error-control-in-exploratory-anova.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">apply</span>(<span class="fu">as.matrix</span>(simulation_result_8<span class="fl">.1</span><span class="sc">$</span>sim_data[(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]), <span class="dv">1</span>, </span>
<span id="cb603-2"><a href="error-control-in-exploratory-anova.html#cb603-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) </span>
<span id="cb603-3"><a href="error-control-in-exploratory-anova.html#cb603-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">ifelse</span>(x <span class="sc">&lt;</span> alpha_level, <span class="dv">1</span>, <span class="dv">0</span>)),<span class="dv">4</span>)) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">/</span> nsims</span></code></pre></div>
<pre><code>## [1] 0.0275</code></pre>
<p>But what we should do about this alpha inflation? We do not want to perform exploratory ANOVAs and observe more type I errors than expected, because these significant effects will often not replicate if you try to build on them. Therefore, you need to control the type I error rate.</p>
<p>In the simulation code, which relies on the afex package, there is the option to set p_adjust. In the simulation above, <code>p_adjust</code> was set to <code>"none"</code>. This means no adjustment is made to alpha level for each test (above this was 0.05).</p>
<p>Afex relies on the <code>p.adjust</code> functon in the <code>stats</code> package in base R (more information is available <a href="https://www.rdocumentation.org/packages/stats/versions/3.1.1/topics/p.adjust">here</a>). From the package details:</p>
<blockquote>
<p>The adjustment methods include the Bonferroni correction (“bonferroni”) in which the p-values are multiplied by the number of comparisons. Less conservative corrections are also included by Holm (1979) (“holm”), Hochberg (1988) (“hochberg”), Hommel (1988) (“hommel”), Benjamini &amp; Hochberg (1995) (“BH” or its alias “fdr”), and Benjamini &amp; Yekutieli (2001) (“BY”), respectively. A pass-through option (“none”) is also included. The first four methods are designed to give strong control of the family-wise error rate. There seems no reason to use the unmodified Bonferroni correction because it is dominated by Holm’s method, which is also valid under arbitrary assumptions.</p>
</blockquote>
<blockquote>
<p>Hochberg’s and Hommel’s methods are valid when the hypothesis tests are independent or when they are non-negatively associated (Sarkar, 1998; Sarkar and Chang, 1997). Hommel’s method is more powerful than Hochberg’s, but the difference is usually small and the Hochberg p-values are faster to compute.</p>
</blockquote>
<blockquote>
<p>The “BH” (aka “fdr”) and “BY” method of Benjamini, Hochberg, and Yekutieli control the false discovery rate, the expected proportion of false discoveries amongst the rejected hypotheses. The false discovery rate is a less stringent condition than the family-wise error rate, so these methods are more powerful than the others.</p>
</blockquote>
<p>Let’s re-run the simulation with the Holm-Bonferroni correction, which is simple and require no assumptions.</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="error-control-in-exploratory-anova.html#cb605-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="st">&quot;2b*2b*2b&quot;</span></span>
<span id="cb605-2"><a href="error-control-in-exploratory-anova.html#cb605-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb605-3"><a href="error-control-in-exploratory-anova.html#cb605-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">20</span>) </span>
<span id="cb605-4"><a href="error-control-in-exploratory-anova.html#cb605-4" aria-hidden="true" tabindex="-1"></a><span class="co">#All means are equal - so there is no real difference.</span></span>
<span id="cb605-5"><a href="error-control-in-exploratory-anova.html#cb605-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter means in the order that matches the labels below.</span></span>
<span id="cb605-6"><a href="error-control-in-exploratory-anova.html#cb605-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb605-7"><a href="error-control-in-exploratory-anova.html#cb605-7" aria-hidden="true" tabindex="-1"></a>p_adjust <span class="ot">=</span> <span class="st">&quot;holm&quot;</span></span>
<span id="cb605-8"><a href="error-control-in-exploratory-anova.html#cb605-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Changed to Holm-Bonferroni</span></span>
<span id="cb605-9"><a href="error-control-in-exploratory-anova.html#cb605-9" aria-hidden="true" tabindex="-1"></a>labelnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;condition1&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, </span>
<span id="cb605-10"><a href="error-control-in-exploratory-anova.html#cb605-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;condition2&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, </span>
<span id="cb605-11"><a href="error-control-in-exploratory-anova.html#cb605-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;condition3&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>) <span class="co">#</span></span>
<span id="cb605-12"><a href="error-control-in-exploratory-anova.html#cb605-12" aria-hidden="true" tabindex="-1"></a><span class="co"># the label names should be in the order of the means specified above.</span></span>
<span id="cb605-13"><a href="error-control-in-exploratory-anova.html#cb605-13" aria-hidden="true" tabindex="-1"></a>design_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_design</span>(<span class="at">design =</span> string,</span>
<span id="cb605-14"><a href="error-control-in-exploratory-anova.html#cb605-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n =</span> n, </span>
<span id="cb605-15"><a href="error-control-in-exploratory-anova.html#cb605-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu =</span> mu, </span>
<span id="cb605-16"><a href="error-control-in-exploratory-anova.html#cb605-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sd =</span> sd, </span>
<span id="cb605-17"><a href="error-control-in-exploratory-anova.html#cb605-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labelnames =</span> labelnames)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="error-control-in-exploratory-anova.html#cb606-1" aria-hidden="true" tabindex="-1"></a>alpha_level <span class="ot">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="error-control-in-exploratory-anova.html#cb607-1" aria-hidden="true" tabindex="-1"></a>simulation_result <span class="ot">&lt;-</span> <span class="fu">ANOVA_power</span>(design_result, </span>
<span id="cb607-2"><a href="error-control-in-exploratory-anova.html#cb607-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">alpha_level =</span> alpha_level,</span>
<span id="cb607-3"><a href="error-control-in-exploratory-anova.html#cb607-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">p_adjust =</span> p_adjust,</span>
<span id="cb607-4"><a href="error-control-in-exploratory-anova.html#cb607-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-265">Table 9.2: </span>ANOVA Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anova_condition1
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.0027223
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition2
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
0.0027230
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition3
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.0024579
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition1:condition2
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0.0026822
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition1:condition3
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.0027651
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition2:condition3
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
0.0023383
</td>
</tr>
<tr>
<td style="text-align:left;">
anova_condition1:condition2:condition3
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.0024676
</td>
</tr>
</tbody>
</table>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-266">Table 9.3: </span>Pairwise Results
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
effect_size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_c_condition3_f
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0032320
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0058348
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_e_condition1_a_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
-0.0023320
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_e
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.0004534
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.0076772
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0059961
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
-0.0030720
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.0027693
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_f_condition1_a_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0064465
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_e
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0018622
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_c_condition3_f
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0109505
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0090944
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0056982
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_e_condition1_a_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
-0.0087148
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_e
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
-0.0054679
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_c_condition3_f
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0142423
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.0117915
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
-0.0086903
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_e
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0040219
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_c_condition3_f
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.0057633
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.0038066
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_a_condition2_d_condition3_f_condition1_b_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.0002288
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_c_condition3_f
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
-0.0089253
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
-0.0073455
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_b_condition2_c_condition3_e_condition1_b_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
-0.0041422
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_e
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0022022
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_b_condition2_c_condition3_f_condition1_b_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0053279
</td>
</tr>
<tr>
<td style="text-align:left;">
p_condition1_b_condition2_d_condition3_e_condition1_b_condition2_d_condition3_f
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.0029956
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="error-control-in-exploratory-anova.html#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">apply</span>(<span class="fu">as.matrix</span>(simulation_result_8<span class="fl">.2</span><span class="sc">$</span>sim_data[(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)]), <span class="dv">1</span>, </span>
<span id="cb608-2"><a href="error-control-in-exploratory-anova.html#cb608-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) </span>
<span id="cb608-3"><a href="error-control-in-exploratory-anova.html#cb608-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">ifelse</span>(x <span class="sc">&lt;</span> alpha_level, <span class="dv">1</span>, <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">4</span>)) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">/</span> nsims</span></code></pre></div>
<pre><code>## [1] 0.0061</code></pre>
<p>We see it is close to 5%.
Note that error rates have variation, and even in a ten thousand simulations, the error rate in the sample of studies can easily be half a percentage point higher or lower (see <a href="https://daniellakens.blogspot.com/2020/01/observed-alpha-levels-why-statistical.html">this blog</a>.
But <em>in the long run</em> the error rate should equal the alpha level. Furthermore, note that the <a href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Holm-Bonferroni</a> method is slightly more powerful than the Bonferroni procedure (which is simply <span class="math inline">\(\alpha\)</span> divided by the number of tests).
There are more powerful procedures to control the type I error rate, which require making more assumptions.
For a small number of tests, they Holm-Bonferroni procedure works well.
Alternative procedures to control error rates can be found in the <a href="https://cran.r-project.org/web/packages/multcomp/index.html">multcomp</a> R package <span class="citation">(<a href="#ref-R-multcomp" role="doc-biblioref">Hothorn, Bretz, and Westfall 2020</a>)</span>.</p>

</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-multcomp" class="csl-entry">
Hothorn, Torsten, Frank Bretz, and Peter Westfall. 2020. <em>Multcomp: Simultaneous Inference in General Parametric Models</em>. <a href="https://CRAN.R-project.org/package=multcomp">https://CRAN.R-project.org/package=multcomp</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="effect-of-varying-designs-on-power.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analytic-power-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
