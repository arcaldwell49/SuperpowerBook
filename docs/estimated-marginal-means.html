<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Estimated Marginal Means | Power Analysis with Superpower</title>
  <meta name="description" content="This is a book describing the capabilities of the Superpower R package." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Estimated Marginal Means | Power Analysis with Superpower" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the capabilities of the Superpower R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Estimated Marginal Means | Power Analysis with Superpower" />
  
  <meta name="twitter:description" content="This is a book describing the capabilities of the Superpower R package." />
  

<meta name="author" content="Aaron R. Caldwell, Daniël Lakens, and Chelsea M. Parlett-Pelleriti" />


<meta name="date" content="2021-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="violations-of-assumptions.html"/>
<link rel="next" href="appendix-1-direct-comparison-to-pwr2ppl.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Superpower</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i>Funding</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-experimental-design.html"><a href="the-experimental-design.html"><i class="fa fa-check"></i><b>1</b> The Experimental Design</a><ul>
<li class="chapter" data-level="1.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#anova_design-function"><i class="fa fa-check"></i><b>1.1</b> ANOVA_design function</a><ul>
<li class="chapter" data-level="1.1.1" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-design-using-design"><i class="fa fa-check"></i><b>1.1.1</b> Specifying the design using <code>design</code></a></li>
<li class="chapter" data-level="1.1.2" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-means-using-mu"><i class="fa fa-check"></i><b>1.1.2</b> Specifying the means using <code>mu</code></a></li>
<li class="chapter" data-level="1.1.3" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-label-names"><i class="fa fa-check"></i><b>1.1.3</b> Specifying label names</a></li>
<li class="chapter" data-level="1.1.4" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-correlation"><i class="fa fa-check"></i><b>1.1.4</b> Specifying the correlation</a></li>
<li class="chapter" data-level="1.1.5" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-sample-size"><i class="fa fa-check"></i><b>1.1.5</b> Specifying the sample size</a></li>
<li class="chapter" data-level="1.1.6" data-path="the-experimental-design.html"><a href="the-experimental-design.html#specifying-the-standard-deviation"><i class="fa fa-check"></i><b>1.1.6</b> Specifying the standard deviation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>2</b> One-Way ANOVA</a><ul>
<li class="chapter" data-level="2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions"><i class="fa fa-check"></i><b>2.1.1</b> Two conditions</a></li>
<li class="chapter" data-level="2.1.2" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions"><i class="fa fa-check"></i><b>2.1.2</b> Three conditions</a></li>
<li class="chapter" data-level="2.1.3" data-path="one-way-anova.html"><a href="one-way-anova.html#power-for-simple-effects"><i class="fa fa-check"></i><b>2.1.3</b> Power for simple effects</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#effect-size-estimates-for-one-way-anova"><i class="fa fa-check"></i><b>2.2</b> Effect Size Estimates for One-Way ANOVA</a><ul>
<li class="chapter" data-level="2.2.1" data-path="one-way-anova.html"><a href="one-way-anova.html#three-conditions-small-effect-size"><i class="fa fa-check"></i><b>2.2.1</b> Three conditions, small effect size</a></li>
<li class="chapter" data-level="2.2.2" data-path="one-way-anova.html"><a href="one-way-anova.html#four-conditions-medium-effect-size"><i class="fa fa-check"></i><b>2.2.2</b> Four conditions, medium effect size</a></li>
<li class="chapter" data-level="2.2.3" data-path="one-way-anova.html"><a href="one-way-anova.html#two-conditions-large-effect-size"><i class="fa fa-check"></i><b>2.2.3</b> Two conditions, large effect size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html"><i class="fa fa-check"></i><b>3</b> Repeated Measures ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-1"><i class="fa fa-check"></i><b>3.1</b> Part 1</a><ul>
<li class="chapter" data-level="3.1.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#two-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.1.1</b> Two conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-2"><i class="fa fa-check"></i><b>3.2</b> Part 2</a><ul>
<li class="chapter" data-level="3.2.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#the-relation-between-cohens-f-and-cohens-d"><i class="fa fa-check"></i><b>3.2.1</b> The relation between Cohen’s f and Cohen’s d</a></li>
<li class="chapter" data-level="3.2.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#three-within-conditions-medium-effect-size"><i class="fa fa-check"></i><b>3.2.2</b> Three within conditions, medium effect size</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-3"><i class="fa fa-check"></i><b>3.3</b> Part 3</a></li>
<li class="chapter" data-level="3.4" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-4"><i class="fa fa-check"></i><b>3.4</b> Part 4</a><ul>
<li class="chapter" data-level="3.4.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-within-design"><i class="fa fa-check"></i><b>3.4.1</b> 2x2 ANOVA, within-within design</a></li>
<li class="chapter" data-level="3.4.2" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#examine-variation-of-means-and-correlation"><i class="fa fa-check"></i><b>3.4.2</b> Examine variation of means and correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#part-5"><i class="fa fa-check"></i><b>3.5</b> Part 5</a><ul>
<li class="chapter" data-level="3.5.1" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#x2-anova-within-design"><i class="fa fa-check"></i><b>3.5.1</b> 2x2 ANOVA, within design</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="repeated-measures-anova.html"><a href="repeated-measures-anova.html#multivariate-anova-manova"><i class="fa fa-check"></i><b>3.6</b> Multivariate ANOVA (MANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mixed-anova.html"><a href="mixed-anova.html"><i class="fa fa-check"></i><b>4</b> Mixed ANOVA</a><ul>
<li class="chapter" data-level="4.1" data-path="mixed-anova.html"><a href="mixed-anova.html#simple-mixed-designs"><i class="fa fa-check"></i><b>4.1</b> Simple Mixed Designs</a></li>
<li class="chapter" data-level="4.2" data-path="mixed-anova.html"><a href="mixed-anova.html#complex-mixed-designs"><i class="fa fa-check"></i><b>4.2</b> Complex Mixed Designs</a><ul>
<li class="chapter" data-level="4.2.1" data-path="mixed-anova.html"><a href="mixed-anova.html#b3w-design"><i class="fa fa-check"></i><b>4.2.1</b> 2b*3w Design</a></li>
<li class="chapter" data-level="4.2.2" data-path="mixed-anova.html"><a href="mixed-anova.html#b4w-design"><i class="fa fa-check"></i><b>4.2.2</b> 2b*4w Design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="power-for-three-way-interactions.html"><a href="power-for-three-way-interactions.html"><i class="fa fa-check"></i><b>5</b> Power for Three-way Interactions</a></li>
<li class="chapter" data-level="6" data-path="the-no-way-interactions.html"><a href="the-no-way-interactions.html"><i class="fa fa-check"></i><b>6</b> The ‘No-Way’ Interactions</a></li>
<li class="chapter" data-level="7" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html"><i class="fa fa-check"></i><b>7</b> Effect of Varying Designs on Power</a><ul>
<li class="chapter" data-level="7.1" data-path="effect-of-varying-designs-on-power.html"><a href="effect-of-varying-designs-on-power.html#within-designs"><i class="fa fa-check"></i><b>7.1</b> Within Designs</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="error-control-in-exploratory-anova.html"><a href="error-control-in-exploratory-anova.html"><i class="fa fa-check"></i><b>8</b> Error Control in Exploratory ANOVA</a></li>
<li class="chapter" data-level="9" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html"><i class="fa fa-check"></i><b>9</b> Analytic Power Functions</a><ul>
<li class="chapter" data-level="9.1" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#one-way-between-subjects-anova"><i class="fa fa-check"></i><b>9.1</b> One-Way Between Subjects ANOVA</a></li>
<li class="chapter" data-level="9.2" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#two-way-between-subject-interaction"><i class="fa fa-check"></i><b>9.2</b> Two-way Between Subject Interaction</a></li>
<li class="chapter" data-level="9.3" data-path="analytic-power-functions.html"><a href="analytic-power-functions.html#x3-between-subject-anova"><i class="fa fa-check"></i><b>9.3</b> 3x3 Between Subject ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="power-curve.html"><a href="power-curve.html"><i class="fa fa-check"></i><b>10</b> Power Curve</a><ul>
<li class="chapter" data-level="10.1" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-moderated-interactions."><i class="fa fa-check"></i><b>10.1</b> Explore increase in effect size for moderated interactions.</a></li>
<li class="chapter" data-level="10.2" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-effect-size-for-cross-over-interactions."><i class="fa fa-check"></i><b>10.2</b> Explore increase in effect size for cross-over interactions.</a></li>
<li class="chapter" data-level="10.3" data-path="power-curve.html"><a href="power-curve.html#explore-increase-in-correlation-in-moderated-interactions."><i class="fa fa-check"></i><b>10.3</b> Explore increase in correlation in moderated interactions.</a></li>
<li class="chapter" data-level="10.4" data-path="power-curve.html"><a href="power-curve.html#increasing-correlation-in-on-factor-decreases-power-in-second-factor"><i class="fa fa-check"></i><b>10.4</b> Increasing correlation in on factor decreases power in second factor</a></li>
<li class="chapter" data-level="10.5" data-path="power-curve.html"><a href="power-curve.html#code-to-reproduce-power-curve-figures"><i class="fa fa-check"></i><b>10.5</b> Code to Reproduce Power Curve Figures</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html"><i class="fa fa-check"></i><b>11</b> Violations of Assumptions</a><ul>
<li class="chapter" data-level="11.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-heterogeneity-assumption"><i class="fa fa-check"></i><b>11.1</b> Violation of Heterogeneity Assumption</a></li>
<li class="chapter" data-level="11.2" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#violation-of-the-sphericity-assumption"><i class="fa fa-check"></i><b>11.2</b> Violation of the sphericity assumption</a><ul>
<li class="chapter" data-level="11.2.1" data-path="violations-of-assumptions.html"><a href="violations-of-assumptions.html#manova-or-sphericity-adjustment"><i class="fa fa-check"></i><b>11.2.1</b> MANOVA or Sphericity Adjustment?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html"><i class="fa fa-check"></i><b>12</b> Estimated Marginal Means</a><ul>
<li class="chapter" data-level="12.1" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#a-note-of-caution"><i class="fa fa-check"></i><b>12.1</b> A note of caution</a></li>
<li class="chapter" data-level="12.2" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#pairwise-comparisons"><i class="fa fa-check"></i><b>12.2</b> Pairwise Comparisons</a></li>
<li class="chapter" data-level="12.3" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#customized-emmeans-contrasts"><i class="fa fa-check"></i><b>12.3</b> Customized <code>emmeans</code> contrasts</a></li>
<li class="chapter" data-level="12.4" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#equivalence-and-non-superiority-inferiority-tests"><i class="fa fa-check"></i><b>12.4</b> Equivalence and non-superiority/-inferiority tests</a></li>
<li class="chapter" data-level="12.5" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#joint-tests"><i class="fa fa-check"></i><b>12.5</b> Joint tests</a></li>
<li class="chapter" data-level="12.6" data-path="estimated-marginal-means.html"><a href="estimated-marginal-means.html#monte-carlo-simulations"><i class="fa fa-check"></i><b>12.6</b> Monte Carlo Simulations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html"><i class="fa fa-check"></i>Appendix 1: Direct Comparison to pwr2ppl</a><ul>
<li class="chapter" data-level="12.7" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-5"><i class="fa fa-check"></i><b>12.7</b> Examples from Chapter 5</a><ul>
<li class="chapter" data-level="12.7.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.15.2"><i class="fa fa-check"></i><b>12.7.1</b> Example 5.1/5.2</a></li>
<li class="chapter" data-level="12.7.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-5.3"><i class="fa fa-check"></i><b>12.7.2</b> Example 5.3</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#examples-from-chapter-6"><i class="fa fa-check"></i><b>12.8</b> Examples from Chapter 6</a><ul>
<li class="chapter" data-level="12.8.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.2"><i class="fa fa-check"></i><b>12.8.1</b> Example from Table 6.2</a></li>
<li class="chapter" data-level="12.8.2" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.6"><i class="fa fa-check"></i><b>12.8.2</b> Example from Table 6.6</a></li>
<li class="chapter" data-level="12.8.3" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-table-6.8"><i class="fa fa-check"></i><b>12.8.3</b> Example from Table 6.8</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#example-from-chapter-7"><i class="fa fa-check"></i><b>12.9</b> Example from Chapter 7</a><ul>
<li class="chapter" data-level="12.9.1" data-path="appendix-1-direct-comparison-to-pwr2ppl.html"><a href="appendix-1-direct-comparison-to-pwr2ppl.html#from-table-7.2"><i class="fa fa-check"></i><b>12.9.1</b> From Table 7.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html"><i class="fa fa-check"></i>Appendix 3: Comparison to Brysbaert</a><ul>
<li class="chapter" data-level="12.10" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#one-way-anova-1"><i class="fa fa-check"></i><b>12.10</b> One-Way ANOVA</a><ul>
<li class="chapter" data-level="12.10.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication"><i class="fa fa-check"></i><b>12.10.1</b> Three conditions replication</a></li>
<li class="chapter" data-level="12.10.2" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-1"><i class="fa fa-check"></i><b>12.10.2</b> Variation 1</a></li>
<li class="chapter" data-level="12.10.3" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-1"><i class="fa fa-check"></i><b>12.10.3</b> Three conditions replication</a></li>
<li class="chapter" data-level="12.10.4" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#variation-2"><i class="fa fa-check"></i><b>12.10.4</b> Variation 2</a></li>
<li class="chapter" data-level="12.10.5" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#three-conditions-replication-2"><i class="fa fa-check"></i><b>12.10.5</b> Three conditions replication</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#repeated-measures"><i class="fa fa-check"></i><b>12.11</b> Repeated Measures</a><ul>
<li class="chapter" data-level="12.11.1" data-path="appendix-3-comparison-to-brysbaert.html"><a href="appendix-3-comparison-to-brysbaert.html#reproducing-brysbaert-variation-1-changing-correlation"><i class="fa fa-check"></i><b>12.11.1</b> Reproducing Brysbaert Variation 1: Changing Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-2-direct-comparison-to-morepower.html"><a href="appendix-2-direct-comparison-to-morepower.html"><i class="fa fa-check"></i>Appendix 2: Direct Comparison to MOREpower</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Power Analysis with Superpower</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimated-marginal-means" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Estimated Marginal Means</h1>
<p><em>Thank you to <a href="https://github.com/crsh">Fredrick Aust</a> for developing the emmeans_power function</em></p>
<p>In many cases researchers may not be interested in the ANOVA-level effects, but rather in the power to detect a specific comparisons within the data. For example, you may have hypothesis about equivalence rather than a difference between groups. In these cases, we then need to obtain the “estimated marginal means” (EMMs), also known as the least squared means (lsmeans for SAS users), which can be done in R with the <code>emmeans</code> <a href="https://cran.r-project.org/web/packages/emmeans/index.html">package</a> and this is what <code>Superpower</code> uses “under the hood”. The EMMs refer to the mean of a group or set of groups within a statistical model.</p>
<p>For <code>Superpower</code>, you can estimate EMMs power for your designs in three different ways: <code>ANOVA_power</code>, <code>ANOVA_exact</code>, <code>emmeans_power</code>. Both <code>ANOVA_power</code> and <code>ANOVA_exact</code> allow for EMMs comparisons to be run along side the ANOVA-level comparisons. To do this, you will need to set a few parameters within the function.</p>
<ol style="list-style-type: decimal">
<li><code>emm</code>: tell the function to run emmeans or not; default is set to <code>FALSE</code>.</li>
<li><code>contrast_type</code>: This input will determine the contrast type for the emmeans comparisons. The default is “pairwise”. Possible input is limited to “pairwise”, “revpairwise”, “eff”, “consec”, “poly”, “del.eff”, “trt.vs.ctrl”, “trt.vs.ctrl1”, “trt.vs.ctrlk”, and “mean_chg”. See help(“contrast-methods”) with the <code>emmeans</code> package loaded for more information.</li>
<li><code>emm_model</code>: emmeans accepts univariate and multivariate models. This will only make a difference if a within-subjects factor is included in the design. Setting this option to “multivariate” will result in the “multivariate” model being selected for the emmeans comparisons. <em>This is generally recommended if you are interested in the estimated marginal means</em>.</li>
<li><code>emm_comp</code>: This selects the factors to be included for the emmeans. The default is to take the <code>frml2</code> object from the results of <code>ANOVA_design</code>, and with the default <code>contrast_type = "pairwise"</code>, results in <em>all</em> the pairwise comparisons being performed. The simple effects can also be perfomed by including | in the emm_comp formula. For example, with two factors (e.g., a and b) <code>emm_comp = "a+b"</code> results in all pairwise comparisons being performed while <code>emm_comp = "a|b"</code> will result in pairwise comparisons across all levels of a <strong>within</strong> each level of b.</li>
<li><code>emm_p_adjust</code> (<code>ANOVA_power</code> only): This sets the correction for multiple comparisons for the EMMs; default is “none”. When <code>emmeans</code> is installed you can check ?summary.emmGrid for more details on acceptable methods for EMMs. Please not that these corrections can only be applied in the <code>ANOVA_power</code> function at this time.</li>
</ol>
<p>If you want to go beyond the simple comparions that can be accomplished with <code>ANOVA_power</code> or <code>ANOVA_exact</code> then you can use the <code>emmeans_power</code> function directly. In this chapter, we will show how to use all three functions on their own or in combination with each other.</p>
<div id="a-note-of-caution" class="section level2">
<h2><span class="header-section-number">12.1</span> A note of caution</h2>
<p>When conducting exact ANOVA power analyses with <code>Superpower</code> it is possible to calculate the power for both the omnibus <span class="math inline">\(F\)</span>-tests and planned contrasts or post-hoc comparisons.
All power analyses for <code>emmeans</code>-objects are based on the <span class="math inline">\(F\)</span>- and <span class="math inline">\(t\)</span>-values from the analyses of the dataset simulated by <code>ANOVA_exact()</code> assuming two-sided testing.
Thus, the <code>emmeans_power()</code> does not honor adjustments of the testing procedure due to either one-sided testing (including two one-sided tests) or corrections for multiple comparisons via the <code>adjust</code> option in <code>emmeans</code>.
As noted below, for the Bonferroni-adjustment this limitation can be overcome by manually adjusting <code>alpha_level</code>.</p>
</div>
<div id="pairwise-comparisons" class="section level2">
<h2><span class="header-section-number">12.2</span> Pairwise Comparisons</h2>
<p>This is the most common form of using EMMs. In our experience, many people will first inspect the ANOVA-level effects and then goes into the individual group comparisons.</p>
<p>First, we can setup a 2 <span class="math inline">\(\times\)</span> 3 repeated measures design.
When calling <code>ANOVA_exact()</code> pairwise comparisons of expected marginal means are added by setting <code>emm = TRUE</code> and <code>contrast_type = "pairwise"</code> (default).
The <code>emm_comp</code> parameter will automatically be set to <code>condition*voice</code>.
If you wanted to look at the main effect of <code>condition</code> or <code>voice</code> all you need to do is set <code>emm_comp</code> to that specific factor rather than the interaction.</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="estimated-marginal-means.html#cb622-1"></a><span class="co"># Set up a within design with 2 factors, each with 2 and 3 levels</span></span>
<span id="cb622-2"><a href="estimated-marginal-means.html#cb622-2"></a>design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(</span>
<span id="cb622-3"><a href="estimated-marginal-means.html#cb622-3"></a>  <span class="dt">design =</span> <span class="st">&quot;2w*3w&quot;</span>,</span>
<span id="cb622-4"><a href="estimated-marginal-means.html#cb622-4"></a>  <span class="dt">n =</span> <span class="dv">40</span>,</span>
<span id="cb622-5"><a href="estimated-marginal-means.html#cb622-5"></a>  <span class="dt">mu =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb622-6"><a href="estimated-marginal-means.html#cb622-6"></a>  <span class="dt">sd =</span> <span class="dv">2</span>,</span>
<span id="cb622-7"><a href="estimated-marginal-means.html#cb622-7"></a>  <span class="dt">r =</span> <span class="fl">0.8</span>, </span>
<span id="cb622-8"><a href="estimated-marginal-means.html#cb622-8"></a>  <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;cheerful&quot;</span>, <span class="st">&quot;sad&quot;</span>, <span class="st">&quot;voice&quot;</span>, <span class="st">&quot;human&quot;</span>, <span class="st">&quot;robot&quot;</span>, <span class="st">&quot;cartoon&quot;</span>),</span>
<span id="cb622-9"><a href="estimated-marginal-means.html#cb622-9"></a>  <span class="dt">plot =</span> <span class="ot">TRUE</span></span>
<span id="cb622-10"><a href="estimated-marginal-means.html#cb622-10"></a>)</span></code></pre></div>
<p><img src="SuperpowerValidation_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="estimated-marginal-means.html#cb623-1"></a>exact_result &lt;-<span class="st"> </span><span class="kw">ANOVA_exact</span>(</span>
<span id="cb623-2"><a href="estimated-marginal-means.html#cb623-2"></a>  design_result,</span>
<span id="cb623-3"><a href="estimated-marginal-means.html#cb623-3"></a>  <span class="dt">alpha_level =</span> <span class="fl">0.05</span>,</span>
<span id="cb623-4"><a href="estimated-marginal-means.html#cb623-4"></a>  <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</span>
<span id="cb623-5"><a href="estimated-marginal-means.html#cb623-5"></a>  <span class="dt">emm =</span> <span class="ot">TRUE</span>,</span>
<span id="cb623-6"><a href="estimated-marginal-means.html#cb623-6"></a>  <span class="dt">contrast_type =</span> <span class="st">&quot;pairwise&quot;</span></span>
<span id="cb623-7"><a href="estimated-marginal-means.html#cb623-7"></a>)</span></code></pre></div>
<p>The result contains the power calculations for both the omnibus <span class="math inline">\(F\)</span>-tests and pairwise post-hoc comparisons.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="estimated-marginal-means.html#cb624-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(exact_result<span class="op">$</span>main_results[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition
</td>
<td style="text-align:right;">
29.08380
</td>
<td style="text-align:right;">
0.0507099
</td>
</tr>
<tr>
<td style="text-align:left;">
voice
</td>
<td style="text-align:right;">
50.12584
</td>
<td style="text-align:right;">
0.0621242
</td>
</tr>
<tr>
<td style="text-align:left;">
condition:voice
</td>
<td style="text-align:right;">
41.62968
</td>
<td style="text-align:right;">
0.0507099
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="estimated-marginal-means.html#cb625-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>((exact_result<span class="op">$</span>emm_results[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
power
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_sad voice_cartoon
</td>
<td style="text-align:right;">
68.37160
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_cheerful voice_human
</td>
<td style="text-align:right;">
16.41134
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_sad voice_human
</td>
<td style="text-align:right;">
16.41134
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
68.37160
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_sad voice_robot
</td>
<td style="text-align:right;">
68.37160
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_cheerful voice_human
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_sad voice_human
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_sad voice_robot
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_human - condition_sad voice_human
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_human - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_human - condition_sad voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_human - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_human - condition_sad voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_robot - condition_sad voice_robot
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
</tbody>
</table>
<p>The output also contains the <code>emmeans</code>-object on which these power calculations are based.
By manipulating this object it is possible to tailor the power analyses to the contrasts desired for the planned study.
That is, based on the dataset simulated with <code>ANOVA_exact()</code> we can write out the analysis code for <code>emmeans</code>-contrasts, just as we would if we were to analyse the empirical data, and use the output to perform the corresponding power analysis.</p>
</div>
<div id="customized-emmeans-contrasts" class="section level2">
<h2><span class="header-section-number">12.3</span> Customized <code>emmeans</code> contrasts</h2>
<p>The <code>emmeans</code> reference grid and contrasts are included in the output of <code>ANOVA_exact()</code>. This can be accessed through <code>exact_result$emmeans</code></p>
<p>By using <code>emmeans_power()</code> on the contrasts, we can reproduce the results of the previous power analysis for the pairwise comparisons.</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="estimated-marginal-means.html#cb626-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(exact_result<span class="op">$</span>emmeans<span class="op">$</span>contrasts)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
power
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_sad voice_cartoon
</td>
<td style="text-align:right;">
68.37160
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_cheerful voice_human
</td>
<td style="text-align:right;">
16.41134
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_sad voice_human
</td>
<td style="text-align:right;">
16.41134
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
68.37160
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_cartoon - condition_sad voice_robot
</td>
<td style="text-align:right;">
68.37160
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_cheerful voice_human
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_sad voice_human
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_cartoon - condition_sad voice_robot
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_human - condition_sad voice_human
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_human - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_human - condition_sad voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_human - condition_cheerful voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad voice_human - condition_sad voice_robot
</td>
<td style="text-align:right;">
30.99652
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful voice_robot - condition_sad voice_robot
</td>
<td style="text-align:right;">
5.00000
</td>
</tr>
</tbody>
</table>
<p>Now, we can manipulate the <code>emmeans</code> reference grid to perform additional power analyses.
In the following example, we calculate the power for the contrasts between sad and cheerful condition for each voice.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="estimated-marginal-means.html#cb627-1"></a>simple_condition_effects &lt;-<span class="st"> </span><span class="kw">emmeans</span>(</span>
<span id="cb627-2"><a href="estimated-marginal-means.html#cb627-2"></a>  exact_result<span class="op">$</span>emmeans<span class="op">$</span>emmeans,</span>
<span id="cb627-3"><a href="estimated-marginal-means.html#cb627-3"></a>  <span class="dt">specs =</span> <span class="op">~</span><span class="st"> </span>condition <span class="op">|</span><span class="st"> </span>voice</span>
<span id="cb627-4"><a href="estimated-marginal-means.html#cb627-4"></a>)</span>
<span id="cb627-5"><a href="estimated-marginal-means.html#cb627-5"></a></span>
<span id="cb627-6"><a href="estimated-marginal-means.html#cb627-6"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(<span class="kw">pairs</span>(simple_condition_effects))[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:left;">
voice
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_cartoon
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_human
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_robot
</td>
</tr>
</tbody>
</table>
<p>We may also calculate the power for testing all condition means against an arbitrary constant. <strong>Remember</strong>, these are two-tailed tests, so it is not testing against the null that the individual cells in the design are more or less than 0.5, but rather different from 0.5 at all.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="estimated-marginal-means.html#cb628-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(<span class="kw">test</span>(simple_condition_effects, <span class="dt">null =</span> <span class="fl">0.5</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
condition
</th>
<th style="text-align:left;">
voice
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition_cheerful
</td>
<td style="text-align:left;">
voice_cartoon
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad
</td>
<td style="text-align:left;">
voice_cartoon
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful
</td>
<td style="text-align:left;">
voice_human
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad
</td>
<td style="text-align:left;">
voice_human
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful
</td>
<td style="text-align:left;">
voice_robot
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_sad
</td>
<td style="text-align:left;">
voice_robot
</td>
</tr>
</tbody>
</table>
<p>Finally, we can calculate the power for custom contrasts between any linear combination of conditions.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="estimated-marginal-means.html#cb629-1"></a>custom_contrast &lt;-<span class="st"> </span><span class="kw">contrast</span>(</span>
<span id="cb629-2"><a href="estimated-marginal-means.html#cb629-2"></a>  exact_result<span class="op">$</span>emmeans<span class="op">$</span>emmeans,</span>
<span id="cb629-3"><a href="estimated-marginal-means.html#cb629-3"></a>  <span class="kw">list</span>(<span class="dt">robot_vs_sad_human =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">-0.5</span>, <span class="fl">-0.5</span>))</span>
<span id="cb629-4"><a href="estimated-marginal-means.html#cb629-4"></a>)</span>
<span id="cb629-5"><a href="estimated-marginal-means.html#cb629-5"></a></span>
<span id="cb629-6"><a href="estimated-marginal-means.html#cb629-6"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(custom_contrast))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
robot_vs_sad_human
</td>
<td style="text-align:right;">
39.34971
</td>
<td style="text-align:right;">
0.0714286
</td>
<td style="text-align:right;">
0.2773501
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>Although <code>emmeans_power()</code> currently ignores adjustments for multiple comparisons, it is possible to calculate the power for Bonferroni-corrected tests by adjusting <code>alpha_level</code>.</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="estimated-marginal-means.html#cb630-1"></a>n_contrasts &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">as.data.frame</span>(simple_condition_effects))</span>
<span id="cb630-2"><a href="estimated-marginal-means.html#cb630-2"></a></span>
<span id="cb630-3"><a href="estimated-marginal-means.html#cb630-3"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(</span>
<span id="cb630-4"><a href="estimated-marginal-means.html#cb630-4"></a>  <span class="kw">pairs</span>(simple_condition_effects),</span>
<span id="cb630-5"><a href="estimated-marginal-means.html#cb630-5"></a>  <span class="dt">alpha_level =</span> <span class="fl">0.05</span> <span class="op">/</span><span class="st"> </span>n_contrasts</span>
<span id="cb630-6"><a href="estimated-marginal-means.html#cb630-6"></a>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:left;">
voice
</th>
<th style="text-align:right;">
power
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_cartoon
</td>
<td style="text-align:right;">
40.1555499
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_human
</td>
<td style="text-align:right;">
0.8333333
</td>
</tr>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_robot
</td>
<td style="text-align:right;">
0.8333333
</td>
</tr>
</tbody>
</table>
<p>Similarly, if we want to calculate power for a one-sided test, we can use the “hack” of doubling the <code>alpha_level</code> parameter.</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="estimated-marginal-means.html#cb631-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(</span>
<span id="cb631-2"><a href="estimated-marginal-means.html#cb631-2"></a>  <span class="kw">pairs</span>(simple_condition_effects)[<span class="dv">1</span>],</span>
<span id="cb631-3"><a href="estimated-marginal-means.html#cb631-3"></a>  <span class="dt">alpha_level =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb631-4"><a href="estimated-marginal-means.html#cb631-4"></a>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:left;">
voice
</th>
<th style="text-align:right;">
power
</th>
<th style="text-align:right;">
partial_eta_squared
</th>
<th style="text-align:right;">
cohen_f
</th>
<th style="text-align:right;">
non_centrality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_cartoon
</td>
<td style="text-align:right;">
79.14507
</td>
<td style="text-align:right;">
0.1381215
</td>
<td style="text-align:right;">
0.4003204
</td>
<td style="text-align:right;">
6.25
</td>
</tr>
</tbody>
</table>
<p>Note, that because power is calculated from the squared <span class="math inline">\(t\)</span>-value, power is only calculated correctly if the alternative hypothesis is true in the simulated dataset.
That is, the difference of the condition means is <em>consistent with the tested directional hypothesis</em>.</p>
</div>
<div id="equivalence-and-non-superiority-inferiority-tests" class="section level2">
<h2><span class="header-section-number">12.4</span> Equivalence and non-superiority/-inferiority tests</h2>
<p>Because <code>emmeans</code> can perform equivalence, non-superiority, and -inferiority tests, <code>emmeans_power()</code> can calculate the corresponding power for these tests.</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="estimated-marginal-means.html#cb632-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(</span>
<span id="cb632-2"><a href="estimated-marginal-means.html#cb632-2"></a>  <span class="kw">pairs</span>(simple_condition_effects, <span class="dt">side =</span> <span class="st">&quot;equivalence&quot;</span>, <span class="dt">delta =</span> <span class="fl">0.3</span>)[<span class="dv">2</span>]</span>
<span id="cb632-3"><a href="estimated-marginal-means.html#cb632-3"></a>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:left;">
voice
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
condition_cheerful - condition_sad
</td>
<td style="text-align:left;">
voice_human
</td>
</tr>
</tbody>
</table>
<p>Note, that because power is calculated from the squared <span class="math inline">\(t\)</span>-value, power is only calculated correctly if the alternative hypothesis is true in the simulated dataset.
That is, the difference between the condition means is consistent with the tested directional hypothesis (smaller than <code>delta</code>).</p>
</div>
<div id="joint-tests" class="section level2">
<h2><span class="header-section-number">12.5</span> Joint tests</h2>
<p>Another useful application of <code>emmeans_power()</code> is to joint tests.
Lets assume we plan to test the main effect of voice for each of the two conditions separately using <code>joint_tests()</code>.
We can then calculate the power for each Bonferroni-corrected <span class="math inline">\(F\)</span>-test as follows.</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="estimated-marginal-means.html#cb633-1"></a>voice_by_condition &lt;-<span class="st"> </span><span class="kw">joint_tests</span>(</span>
<span id="cb633-2"><a href="estimated-marginal-means.html#cb633-2"></a>  exact_result<span class="op">$</span>emmeans<span class="op">$</span>emmeans,</span>
<span id="cb633-3"><a href="estimated-marginal-means.html#cb633-3"></a>  <span class="dt">by =</span> <span class="st">&quot;condition&quot;</span></span>
<span id="cb633-4"><a href="estimated-marginal-means.html#cb633-4"></a>)</span>
<span id="cb633-5"><a href="estimated-marginal-means.html#cb633-5"></a></span>
<span id="cb633-6"><a href="estimated-marginal-means.html#cb633-6"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">emmeans_power</span>(voice_by_condition, <span class="dt">alpha_level =</span> <span class="fl">0.05</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
model term
</th>
<th style="text-align:left;">
condition
</th>
<th style="text-align:right;">
power
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
voice
</td>
<td style="text-align:left;">
condition_cheerful
</td>
<td style="text-align:right;">
21.80102
</td>
</tr>
<tr>
<td style="text-align:left;">
voice
</td>
<td style="text-align:left;">
condition_sad
</td>
<td style="text-align:right;">
10.39583
</td>
</tr>
</tbody>
</table>
</div>
<div id="monte-carlo-simulations" class="section level2">
<h2><span class="header-section-number">12.6</span> Monte Carlo Simulations</h2>
<p>Now, many of those reading may be anxious about wanting to apply corrections for multiple comparisions beyond a simple Bonferroni alpha reduction. This can be accomplished with the <code>ANOVA_power</code> function. The procedure is very similiar to the one outlined in the pairwise comparisions section above.
However, we will need to set the the type of multiple comparisons adjustment we would like (<code>emm_p_adjust</code>) and the total number of simulations (<code>nsims</code>).
Remember, the total number of simulations will determine the accuracy of the power estimation (higher <code>nsims</code> = higher accuracy).
But, this comes at the cost of increased computation time.
So, again, we can setup the same design and pass this onto the <code>ANOVA_power</code> function.
In this particular case I have decided to set the <code>emm_p_adjust</code> to “holm” for a Holm-Bonferroni correction.
This out of personal preference for this stepdown procedure since it preserves the alpha but is more powerful than the normal Bonferroni adjustment itself.
However, I would like to warn users that some adjustments, such as Tukey or Scheffe, are not appropriate for designs with within-subject factors (i.e., the do not fully preserve the Type 1 error rate).</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="estimated-marginal-means.html#cb634-1"></a>design_result &lt;-<span class="st"> </span><span class="kw">ANOVA_design</span>(</span>
<span id="cb634-2"><a href="estimated-marginal-means.html#cb634-2"></a>  <span class="dt">design =</span> <span class="st">&quot;2w*3w&quot;</span>,</span>
<span id="cb634-3"><a href="estimated-marginal-means.html#cb634-3"></a>  <span class="dt">n =</span> <span class="dv">40</span>,</span>
<span id="cb634-4"><a href="estimated-marginal-means.html#cb634-4"></a>  <span class="dt">mu =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb634-5"><a href="estimated-marginal-means.html#cb634-5"></a>  <span class="dt">sd =</span> <span class="dv">2</span>,</span>
<span id="cb634-6"><a href="estimated-marginal-means.html#cb634-6"></a>  <span class="dt">r =</span> <span class="fl">0.8</span>, </span>
<span id="cb634-7"><a href="estimated-marginal-means.html#cb634-7"></a>  <span class="dt">labelnames =</span> <span class="kw">c</span>(<span class="st">&quot;condition&quot;</span>, <span class="st">&quot;cheerful&quot;</span>, <span class="st">&quot;sad&quot;</span>, <span class="st">&quot;voice&quot;</span>, <span class="st">&quot;human&quot;</span>, <span class="st">&quot;robot&quot;</span>, <span class="st">&quot;cartoon&quot;</span>),</span>
<span id="cb634-8"><a href="estimated-marginal-means.html#cb634-8"></a>  <span class="dt">plot =</span> <span class="ot">FALSE</span></span>
<span id="cb634-9"><a href="estimated-marginal-means.html#cb634-9"></a>)</span>
<span id="cb634-10"><a href="estimated-marginal-means.html#cb634-10"></a></span>
<span id="cb634-11"><a href="estimated-marginal-means.html#cb634-11"></a>monte_result1 &lt;-<span class="st"> </span><span class="kw">ANOVA_power</span>(</span>
<span id="cb634-12"><a href="estimated-marginal-means.html#cb634-12"></a>  design_result,</span>
<span id="cb634-13"><a href="estimated-marginal-means.html#cb634-13"></a>  <span class="dt">alpha_level =</span> <span class="fl">0.05</span>,</span>
<span id="cb634-14"><a href="estimated-marginal-means.html#cb634-14"></a>  <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</span>
<span id="cb634-15"><a href="estimated-marginal-means.html#cb634-15"></a>  <span class="dt">emm =</span> <span class="ot">TRUE</span>,</span>
<span id="cb634-16"><a href="estimated-marginal-means.html#cb634-16"></a>  <span class="dt">contrast_type =</span> <span class="st">&quot;pairwise&quot;</span>,</span>
<span id="cb634-17"><a href="estimated-marginal-means.html#cb634-17"></a>  <span class="dt">emm_p_adjust =</span> <span class="st">&quot;holm&quot;</span>,</span>
<span id="cb634-18"><a href="estimated-marginal-means.html#cb634-18"></a>  <span class="dt">nsims =</span> <span class="dv">10000</span>, <span class="co">#set total number of simulations</span></span>
<span id="cb634-19"><a href="estimated-marginal-means.html#cb634-19"></a>  <span class="dt">seed =</span> <span class="dv">27042020</span>, <span class="co">#set seed for reproducibility</span></span>
<span id="cb634-20"><a href="estimated-marginal-means.html#cb634-20"></a>)</span></code></pre></div>
<p>We can now inspect the results contained within the monte_result object.</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="estimated-marginal-means.html#cb635-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(monte_result1<span class="op">$</span>emm_results[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
power
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
p_1
</td>
<td style="text-align:left;">
condition_cheerful,voice_cartoon - condition_sad,voice_cartoon
</td>
<td style="text-align:right;">
29.21
</td>
</tr>
<tr>
<td style="text-align:left;">
p_2
</td>
<td style="text-align:left;">
condition_cheerful,voice_cartoon - condition_cheerful,voice_human
</td>
<td style="text-align:right;">
2.77
</td>
</tr>
<tr>
<td style="text-align:left;">
p_3
</td>
<td style="text-align:left;">
condition_cheerful,voice_cartoon - condition_sad,voice_human
</td>
<td style="text-align:right;">
2.59
</td>
</tr>
<tr>
<td style="text-align:left;">
p_4
</td>
<td style="text-align:left;">
condition_cheerful,voice_cartoon - condition_cheerful,voice_robot
</td>
<td style="text-align:right;">
29.70
</td>
</tr>
<tr>
<td style="text-align:left;">
p_5
</td>
<td style="text-align:left;">
condition_cheerful,voice_cartoon - condition_sad,voice_robot
</td>
<td style="text-align:right;">
29.40
</td>
</tr>
<tr>
<td style="text-align:left;">
p_6
</td>
<td style="text-align:left;">
condition_sad,voice_cartoon - condition_cheerful,voice_human
</td>
<td style="text-align:right;">
7.58
</td>
</tr>
<tr>
<td style="text-align:left;">
p_7
</td>
<td style="text-align:left;">
condition_sad,voice_cartoon - condition_sad,voice_human
</td>
<td style="text-align:right;">
7.42
</td>
</tr>
<tr>
<td style="text-align:left;">
p_8
</td>
<td style="text-align:left;">
condition_sad,voice_cartoon - condition_cheerful,voice_robot
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;">
p_9
</td>
<td style="text-align:left;">
condition_sad,voice_cartoon - condition_sad,voice_robot
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr>
<td style="text-align:left;">
p_10
</td>
<td style="text-align:left;">
condition_cheerful,voice_human - condition_sad,voice_human
</td>
<td style="text-align:right;">
0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
p_11
</td>
<td style="text-align:left;">
condition_cheerful,voice_human - condition_cheerful,voice_robot
</td>
<td style="text-align:right;">
7.43
</td>
</tr>
<tr>
<td style="text-align:left;">
p_12
</td>
<td style="text-align:left;">
condition_cheerful,voice_human - condition_sad,voice_robot
</td>
<td style="text-align:right;">
7.22
</td>
</tr>
<tr>
<td style="text-align:left;">
p_13
</td>
<td style="text-align:left;">
condition_sad,voice_human - condition_cheerful,voice_robot
</td>
<td style="text-align:right;">
7.67
</td>
</tr>
<tr>
<td style="text-align:left;">
p_14
</td>
<td style="text-align:left;">
condition_sad,voice_human - condition_sad,voice_robot
</td>
<td style="text-align:right;">
7.49
</td>
</tr>
<tr>
<td style="text-align:left;">
p_15
</td>
<td style="text-align:left;">
condition_cheerful,voice_robot - condition_sad,voice_robot
</td>
<td style="text-align:right;">
0.51
</td>
</tr>
</tbody>
</table>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="violations-of-assumptions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-1-direct-comparison-to-pwr2ppl.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SuperpowerValidation.pdf", "SuperpowerValidation.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
